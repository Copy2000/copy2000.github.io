<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>【总结】2022</title>
      <link href="/2023/03/26/zong-jie-2022/"/>
      <url>/2023/03/26/zong-jie-2022/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="年总结">2022年总结</h1><h2 id="经历">经历</h2><p>2022年可能是我前面20多年来人生比较丰富的一年，或者说是最丰富的一年，具体体现在生活、学习、对未来的方向性思考、个人感情等方面。是伴随着新冠疫情进入的2022年的，从1月末被封西安就开始奠定了这一年，注定是绝不平凡的一年。</p><p>一月份的话，我能回忆起来的只有就是因为黄码被困在广州南站，那是距离家那么近又那么远的地方，离人心很近，第一次感觉到，西安交通大学真的就站在我的身后，第一次让我对国家这个阶级统治的工具有了更加理性的认识，概略的说就是，国家还是一个抽象的名词，生活应该具体而微。<img src="/2023/03/26/zong-jie-2022/image-20221227224743570.png" alt="我的黄码"></p><figure><img src="/2023/03/26/zong-jie-2022/image-20221227224816587.png" alt="高铁遇河南大雪"><figcaption aria-hidden="true">高铁遇河南大雪</figcaption></figure><p>二月份是在家过的，和以往一样，和yaowei 、gay哥约球约饭，和八零nick他们约球约饭，和爸爸妈妈一起过年，平淡温馨。</p><p>三月份我想应该是在开摆吧，反正映象不深刻，这种月份属于是被时间偷走的、不属于我的月份，我也确实对三月不感冒。</p><p>四月是一个美好的季节，可能是四月确实对于我来说有点特殊，再说学校四月的时候樱花就开了，就算是对生活再没有兴趣的人，看那一丝的生机勃勃也会感到开心。<img src="/2023/03/26/zong-jie-2022/image-20221227225535203.png" alt="四月的hua"><img src="/2023/03/26/zong-jie-2022/image-20221227225514179.png" alt="四月的花"></p><p>五月将是我人生最最最最痛苦的时光的开始，甚至是我选择复读的无聊枯燥的那一年比起来，都没有这么痛苦，复读的那一年，我一个人从珠海横跨半个广东，700km到汕头读书，都没有感觉到痛苦，这世界上和感情相关的东西是最痛苦的。五月的话，其实一开始是课内学习和考研压力的冲突造成的强大紧张感，还有大创啥的杂七杂八的事情。</p><p>六月，整个六月和三月一样，是被遗忘的月份。</p><p>七月，遇到了一个让我终身难忘的人，我想我这一辈子都不会忘记她，这应该也是我痛苦的开始。</p><p>八月，一个人，在主楼坚守，因为考研，我选择早上七点起，晚上11点半睡，我不知道西安是不是炎热，但是在东八六楼，我叫了两次修空调的师傅，我一度以为是空调坏了，最后发现是整个世界坏了！我选择10点钟离开主楼，去操场跑上5圈，那是我最自由最享受的时刻，大脑放空，没有数学题和考研的焦虑，只有一阵又一阵的呼吸。</p><p>我是喜欢秋天的，所以我喜欢九月和十月，九月和十月也确实快乐，换了考研学校，现在看起来确实不太成熟，但是也是可以接受的，因为换了学校，复习起来更加有节奏和生活气息。九月也是我卷入到感情风波的开始，接下来就是。</p><p>整个十月、十一月和十二月是痛苦的，是写下这篇文章之前所活过的日子中最痛苦的时光，不想记录，但是希望正在看的本人，能够永远铭记在心。</p><h2 id="总结">总结</h2><p>总结的话，我想先从感情这块出发，因为这事让我学到了很多，首先的话是感谢和她的相逢，这只是一句客套话，我会感谢和所有人的相逢。但是我最想感谢的是她的离去，谢谢她没有选择我，考研真的是一个很特殊的时间节点，很容易产生不同寻常的情愫，爱情这种东西它很难在这里产生，所谓的爱情在这里都是要披上各种外皮，也很难认清楚一个人。她也许很优秀，也许不优秀，但是对于我来说并不重要。人这一生，最终是为了成为更好的自己和更快乐的自己，更好是抽象的，是自己对自己设置的要求，是满足自己欲望的无止境的幻想，而更快乐才是具体的，无论是为人还是处事，都应该是在自己快乐的心情下去做，如果一个人让你痛苦，请马上离开，她并不属于你，一个真正适合你的人，一定不会让你这么难受，至少不会让你难受这么久。我并不是想要表达是她的问题或者是我的问题，态度和观点都是带有强烈的主观色彩，做任何事或是与任何人相处的最终目的都是为了自己，人就是自私的，追名或是逐利。爱请热烈的、毫无顾忌的爱，不要害怕失去，失去的最终不属于你，不要因此改变自己的恋爱观，人本应该固执，特别是在如何做好自己这一方便，毕竟没有任何一个其他的人能够比自己本身更加熟悉自己。</p><h2 id="展望">展望</h2><p>努力做更好的自己！！！</p>]]></content>
      
      
      <categories>
          
          <category> 总结 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>【JNA】JAVA中使用JNA</title>
      <link href="/2023/03/26/jna-java-zhong-shi-yong-jna/"/>
      <url>/2023/03/26/jna-java-zhong-shi-yong-jna/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="使用jna调用cc动态链接库dll">使用JNA调用C/C++动态链接库dll</h1><p>参考视频:</p><ul><li><a href="https://www.bilibili.com/video/BV16t411A7it/">Java使用JNA调用C/C++动态链接库dll_哔哩哔哩_bilibili</a>（不是特别对）</li><li><a href="https://www.bilibili.com/video/BV1xU4y1F7Ep?spm_id_from=333.1007.top_right_bar_window_default_collection.content.click">【C++】JAVA使用JNA调用C++动态库DLL_哔哩哔哩_bilibili</a>（推荐）</li></ul><p>GITHUB repository:</p><ul><li><a href="https://github.com/java-native-access/jna">java-native-access/jna: Java Native Access (github.com)</a></li><li>repository：<a href="https://github.com/Copy2000/JNA_use">Copy2000/JNA_use: 使用JNA调用c++的类和函数 (github.com)</a></li></ul><span id="more"></span><h2 id="准备">准备</h2><ul><li>下载JNA和JNA Platform。</li></ul><figure><img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220407232739677.png" alt="image-20220407232739677"><figcaption aria-hidden="true">image-20220407232739677</figcaption></figure><figure><img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220407232838933.png" alt="image-20220407232838933"><figcaption aria-hidden="true">image-20220407232838933</figcaption></figure><ul><li>下载Code，可以使用SSH，更加快，但是我使用了VPN了，所以直接下载压缩包。</li></ul><figure><img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220407233022480.png" alt="image-20220407233022480"><figcaption aria-hidden="true">image-20220407233022480</figcaption></figure><ul><li><p>VScode安装JAVA扩展</p><ul><li><p>Extension Pack for JAVA(好像是6合1)</p></li><li><p>JAVA Development Kit</p><ul><li><a href="https://www.oracle.com/java/technologies/javase-downloads.html">下载java</a></li><li>把下载的java添加到系统变量（2处）<img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220409003946283.png" alt="image-20220409003946283"><img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220409004015114.png" alt="image-20220409004015114"><img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220409004036112.png" alt="image-20220409004036112"></li></ul></li><li><p>cmd 运行<code>java -version</code></p></li><li><p>vscode 在工作区设置setting.json<img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220409004207504.png" alt="image-20220409004207504"></p></li><li><p>检验</p><div class="sourceCode" id="cb1"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> hello &#123;</span><span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args)&#123;</span><span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Hello World!&quot;</span>);</span><span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    &#125;</span><span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>&#125;</span></code></pre></div><figure><img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220409004329142.png" alt="image-20220409004329142"><figcaption aria-hidden="true">image-20220409004329142</figcaption></figure></li></ul></li><li><p>上面介绍了用vscode安装java插件，接下来介绍eclipse，嘻嘻，专业的东西用专业的IDE。vscode，太难了。</p><ul><li><a href="https://www.eclipse.org/downloads/">安装eclipse。</a></li><li>JDK的安装和上面类似。</li></ul></li></ul><hr><h2 id="jna的应用">JNA的应用</h2><p>在Windows中的Preferences中选择Build Path下的User Library<img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220409154252057.png" alt="image-20220409154252057"></p><p>添加之前在github下载的三个文件。<img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220409154331254.png" alt="image-20220409154331254"></p><p>之后在文件夹<img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220409154433644.png" alt="image-20220409154433644">，右键点击Build Path下面的Add Library选中我们添加的JNA。</p><hr><p>按住ctrl+click你想看到的函数源码，之后点击attach...的button，添加之前在github下载的zip文件，就可以看到源码了。<img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220409154852563.png" alt="image-20220409154852563"></p><figure><img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220409155025815.png" alt="image-20220409155025815"><figcaption aria-hidden="true">image-20220409155025815</figcaption></figure><hr><p>在vs studio中创建dll<img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220409155357236.png" alt="image-20220409155357236"></p><p>主要使用的是testDLL.h和testDLL.cpp文件，相关的API和example在文件中已经给出。<img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220409155555133.png" alt="image-20220409155555133"></p><p>在testDLL.cpp中写源文件，在testDLL.h定义<img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220409160649433.png" alt="image-20220409160649433"></p><figure><img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220409160702579.png" alt="image-20220409160702579"><figcaption aria-hidden="true">image-20220409160702579</figcaption></figure><p>extern “C”是为了避免重载。</p><p>生成解决方案：</p><figure><img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220409160738670.png" alt="image-20220409160738670"><figcaption aria-hidden="true">image-20220409160738670</figcaption></figure><p>在DeBug文件下面找到testDLL.dll<img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220409160934107.png" alt="image-20220409160934107"></p><hr><p>把dll文件放到<img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220409161300374.png" alt="image-20220409161300374"></p><hr><p>新建接口interface；</p><p>实例化interface：<code>Mydll mydll = (Mydll)Native.load("testDLL",Mydll.class);</code></p><p>其中“testDLL”是testDLL.dll</p><figure><img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220409164128527.png" alt="image-20220409164128527"><figcaption aria-hidden="true">image-20220409164128527</figcaption></figure><hr><p>jna数据类型对应。<a href="https://blog.csdn.net/hayaqi0504/article/details/83782105">JNA数据类型的对应以及使用_江南老画船的博客</a><img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220409164322035.png" alt="image-20220409164322035"></p><h2 id="真正的应用">真正的应用</h2><p>好了好了，不隐藏了，上面都是老子踩的坑，接下来才是正题。</p><p>资料<a href="https://www.bilibili.com/video/BV1xU4y1F7Ep/?spm_id_from=333.788.recommend_more_video.-1">【C++】JAVA使用JNA调用C++动态库DLL_哔哩哔哩_bilibili</a></p><hr><ul><li><p>下载IntelliJ IDEA</p></li><li><p>把debug改成release<img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220410001545149.png" alt="image-20220410001545149"></p></li><li><p>如果想要输出中文，要使用u8<img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220410001739776.png" alt="image-20220410001739776"></p></li><li><p>添加jna的库<img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220410001816284.png" alt="image-20220410001816284"></p></li><li><p>添加interface并且实例化<img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220410001856274.png" alt="image-20220410001856274"></p></li><li><p>调用<img src="/2023/03/26/jna-java-zhong-shi-yong-jna/image-20220410001930152.png" alt="image-20220410001930152"></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> JNA </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>【JNA】JNA的使用</title>
      <link href="/2023/03/26/jna-jna-de-shi-yong/"/>
      <url>/2023/03/26/jna-jna-de-shi-yong/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="jna的使用">JNA的使用</h1><p>repository：<a href="https://github.com/Copy2000/JNA_use">Copy2000/JNA_use: 使用JNA调用c++的类和函数 (github.com)</a></p><span id="more"></span><h2 id="mcvs导入库">MCVS导入库</h2><figure><img src="/2023/03/26/jna-jna-de-shi-yong/image-20220412223616766.png" alt="image-20220412223616766"><figcaption aria-hidden="true">image-20220412223616766</figcaption></figure><table><thead><tr class="header"><th>folder</th><th>application</th></tr></thead><tbody><tr class="odd"><td>eigen-3.4.0</td><td>导入c++矩阵</td></tr><tr class="even"><td>qpOASES</td><td>导入qp包</td></tr></tbody></table><ul><li>使用软件：<ul><li>Visual Studio 2022</li><li>IntelliJ IDEA Community Edition 2021.3.3</li></ul></li></ul><h3 id="导入qpoases">导入qpOASES</h3><ul><li>将下载好的qpOASES文件夹通过visual studio打开。<img src="/2023/03/26/jna-jna-de-shi-yong/屏幕截图(30).png" alt="屏幕截图(C:/Users/A/Desktop/JNA的使用/屏幕截图(30).png)"></li><li>点击生成---全部生成<img src="/2023/03/26/jna-jna-de-shi-yong/屏幕截图(31).png" alt="屏幕截图(C:/Users/A/Desktop/JNA的使用/屏幕截图(31).png)"></li><li>在qpOASES文件夹下面的out/build/X64-debug/libs下面生成了.lib文件<img src="/2023/03/26/jna-jna-de-shi-yong/image-20220412224401224.png" alt="image-20220412224401224"></li><li>新建一个项目用于测试，把qpOASES中的include和刚刚生成的libs文件夹放到新生成的项目中<img src="/2023/03/26/jna-jna-de-shi-yong/image-20220412224630628.png" alt="image-20220412224630628"></li><li>在项目的属性中添加相关的include和lib<img src="/2023/03/26/jna-jna-de-shi-yong/image-20220412224709797.png" alt="image-20220412224709797"><img src="/2023/03/26/jna-jna-de-shi-yong/image-20220412224737726.png" alt="image-20220412224737726"><img src="/2023/03/26/jna-jna-de-shi-yong/image-20220412224824053.png" alt="image-20220412224824053"></li><li>运行example中的例子<img src="/2023/03/26/jna-jna-de-shi-yong/image-20220412224912177.png" alt="image-20220412224912177"></li></ul><h3 id="导入eigen">导入eigen</h3><figure><img src="/2023/03/26/jna-jna-de-shi-yong/image-20220412225057571.png" alt="image-20220412225057571"><figcaption aria-hidden="true">image-20220412225057571</figcaption></figure><hr><h2 id="jna类的使用">JNA类的使用</h2><ul><li><p>visual studio部分：</p><ul><li>类定义和dll导出<img src="/2023/03/26/jna-jna-de-shi-yong/image-20220415142446647.png" alt="image-20220415142446647"><img src="/2023/03/26/jna-jna-de-shi-yong/image-20220415142533800.png" alt="image-20220415142533800"><img src="/2023/03/26/jna-jna-de-shi-yong/image-20220415142542420.png" alt="image-20220415142542420"></li></ul></li><li><p>idea部分</p><ul><li>interface<img src="/2023/03/26/jna-jna-de-shi-yong/image-20220415142627343.png" alt="image-20220415142627343"></li><li>main<img src="/2023/03/26/jna-jna-de-shi-yong/image-20220415142655636.png" alt="image-20220415142655636"></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> JNA </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>【ROS学习】ROS中的Message</title>
      <link href="/2023/03/26/ros-xue-xi-ros-zhong-de-message/"/>
      <url>/2023/03/26/ros-xue-xi-ros-zhong-de-message/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ros学习ros中的message使用方法">ROS学习:ROS中的message使用方法</h1><p><a href="%5BCopy2000/ROS_msg%20(github.com)%5D(https://github.com/Copy2000/ROS_msg)">代码</a>csdn上面的文章或多或少有一点毛病，不是catkin_package有问题就是CMakeLists配置出现问题。这里我们给出csdn上<a href="%5BROS教程3%20ROS自定义msg类型及使用%20-%20MKT-porter%20-%20博客园%20(cnblogs.com)%5D(https://www.cnblogs.com/gooutlook/p/7401590.html)">最多人看的一篇</a>.</p><p>我看过之后真正说明白的只有<a href="%5B机器人操作系统ROS:从入门到放弃(一)%20发布接收消息%20-%20简书%20(jianshu.com)%5D(https://www.jianshu.com/p/06e0e40cf6da)">here</a>.</p><span id="more"></span><hr><p>创建的方法：</p><pre><code>cd ~/catkin_ws/srccatkin_create_pkg &#123;package&#125; std_msgs rospy roscppcd ..catkin_make</code></pre><p>实现：</p><ul><li>publisher:</li></ul><p><img src="/images/ROS中的message使用\publisher.png" width="50%" height="10%" align="center" title="publisher"></p><ul><li>subscriber:</li></ul><p><img src="/images/ROS中的message使用\subscriber.png" width="50%" height="10%" align="center" title="subscriber"></p><h1 id="geometry_msgs">geometry_msgs</h1><h2 id="geometry_msgsposestamped"><a href="http://docs.ros.org/en/api/geometry_msgs/html/msg/PoseStamped.html">geometry_msgs::PoseStamped</a></h2><pre><code>Raw Message Definition:# A Pose with reference coordinate frame and timestampHeader headerPose pose Compact Message Definition:std_msgs/Header headergeometry_msgs/Pose pose</code></pre><h3 id="std_msgsheader-message"><a href="http://docs.ros.org/en/api/std_msgs/html/index-msg.html">std_msgs</a>/Header Message</h3><p>引用：<a href="https://blog.csdn.net/qq_18676517/article/details/109270525">here</a></p><pre><code># Standard metadata for higher-level stamped data types.# This is generally used to communicate timestamped data # in a particular coordinate frame.# # sequence ID: consecutively increasing ID uint32 seq#Two-integer timestamp that is expressed as:# * stamp.sec: seconds (stamp_secs) since epoch (in Python the variable is called &#39;secs&#39;)# * stamp.nsec: nanoseconds since stamp_secs (in Python the variable is called &#39;nsecs&#39;)# time-handling sugar is provided by the client librarytime stamp#Frame this data is associated withstring frame_id</code></pre><h3 id="geometry_msgspose-message"><a href="http://docs.ros.org/en/api/geometry_msgs/html/index-msg.html">geometry_msgs</a>/Pose Message</h3><pre><code>Raw Message Definition# A representation of pose in free space, composed of position and orientation. Point positionQuaternion orientationCompact Message Definitiongeometry_msgs/Point positiongeometry_msgs/Quaternion orientation</code></pre><h4 id="geometry_msgspoint-message"><a href="http://docs.ros.org/en/api/geometry_msgs/html/index-msg.html">geometry_msgs</a>/Point Message</h4><pre><code># This contains the position of a point in free spacefloat64 xfloat64 yfloat64 z</code></pre><h4 id="geometry_msgsquaternion-message"><a href="http://docs.ros.org/en/api/geometry_msgs/html/index-msg.html">geometry_msgs</a>/Quaternion Message</h4><pre><code># This represents an orientation in free space in quaternion form.float64 xfloat64 yfloat64 zfloat64 w</code></pre><h2 id="geometry_msgstwist-message"><a href="http://docs.ros.org/en/melodic/api/geometry_msgs/html/index-msg.html">geometry_msgs</a>/Twist Message</h2><p>cite:<a href="https://blog.csdn.net/ktigerhero3/article/details/80740920">here</a></p><pre><code># This expresses velocity in free space broken into its linear and angular parts.Vector3 linearVector3 angular </code></pre><h3 id="geometry_msgsvector3-message"><a href="http://docs.ros.org/en/melodic/api/geometry_msgs/html/index-msg.html">geometry_msgs</a>/Vector3 Message</h3><pre><code># This represents a vector in free space. # It is only meant to represent a direction. Therefore, it does not# make sense to apply a translation to it (e.g., when applying a # generic rigid transformation to a Vector3, tf2 will only apply the# rotation). If you want your data to be translatable too, use the# geometry_msgs/Point message instead.float64 xfloat64 yfloat64 z</code></pre><p>使用方法：</p><div class="sourceCode" id="cb9"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main(<span class="dt">int</span> argc,<span class="dt">char</span>** argv)</span><span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>&#123;</span><span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    ros::init(argc,argv,<span class="st">&quot;init&quot;</span>);</span><span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    ros::NodeHandle nh;</span><span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    ros::Publisher Pub = nh.advertise&lt;geometry_msgs::Twist&gt;(<span class="st">&quot;/hector1/cmd_vel&quot;</span>,<span class="dv">10</span>)</span><span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    </span><span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">// 初始化geometry_msgs::Twist类型的消息    </span></span><span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    geometry_msgs::Twist vel_msg;</span><span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    vel_msg.linear.x=<span class="fl">0.2</span>;</span><span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    vel_msg.angular.z=<span class="fl">0.2</span>;</span><span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    </span><span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">// 设置循环的频率</span></span><span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    ros::Rate loop_rate(<span class="dv">10</span>);</span><span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    </span><span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span>(ros::ok)</span><span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    &#123;</span><span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>        ros::spinonce();</span><span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>        Pub.publish(Twist);</span><span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>        </span><span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>        ROS_INFO(<span class="st">&quot;Publsh velocity command[</span><span class="sc">%0.2f</span><span class="st"> m/s, </span><span class="sc">%0.2f</span><span class="st"> rad/s]&quot;</span>, </span><span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>                vel_msg.linear.x, vel_msg.angular.z);</span><span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>        </span><span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>        loop_rate.sleep();</span><span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    &#125;</span><span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span><span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>&#125;</span></code></pre></div><p>linear.x指向机器人前方，linear.y指向左方，linear.z垂直向上满足右手系，平面移动机器人常常linear.y和linear.z均为0；</p><p>angular.z代表平面机器人的角速度，因为此时z轴为旋转轴</p><h2 id="sensor_msgs">sensor_msgs</h2><figure><img src="/2023/03/26/ros-xue-xi-ros-zhong-de-message/image-20220405153718538.png" alt="sensor_msgs"><figcaption aria-hidden="true">sensor_msgs</figcaption></figure><ul><li><p><a href="https://blog.csdn.net/qq_29462849/article/details/88795250">(71条消息) ROS下sensor_msgs::ImagePtr到sensor_msgs::Image之间的转换_Tom Hardy的博客-CSDN博客</a>:ROS下面好像没办法直接定义sensor_msgs/ImagePtr,而是sensor_msgs/Image。然而在从Mat格式转到ROS下的图像格式时，一般都是ImagePtr，这样在发布信息的时候就需要一次转换啦，其实也很简单！</p><div class="sourceCode" id="cb10"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sensor_msgs::ImagePtr msg= cv_bridge::CvImage(std_msgs::Header(), <span class="st">&quot;bgr8&quot;</span>, src).toImageMsg();</span><span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>detect_msg.image_raw=*msg;</span><span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>这里自定义的detect_msg.image_raw就是sensor_msgs/Image格式。</span></code></pre></div></li></ul>]]></content>
      
      
      <categories>
          
          <category> ROS学习 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>【ROS学习】初学ROS的小项目</title>
      <link href="/2023/03/26/ros-xue-xi-chu-xue-ros-de-xiao-xiang-mu/"/>
      <url>/2023/03/26/ros-xue-xi-chu-xue-ros-de-xiao-xiang-mu/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ros学习turtle控制">ROS学习：turtle控制</h1><p><img src="/2023/03/26/ros-xue-xi-chu-xue-ros-de-xiao-xiang-mu/u=585289087,3399034401&amp;fm=253&amp;fmt=auto&amp;app=120&amp;f=JPEG.jpeg" alt="img"><span id="more"></span></p><h2 id="turtle旋转">turtle旋转</h2><p>首先查看turtlesim里面的节点，使用rqt_graph查看节点流图<img src="/2023/03/26/ros-xue-xi-chu-xue-ros-de-xiao-xiang-mu/image-20220314081121445.png" alt="rqt_graph"></p><figure><img src="/2023/03/26/ros-xue-xi-chu-xue-ros-de-xiao-xiang-mu/image-20220314090657384.png" alt="结果展示"><figcaption aria-hidden="true">结果展示</figcaption></figure><div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span><span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * @Description: 这是一个让turtle旋转的ros publisher</span></span><span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * @Version: </span></span><span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"> * @Autor: copy</span></span><span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"> * @Date: 2022-03-12 17:28:55</span></span><span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"> * @LastEditors: copy</span></span><span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"> * @LastEditTime: 2022-03-12 17:42:00</span></span><span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span><span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;ros/ros.h&gt;</span></span><span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;geometry_msgs/Twist.h&quot;</span></span><span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span><span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="pp">#define PI </span><span class="fl">3.141592653</span></span><span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main(<span class="dt">int</span> argc,<span class="dt">char</span>** argv)</span><span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>&#123;</span><span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    ros::init(argc,argv,<span class="st">&quot;turtle_twist&quot;</span>);</span><span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    ros::NodeHandle nh;</span><span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    ros::Publisher Pub = nh.advervise&lt;geometry_msgs::Twist&gt;(<span class="st">&quot;/turtle1/cmd_vel&quot;</span>,<span class="dv">10</span>);</span><span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    geometry_msgs::Twist twist;</span><span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    twist.linear.x = <span class="dv">1</span>;</span><span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    twist.angular.z = PI;</span><span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    ROS_INFO(<span class="st">&quot;</span><span class="sc">\t</span><span class="st">现在的速度是</span><span class="sc">%f</span><span class="st">,偏转速度是</span><span class="sc">%f\t</span><span class="st">&quot;</span>,twist.linear.x,twist.angular.z = PI);</span><span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    ros::Rate rate(<span class="dv">10</span>);<span class="co">//10Hz</span></span><span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span>(ros::OK)</span><span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    &#123;</span><span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        Pub.publish(twist);</span><span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span><span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>        rate.sleep();</span><span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        ros::spin();            <span class="co">//后面的代码不再执行ros::spinOnce();</span></span><span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    &#125;</span><span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span><span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span><span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>&#125;</span></code></pre></div><h2 id="接收turtle位置">接收turtle位置</h2><p>使用rostopic list 和rostopic info [topic]查看turtle的topic，<img src="/2023/03/26/ros-xue-xi-chu-xue-ros-de-xiao-xiang-mu/image-20220314110604770.png" alt="image-20220314110604770"></p><ul><li><p>结果展示</p><figure><img src="/2023/03/26/ros-xue-xi-chu-xue-ros-de-xiao-xiang-mu/image-20220315120427620.png" alt="image-20220315120427620"><figcaption aria-hidden="true">image-20220315120427620</figcaption></figure></li></ul><h2 id="跟踪turtle"><a href="https://github.com/Copy2000/turtle/tree/main/src/turtle_csdn">跟踪turtle</a></h2><p>使用rosservice list 和 rosservice info [service]查看turtle的service-----/Spawn。<img src="/2023/03/26/ros-xue-xi-chu-xue-ros-de-xiao-xiang-mu/image-20220314145138555.png" alt="image-20220314145138555"></p><ul><li><p>rospackage</p><ul><li>rospy</li><li>roscpp</li><li>std_msgs</li><li>turtlesim</li><li>tf</li></ul></li><li><p>turtle_tf_broadcaster.cpp</p><figure><img src="/2023/03/26/ros-xue-xi-chu-xue-ros-de-xiao-xiang-mu/image-20220315115639042.png" alt="turtle_tf_broadcaster"><figcaption aria-hidden="true">turtle_tf_broadcaster</figcaption></figure></li><li><p>turtle_tf_listener.cpp</p><figure><img src="/2023/03/26/ros-xue-xi-chu-xue-ros-de-xiao-xiang-mu/image-20220315115751882.png" alt="turtle_tf_listener"><figcaption aria-hidden="true">turtle_tf_listener</figcaption></figure></li><li><p>start_demo_with_listener.launch</p><figure><img src="/2023/03/26/ros-xue-xi-chu-xue-ros-de-xiao-xiang-mu/image-20220315115814890.png" alt="image-20220315115814890"><figcaption aria-hidden="true">image-20220315115814890</figcaption></figure></li><li><p>结果展示</p></li></ul><p>直接控制<img src="/2023/03/26/ros-xue-xi-chu-xue-ros-de-xiao-xiang-mu/image-20220315115934120.png" alt="image-20220315115934120"><strong>无超调，但是反应慢，稳态误差大</strong></p><p>PID控制</p><figure><img src="/2023/03/26/ros-xue-xi-chu-xue-ros-de-xiao-xiang-mu/image-20220315161802801.png" alt="image-20220315161802801"><figcaption aria-hidden="true">image-20220315161802801</figcaption></figure><p><img src="/2023/03/26/ros-xue-xi-chu-xue-ros-de-xiao-xiang-mu/image-20220315120111915.png" alt="image-20220315120111915"><strong>超调量大，但是反应迅速，稳态误差较小</strong></p><p>相关代码在我的github的<a href="https://github.com/Copy2000/turtle">turtle库中</a></p>]]></content>
      
      
      <categories>
          
          <category> ROS学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 控制 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【ROS学习】坐标变换</title>
      <link href="/2023/03/26/ros-xue-xi-zuo-biao-bian-huan/"/>
      <url>/2023/03/26/ros-xue-xi-zuo-biao-bian-huan/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ros学习坐标变换">ROS学习：坐标变换</h1><span id="more"></span><h2 id="坐标参数">坐标参数</h2><p>本部分参考<a href="https://blog.csdn.net/weixin_45590473/article/details/122884112">彻底搞懂“旋转矩阵/欧拉角/四元数“</a>。</p><h3 id="位姿变换">位姿变换</h3><p>基于O1的世界坐标系与基于O2的坐标系如下所示：</p><figure><img src="/2023/03/26/ros-xue-xi-zuo-biao-bian-huan/image-20220314101746671.png" alt="位姿变换"><figcaption aria-hidden="true">位姿变换</figcaption></figure><h3 id="欧拉角">欧拉角</h3><p>欧拉角遵循的是右手系规则，即大拇指指向坐标轴正方向，四指旋转的方向即为转动的正方向，欧拉角包含三个自由量：yaw(偏航角)、pitch(俯仰角)、roll(翻滚角)。</p><figure><img src="/2023/03/26/ros-xue-xi-zuo-biao-bian-huan/image-20220314102233162.png" alt="image-20220314102233162"><figcaption aria-hidden="true">image-20220314102233162</figcaption></figure><p>由于“绕谁谁不变”的原则，因此Z轴坐标不会发生改变，最终Z轴旋转变换公式如下所示：</p><figure><img src="/2023/03/26/ros-xue-xi-zuo-biao-bian-huan/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6IKl6IKl6IOW6IOW5piv5aSq6Ziz,size_10,color_FFFFFF,t_70,g_se,x_16.png" alt="img"><figcaption aria-hidden="true">img</figcaption></figure><p>得到<img src="/2023/03/26/ros-xue-xi-zuo-biao-bian-huan/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6IKl6IKl6IOW6IOW5piv5aSq6Ziz,size_15,color_FFFFFF,t_70,g_se,x_16.png" alt="旋转矩阵"></p><p>旋转矩阵的旋转顺序分为外旋（x-&gt;y-&gt;z）和内旋（z-&gt;y-&gt;x），我们一般采用外旋的顺序。<img src="/2023/03/26/ros-xue-xi-zuo-biao-bian-huan/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6IKl6IKl6IOW6IOW5piv5aSq6Ziz,size_20,color_FFFFFF,t_70,g_se,x_16.png" alt="外旋"></p><p>无论绕X轴正方向/反方向旋转90度，都会导致Y/Z轴正方向罗在一条直线上！为了解决“死锁“的问题，我们要使用四个自由量，这就引出了”四元数“的概念。</p><h3 id="四元数">四元数</h3><p>复数运算规则：</p><table><thead><tr class="header"><th></th><th><strong>1</strong></th><th><strong>i</strong></th><th><strong>j</strong></th><th><strong>k</strong></th></tr></thead><tbody><tr class="odd"><td><strong>1</strong></td><td>1</td><td>i</td><td>j</td><td>k</td></tr><tr class="even"><td><strong>i</strong></td><td>i</td><td>-1</td><td>k</td><td>-j</td></tr><tr class="odd"><td><strong>j</strong></td><td>j</td><td>-k</td><td>-1</td><td>i</td></tr><tr class="even"><td><strong>k</strong></td><td>k</td><td>j</td><td>-i</td><td>-1</td></tr></tbody></table><h2 id="ros中的静态坐标转换">ROS中的静态坐标转换</h2><p>本部分参考<a href="https://blog.csdn.net/weixin_45590473/article/details/122908060">超级霸霸强的博客</a>。</p><figure><img src="/2023/03/26/ros-xue-xi-zuo-biao-bian-huan/image-20220314101143943.png" alt="静态坐标转换"><figcaption aria-hidden="true">静态坐标转换</figcaption></figure><p>调用transfrom函数进行坐标转换。此外，两者不同之处在于坐标系间的转换关系获取，多坐标系转换中需要调用lookupTransfrom函数对buffer缓冲区内的数据进行复杂计算得到任意两个坐标系的转换关系，而静态/动态坐标系转换关系只需订阅static_tf话题即可得到。</p><h3 id="需要的package">需要的package</h3><p>我们知道使用tf坐标转换除了需要roscpp、rospy、std_msgs这三个基本的功能包外，还需要<strong>tf2、tf2_geometry_msgs、geometry_msgs、tf2_ros</strong>。</p><h3 id="实现逻辑">实现逻辑</h3><figure><img src="/2023/03/26/ros-xue-xi-zuo-biao-bian-huan/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA6IKl6IKl6IOW6IOW5piv5aSq6Ziz,size_20,color_FFFFFF,t_70,g_se,x_16.png" alt="实现逻辑"><figcaption aria-hidden="true">实现逻辑</figcaption></figure>]]></content>
      
      
      <categories>
          
          <category> ROS学习 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>【论文】基于MPC的路径跟踪</title>
      <link href="/2023/03/26/lun-wen-ji-yu-mpc-de-lu-jing-gen-zong/"/>
      <url>/2023/03/26/lun-wen-ji-yu-mpc-de-lu-jing-gen-zong/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="mpc论文归纳">mpc论文归纳</h1><p>《Linear vs Nonlinear MPC for Trajectory Tracking Applied to Rptary Wing Micro Aerial Vehicles》<span id="more"></span></p><h2 id="abstract">Abstract</h2><p>this paper discusses about the applications of <strong>precise trajectory tracking</strong> in cluttered environment or under disturbances when MAVs work. So this paper presents a comparison between classical <strong>linear model predictive controller(LMPC)</strong> against advanced <strong>nonlinear model predictive controller(NMPC)</strong>.</p><h2 id="introduction">Introduction</h2><p>The goal of this comparison is to emphasis the benefits and drawbacks of considering the full system dynamics in terms of performance improvement,disturbance rejection and computation effort.</p><p>To achieve high performance with the cascade approach(级联法),it is necessary to account for the inner-loop dynamics（内循环动力） in the trajectory tracking controller.</p><h2 id="related-work">Related Work</h2><p>Some researchers have found that PID controller was performing better than an <a href="https://zh.wikipedia.org/wiki/LQR控制器">LQ controller</a>(回授控制、线性二次).</p><blockquote><p>hierachical(分层的)</p><p>aerodynamic drag model(气动阻力模型)</p><p>Gaussian Process(高斯过程)</p></blockquote><h2 id="mav-model">MAV Model</h2><table><thead><tr class="header"><th style="text-align: center;">name</th><th style="text-align: center;">meaning</th></tr></thead><tbody><tr class="odd"><td style="text-align: center;">I</td><td style="text-align: center;">the world fixed inertial frame</td></tr><tr class="even"><td style="text-align: center;">B</td><td style="text-align: center;">the body fixed frame</td></tr><tr class="odd"><td style="text-align: center;">v</td><td style="text-align: center;">the vehicle velocity in inertial frame</td></tr><tr class="even"><td style="text-align: center;"><span class="math display">\[\omega\]</span></td><td style="text-align: center;">the body angular rate</td></tr><tr class="odd"><td style="text-align: center;">CoG</td><td style="text-align: center;">the Center of Gravity</td></tr><tr class="even"><td style="text-align: center;"><span class="math display">\[R_{IB}\]</span></td><td style="text-align: center;">the vehicle orientation</td></tr><tr class="odd"><td style="text-align: center;"><span class="math display">\[F_{T,i}\]</span></td><td style="text-align: center;">generated thrust</td></tr><tr class="even"><td style="text-align: center;"><span class="math display">\[M_i\]</span></td><td style="text-align: center;">moment</td></tr><tr class="odd"><td style="text-align: center;">k<sub>d</sub></td><td style="text-align: center;">lumped drag coefficient</td></tr></tbody></table><p>Each propeller generates thrust proportional to the square of the propeller rotation speed and angular moment due to the drag force :由于阻力，每个螺旋桨产生的推力与螺旋桨转速和角力矩的平方成正比</p><figure><img src="/2023/03/26/lun-wen-ji-yu-mpc-de-lu-jing-gen-zong/image-20220302232822684.png" alt="image-20220302232822684"><figcaption aria-hidden="true">image-20220302232822684</figcaption></figure><figure><img src="/2023/03/26/lun-wen-ji-yu-mpc-de-lu-jing-gen-zong/image-20220302231436805.png" alt="image-20220302231436805"><figcaption aria-hidden="true">image-20220302231436805</figcaption></figure><blockquote><p>closed-loop attitude model(闭环姿态模型)</p><p>dynamic maneuvers(动态动作)</p><p>blade flapping(叶片拍打)</p><p>induced drag(诱导阻力)</p><p>damping(阻尼)</p><p>lumped drag coefficient (总阻力系数)</p><p>in</p><p>OCP optimal control problem</p><p>RMSE 均方根误差</p><p>Extended Kalman Filter (EKF)</p></blockquote><h2 id="linear-mpc">LINEAR MPC</h2><p>To achieve a better tracking performance of dynamic trajectories, this paper includes a feed-forward term by setting the reference control input.</p><p>there are so many formulations,so I don't want to repeatedly present those.</p><h2 id="nonlear-mpc">NONLEAR MPC</h2><p>this approach can gains a particular attention recently to address optimal control problems.</p><h2 id="摘要">摘要</h2><p>本文讨论了<strong>精确轨迹跟踪</strong>在 MAV 工作时在杂乱环境或干扰下的应用。 因此，本文将经典的<strong>线性模型预测控制器 (LMPC)</strong> 与先进的<strong>非线性模型预测控制器 (NMPC)</strong> 进行比较。</p><h2 id="介绍">介绍</h2><p>对比了LMPC和NMPC，这种比较的目的是强调考虑整个系统动力学在性能改进、抗干扰和计算工作方面的优点和缺点。 为了使用级联法实现高性能，有必要在轨迹跟踪控制器中考虑内循环动力（inner-loop dynamics）。</p><h2 id="比较">比较</h2><table><colgroup><col style="width: 27%"><col style="width: 36%"><col style="width: 36%"></colgroup><thead><tr class="header"><th style="text-align: center;">条件</th><th style="text-align: center;">LMPC</th><th style="text-align: center;">NMPC</th></tr></thead><tbody><tr class="odd"><td style="text-align: center;">Hovering under no external disturbance</td><td style="text-align: center;">RMSE is 1.84cm</td><td style="text-align: center;">RMSE is 2.05cm</td></tr><tr class="even"><td style="text-align: center;">Hovering under external wind of 11m/s</td><td style="text-align: center;">RMSE is 2.7cm</td><td style="text-align: center;">RMSE is 2.5cm</td></tr><tr class="odd"><td style="text-align: center;">Step Response</td><td style="text-align: center;">rise time is 1.6s and overshoot percentage is 1.98%</td><td style="text-align: center;">rise time is 1.0s and overshoot percentage is 1.98%</td></tr><tr class="even"><td style="text-align: center;">Aggressive Trajectory tracking</td><td style="text-align: center;">RMS is 10.8cm</td><td style="text-align: center;">RMS is 7.1cm</td></tr><tr class="odd"><td style="text-align: center;">Computation effort</td><td style="text-align: center;">an average solve time of 2.35 ms</td><td style="text-align: center;">an average solve time of 0.45 ms</td></tr></tbody></table><blockquote><p>从以上三个方面可以表现出，NMPC比LMPC在复杂环境干扰、阶跃反应、路径跟踪和计算时间中有着更好的表现。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 论文 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 无人机 </tag>
            
            <tag> 路径跟踪 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【ROS学习】配置rotors_simulator</title>
      <link href="/2023/03/26/ros-xue-xi-pei-zhi-rotors-simulator/"/>
      <url>/2023/03/26/ros-xue-xi-pei-zhi-rotors-simulator/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>本文按照https://github.com/ethz-asl/rotors_simulator一步一步搭建并且踩坑记录。</p><span id="more"></span><h2 id="雷">雷</h2><ul><li><p>第一个坑：尽量不要在虚拟机上跑，因为你在catkin make的时候就会卡住。</p></li><li><p>在原文中也提到了，第一次加载gazebo的时候会出现超时error，不要慌，关闭当前gazebo窗口再次输入<strong>用法</strong>的1命令。</p></li><li><p>好像用不了他的其他地图。</p></li><li><p>在ubuntu16环境下也需要将他自己的那个rotors_simulator放到src中。</p></li><li><p>需要仔细端详他给的mavlink，可能版本对不上自己的linux系统。</p></li><li><p>需要安装mavros，具体的方法好像是<code>sudo apt get install ros-kinetic-mavros</code>，有点忘了，网上有很多教程，不麻烦。</p></li></ul><h2 id="用法">用法</h2><ol type="1"><li><p>开启gazebo命令<code>roslaunch rotors_gazebo mav_hovering_example.launch mav_name:=firefly world_name:=basic</code></p></li><li><p>操作MAV</p><blockquote><ul><li>方法一：使用gazebo界面和按压play button（world下面的property），这样好像不太聪明的样子。</li><li>方法二：<code>rosservice call gazebo/unpause_physics</code></li></ul></blockquote></li><li><p>发送direct motor commands</p><p><code>rostopic pub /firefly/command/motor_speed mav_msgs/Actuators '&#123;angular_velocities: [100, 100, 100, 100, 100, 100]&#125;'</code>，需要注意的是，这里的angular_velocities的数组和你无人机的旋翼数目对应，在这个例子中为6旋翼的。</p></li><li><p>create an attitude controller</p></li></ol><ul><li>操纵杆（joystick）无法操作</li><li>使用键盘，按照<a href="%5BSetup%20virtual%20keyboard%20joystick%20·%20ethz-asl/rotors_simulator%20Wiki%20(github.com)%5D(https://github.com/ethz-asl/rotors_simulator/wiki/Setup-virtual-keyboard-joystick)">github网址</a>操作，使用 <code>rosrun rotors_joy_interface key_joystick.py</code>查看permission denied问题是否解决，使用<code>roslaunch rotors_gazebo mav_with_keyboard.launch</code>运行 使用虚拟键盘操纵杆的RotorS。</li></ul><h2 id="package解读">package解读</h2><ul><li>位于src/rotors_simulator/rotors_gazebo/launch中的firefly_swarm_hovering_example.launch文件运行多机盘旋。</li><li>位于src/rotors_simulator/rotors_gazebo/launch中的fixed_wing.launch文件运行固定翼飞机。</li><li>位于src/rotors_simulator/rotors_gazebo/launch中的firefly_swarm_hovering_example.launch文件运行多机盘旋。</li></ul><hr><h2 id="代码解读">代码解读</h2><p>在这之前需要知道：</p><table><thead><tr class="header"><th style="text-align: center;">名词</th><th style="text-align: center;">解释</th></tr></thead><tbody><tr class="odd"><td style="text-align: center;">pitch</td><td style="text-align: center;">围绕X轴旋转，也叫做俯仰角</td></tr><tr class="even"><td style="text-align: center;">yaw</td><td style="text-align: center;">围绕Y轴旋转，也叫偏航角</td></tr><tr class="odd"><td style="text-align: center;">roll</td><td style="text-align: center;">围绕Z轴旋转，也叫翻滚角</td></tr></tbody></table><ul><li>hil_controls_msg</li></ul><table><thead><tr class="header"><th style="text-align: center;">名词</th><th style="text-align: center;">解释</th></tr></thead><tbody><tr class="odd"><td style="text-align: center;">pitch_elevator</td><td style="text-align: center;">自己体会</td></tr><tr class="even"><td style="text-align: center;">yaw_rudder</td><td style="text-align: center;">偏航角舵</td></tr><tr class="odd"><td style="text-align: center;">roll_ailerons</td><td style="text-align: center;">翻滚角副翼</td></tr><tr class="even"><td style="text-align: center;">throttle</td><td style="text-align: center;">风门</td></tr></tbody></table><p>多的不说，直接看rotors_gazebo/src/hovering_example.cpp</p><p>多机 ：firefly_swam_hovering_example.launch，其中需要看waypoint_publisher_file.cpp，其中提到args[x,y,z,yaw,wait_time],按照的是launch文件中的顺序</p>]]></content>
      
      
      <categories>
          
          <category> ROS学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 配置环境 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【网站搭建】hexo的metery主题配置</title>
      <link href="/2023/03/26/wang-zhan-da-jian-hexo-de-metery-zhu-ti-pei-zhi/"/>
      <url>/2023/03/26/wang-zhan-da-jian-hexo-de-metery-zhu-ti-pei-zhi/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="hexo的metery主题配置">hexo的metery主题配置</h1><span id="more"></span><h2 id="修改导航栏颜色">修改导航栏颜色</h2><blockquote><p>打开 <code>themes/matery/source/css/matery.css</code> 文件，找到<code>bg-color</code>这个属性，即为导航栏和底部的颜色</p></blockquote><div class="sourceCode" id="cb1"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="at">.bg-color &#123;</span></span><span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">background-image</span><span class="kw">:</span><span class="at"> linear-gradient(to right,</span><span class="co"> #8cbfb8 0%, #128c6f 100%);</span></span><span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="at">&#125;</span></span></code></pre></div><h2 id="代码块调节">代码块调节</h2><p>打开<code>themes\source\css\matery.css</code>，大概在100到200行左右,修改代码块CSS样式如下</p><div class="sourceCode" id="cb2"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pre &#123;</span><span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span>: <span class="dv">1.5</span><span class="dt">rem</span> <span class="dv">1.5</span><span class="dt">rem</span> <span class="dv">1.5</span><span class="dt">rem</span> <span class="dv">3.3</span><span class="dt">rem</span> <span class="at">!important</span><span class="op">;</span></span><span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">margin</span>: <span class="dv">1</span><span class="dt">rem</span> <span class="dv">0</span> <span class="at">!important</span><span class="op">;</span></span><span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span>: <span class="cn">#272822</span><span class="op">;</span></span><span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">overflow</span>: <span class="bu">auto</span><span class="op">;</span></span><span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border-radius</span>: <span class="dv">0.35</span><span class="dt">rem</span><span class="op">;</span></span><span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tab-size</span>: <span class="dv">4</span><span class="op">;</span></span><span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>&#125;</span><span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">.code-area::after</span> &#123;</span><span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">content</span>: <span class="st">&quot; &quot;</span><span class="op">;</span></span><span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">position</span>: <span class="dv">absolute</span><span class="op">;</span></span><span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border-radius</span>: <span class="dv">50</span><span class="dt">%</span><span class="op">;</span></span><span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span>: <span class="cn">#ff5f56</span><span class="op">;</span></span><span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">width</span>: <span class="dv">12</span><span class="dt">px</span><span class="op">;</span></span><span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">height</span>: <span class="dv">12</span><span class="dt">px</span><span class="op">;</span></span><span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">top</span>: <span class="dv">0</span><span class="op">;</span></span><span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">left</span>: <span class="dv">12</span><span class="dt">px</span><span class="op">;</span></span><span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">margin-top</span>: <span class="dv">12</span><span class="dt">px</span><span class="op">;</span></span><span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">-webkit-box-shadow</span>: <span class="dv">20</span><span class="dt">px</span> <span class="dv">0</span> <span class="cn">#ffbd2e</span><span class="op">,</span> <span class="dv">40</span><span class="dt">px</span> <span class="dv">0</span> <span class="cn">#27c93f</span><span class="op">;</span></span><span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">box-shadow</span>: <span class="dv">20</span><span class="dt">px</span> <span class="dv">0</span> <span class="cn">#ffbd2e</span><span class="op">,</span> <span class="dv">40</span><span class="dt">px</span> <span class="dv">0</span> <span class="cn">#27c93f</span><span class="op">;</span></span><span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>&#125;</span><span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>code &#123;</span><span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span>: <span class="dv">1</span><span class="dt">px</span> <span class="dv">5</span><span class="dt">px</span><span class="op">;</span></span><span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">top</span>: <span class="dv">13</span><span class="dt">px</span> <span class="at">!important</span><span class="op">;</span></span><span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">font-family</span>: Inconsolata<span class="op">,</span> Monaco<span class="op">,</span> Consolas<span class="op">,</span> <span class="st">&#39;Courier New&#39;</span><span class="op">,</span> Courier<span class="op">,</span> <span class="dv">monospace</span><span class="op">;</span></span><span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">font-size</span>: <span class="dv">0.91</span><span class="dt">rem</span><span class="op">;</span></span><span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span>: <span class="cn">#e96900</span><span class="op">;</span></span><span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background-color</span>: <span class="cn">#f8f8f8</span><span class="op">;</span></span><span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border-radius</span>: <span class="dv">2</span><span class="dt">px</span><span class="op">;</span></span><span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>&#125;</span><span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="fu">.code_copy</span> &#123;</span><span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">position</span>: <span class="dv">absolute</span><span class="op">;</span></span><span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">top</span>: <span class="dv">0.7</span><span class="dt">rem</span><span class="op">;</span></span><span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">right</span>: <span class="dv">25</span><span class="dt">px</span><span class="op">;</span></span><span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">z-index</span>: <span class="dv">1</span><span class="op">;</span></span><span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">filter</span>: <span class="fu">invert(</span><span class="dv">50</span><span class="dt">%</span><span class="fu">)</span><span class="op">;</span></span><span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">cursor</span>: <span class="dv">pointer</span><span class="op">;</span></span><span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>&#125;</span><span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="fu">.codecopy_notice</span> &#123;</span><span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">position</span>: <span class="dv">absolute</span><span class="op">;</span></span><span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">top</span>: <span class="dv">0.7</span><span class="dt">rem</span><span class="op">;</span></span><span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">right</span>: <span class="dv">6</span><span class="dt">px</span><span class="op">;</span></span><span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">z-index</span>: <span class="dv">1</span><span class="op">;</span></span><span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    <span class="kw">filter</span>: <span class="fu">invert(</span><span class="dv">50</span><span class="dt">%</span><span class="fu">)</span><span class="op">;</span></span><span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">opacity</span>: <span class="dv">0</span><span class="op">;</span></span><span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>&#125;</span><span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a><span class="fu">.code_lang</span> &#123;</span><span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">position</span>: <span class="dv">absolute</span><span class="op">;</span></span><span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">top</span>: <span class="dv">1.2</span><span class="dt">rem</span><span class="op">;</span></span><span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">right</span>: <span class="dv">46</span><span class="dt">px</span><span class="op">;</span></span><span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>    <span class="kw">line-height</span>: <span class="dv">0</span><span class="op">;</span></span><span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">font-weight</span>: <span class="dv">bold</span><span class="op">;</span></span><span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">font-family</span>: <span class="dv">normal</span><span class="op">;</span></span><span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>    <span class="kw">z-index</span>: <span class="dv">1</span><span class="op">;</span></span><span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">filter</span>: <span class="fu">invert(</span><span class="dv">50</span><span class="dt">%</span><span class="fu">)</span><span class="op">;</span></span><span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    <span class="kw">cursor</span>: <span class="dv">pointer</span><span class="op">;</span></span><span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>&#125;</span><span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a></span><span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a><span class="fu">.code-expand</span> &#123;</span><span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>    <span class="kw">position</span>: <span class="dv">absolute</span><span class="op">;</span></span><span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    <span class="kw">top</span>: <span class="dv">4</span><span class="dt">px</span><span class="op">;</span></span><span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>    <span class="kw">right</span>: <span class="dv">0</span><span class="dt">px</span><span class="op">;</span></span><span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>    <span class="kw">filter</span>: <span class="fu">invert(</span><span class="dv">50</span><span class="dt">%</span><span class="fu">)</span><span class="op">;</span></span><span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span>: <span class="dv">7</span><span class="dt">px</span><span class="op">;</span></span><span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>    <span class="kw">z-index</span>: <span class="dv">999</span> <span class="at">!important</span><span class="op">;</span></span><span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>    <span class="kw">cursor</span>: <span class="dv">pointer</span><span class="op">;</span></span><span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>    <span class="kw">transition</span>: <span class="dv">all</span> <span class="dv">.3</span><span class="dt">s</span><span class="op">;</span></span><span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>    <span class="kw">transform</span>: <span class="fu">rotate(</span><span class="dv">0</span><span class="dt">deg</span><span class="fu">)</span><span class="op">;</span></span><span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>&#125;</span><span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a></span><span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a><span class="fu">.code-closed</span> <span class="fu">.code-expand</span> &#123;</span><span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>    <span class="kw">transform</span>: <span class="fu">rotate(</span><span class="dv">-180</span><span class="dt">deg</span><span class="fu">)</span> <span class="at">!important</span><span class="op">;</span></span><span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>    <span class="kw">transition</span>: <span class="dv">all</span> <span class="dv">.3</span><span class="dt">s</span><span class="op">;</span></span><span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>&#125;</span><span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a></span><span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a><span class="fu">.code-closed</span> pre<span class="in">::before</span> &#123;</span><span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>    <span class="kw">height</span>: <span class="dv">0</span><span class="dt">px</span><span class="op">;</span></span><span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>&#125;</span><span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a></span><span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>pre code &#123;</span><span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span>: <span class="dv">0</span><span class="op">;</span></span><span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span>: <span class="cn">#e8eaf6</span><span class="op">;</span></span><span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background-color</span>: <span class="cn">#272822</span><span class="op">;</span></span><span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>&#125;</span><span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a></span><span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>pre<span class="ex">[class</span><span class="op">*=</span><span class="st">&quot;language-&quot;</span><span class="ex">]</span> &#123;</span><span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span>: <span class="dv">1.2</span><span class="dt">em</span><span class="op">;</span></span><span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>    <span class="kw">margin</span>: <span class="dv">.5</span><span class="dt">em</span> <span class="dv">0</span><span class="op">;</span></span><span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>&#125;</span><span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a></span><span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>code<span class="ex">[class</span><span class="op">*=</span><span class="st">&quot;language-&quot;</span><span class="ex">]</span><span class="op">,</span></span><span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>pre<span class="ex">[class</span><span class="op">*=</span><span class="st">&quot;language-&quot;</span><span class="ex">]</span> &#123;</span><span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span>: <span class="cn">#e8eaf6</span><span class="op">;</span></span><span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>    <span class="kw">white-space</span>: <span class="dv">pre-wrap</span> <span class="at">!important</span><span class="op">;</span></span><span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>&#125;</span><span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a></span><span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a><span class="fu">.line-numbers-rows</span> &#123;</span><span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border-right-width</span>: <span class="dv">0</span><span class="dt">px</span> <span class="at">!important</span><span class="op">;</span></span><span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>&#125;</span><span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a></span><span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a><span class="fu">.line-numbers</span> &#123;</span><span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span>: <span class="dv">1.5</span><span class="dt">rem</span> <span class="dv">1.5</span><span class="dt">rem</span> <span class="dv">1.5</span><span class="dt">rem</span> <span class="dv">3.2</span><span class="dt">rem</span> <span class="at">!important</span><span class="op">;</span></span><span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>    <span class="kw">margin</span>: <span class="dv">1</span><span class="dt">rem</span> <span class="dv">0</span> <span class="at">!important</span><span class="op">;</span></span><span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>    <span class="kw">background</span>: <span class="cn">#272822</span><span class="op">;</span></span><span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>    <span class="kw">overflow</span>: <span class="bu">auto</span><span class="op">;</span></span><span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border-radius</span>: <span class="dv">0.35</span><span class="dt">rem</span><span class="op">;</span></span><span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>    <span class="kw">tab-size</span>: <span class="dv">4</span><span class="op">;</span></span><span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>&#125;</span><span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>来源<span class="in">: LuckySec</span></span><span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>文章作者<span class="in">: LuckySec</span></span><span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>文章链接<span class="in">: http://luckyzmj</span><span class="fu">.cn</span>/posts/1b9a9e28<span class="fu">.html</span></span></code></pre></div><h2 id="关于主页图片被颜色覆盖">关于主页图片被颜色覆盖</h2><p><code>themes\hexo-theme-matery\source\css</code>中一个叫<code>matery.css</code>文件的595行代码造成的，如下：</p><div class="sourceCode" id="cb3"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.bg-cover:before</span><span class="op">,</span></span><span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">.bg-cover:after</span> &#123;</span><span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">position</span>: <span class="dv">absolute</span><span class="op">;</span></span><span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">z-index</span>: <span class="dv">1</span><span class="op">;</span></span><span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">width</span>: <span class="dv">100</span><span class="dt">%</span><span class="op">;</span></span><span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">height</span>: <span class="dv">100</span><span class="dt">%</span><span class="op">;</span></span><span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span>: <span class="dv">block</span><span class="op">;</span></span><span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">left</span>: <span class="dv">0</span><span class="op">;</span></span><span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">top</span>: <span class="dv">0</span><span class="op">;</span></span><span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">content</span>: <span class="st">&quot;&quot;</span><span class="op">;</span> </span><span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>&#125;</span></code></pre></div><p>只要将content属性注释掉即可，如下：</p><div class="sourceCode" id="cb4"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.bg-cover:before</span><span class="op">,</span></span><span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">.bg-cover:after</span> &#123;</span><span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">position</span>: <span class="dv">absolute</span><span class="op">;</span></span><span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">z-index</span>: <span class="dv">1</span><span class="op">;</span></span><span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">width</span>: <span class="dv">100</span><span class="dt">%</span><span class="op">;</span></span><span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">height</span>: <span class="dv">100</span><span class="dt">%</span><span class="op">;</span></span><span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">display</span>: <span class="dv">block</span><span class="op">;</span></span><span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">left</span>: <span class="dv">0</span><span class="op">;</span></span><span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">top</span>: <span class="dv">0</span><span class="op">;</span></span><span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* content: &quot;&quot;; */</span> </span><span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>&#125;</span></code></pre></div>]]></content>
      
      
      <categories>
          
          <category> 网站搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【实验】遗传算法的超参数优化</title>
      <link href="/2023/03/26/shi-yan-yi-chuan-suan-fa-de-chao-can-shu-you-hua/"/>
      <url>/2023/03/26/shi-yan-yi-chuan-suan-fa-de-chao-can-shu-you-hua/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><span id="more"></span><h1 id="wine数据集分类结果">wine数据集分类结果</h1><h2 id="grid-search">Grid Search</h2><blockquote><p>best parameters: {'algorithm': 'SAMME', 'learning_rate': 0.3593813663804626, 'n_estimators': 60} best score: 0.9720634920634922 Time Elapse: 113.00295925140381</p></blockquote><h2 id="grid-search-based-ga">Grid Search Based GA</h2><blockquote><p>Best individual is: {'n_estimators': 100, 'learning_rate': 0.3593813663804626, 'algorithm': 'SAMME'} with fitness: 0.9719101123595506 Time Elapsed = 46.56487488746643</p></blockquote><h2 id="ga">GA</h2><h3 id="结果">结果：</h3><ol type="1"><li><blockquote><div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>POPULATION_SIZE <span class="op">=</span> <span class="dv">10</span></span><span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>P_CROSSOVER <span class="op">=</span> <span class="fl">0.9</span>  <span class="co"># probability for crossover</span></span><span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>P_MUTATION <span class="op">=</span> <span class="fl">0.5</span>   <span class="co"># probability for mutating an individual</span></span><span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>MAX_GENERATIONS <span class="op">=</span> <span class="dv">10</span></span><span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>HALL_OF_FAME_SIZE <span class="op">=</span> <span class="dv">5</span></span><span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>CROWDING_FACTOR <span class="op">=</span> <span class="fl">20.0</span>  <span class="co"># crowding factor for crossover and mutation</span></span></code></pre></div></blockquote><blockquote><p>Best solution is: params = (67, 0.34684801135281196, 'SAMME') Accuracy = 0.97206</p><figure><img src="/2023/03/26/shi-yan-yi-chuan-suan-fa-de-chao-can-shu-you-hua/image-20220524104037648-16536690910371.png" alt="image-20220524104037648"><figcaption aria-hidden="true">image-20220524104037648</figcaption></figure></blockquote></li><li><blockquote><p>POPULATION_SIZE = 10 P_CROSSOVER = 0.9 # probability for crossover P_MUTATION = 0.5 # probability for mutating an individual MAX_GENERATIONS = 10 HALL_OF_FAME_SIZE = 5 CROWDING_FACTOR = 20.0 # crowding factor for crossover and mutation</p></blockquote><blockquote><p>Best solution is: params = (67, 0.34684801135281196, 'SAMME') Accuracy = 0.97206</p><figure><img src="/2023/03/26/shi-yan-yi-chuan-suan-fa-de-chao-can-shu-you-hua/image-20220524104239562-16536690910372.png" alt="image-20220524104239562"><figcaption aria-hidden="true">image-20220524104239562</figcaption></figure></blockquote></li></ol><h2 id="pso">PSO</h2><h3 id="算法大致步骤">算法大致步骤：</h3><ul><li>初始化</li><li>更新</li></ul><p>可参考的blog：<a href="https://blog.csdn.net/qq_41687938/article/details/122641718">(87条消息) 智能优化算法——粒子群算法原理与仿真程序_子木呀的博客-CSDN博客_粒子群优化算法原理</a></p><h3 id="代码实现设置的条件">代码实现设置的条件：</h3><div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>MAX_Generation <span class="op">=</span> <span class="dv">10</span>     <span class="co">#迭代次数</span></span><span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>Population <span class="op">=</span> <span class="dv">10</span>         <span class="co">#种群数量</span></span><span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>dimension <span class="op">=</span> <span class="dv">3</span></span><span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>v_low <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span><span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>v_high <span class="op">=</span> <span class="dv">1</span></span><span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>pso <span class="op">=</span> PSO(dimension, MAX_Generation, Population,</span><span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>              BOUNDS_LOW, BOUNDS_HIGH, v_low, v_high) <span class="co">#实现的class</span></span></code></pre></div><h3 id="更新步骤的核心代码">更新步骤的核心代码:</h3><p>网上搜一下，其中w自身权重系数（记不清了），c1是个体学习系数，c2是群落学习系数</p><div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>c1 <span class="op">=</span> <span class="fl">2.0</span>  <span class="co"># 学习因子</span></span><span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>c2 <span class="op">=</span> <span class="fl">2.0</span></span><span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> <span class="fl">0.8</span></span><span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 更新速度(核心公式)</span></span><span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="va">self</span>.v[i] <span class="op">=</span> w <span class="op">*</span> <span class="va">self</span>.v[i] <span class="op">+</span> c1 <span class="op">*</span> random.uniform(<span class="dv">0</span>, <span class="dv">1</span>) <span class="op">*</span> (</span><span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.p_best[i] <span class="op">-</span> <span class="va">self</span>.x[i]) <span class="op">+</span> c2 <span class="op">*</span> random.uniform(<span class="dv">0</span>, <span class="dv">1</span>) <span class="op">*</span> (<span class="va">self</span>.g_best <span class="op">-</span> <span class="va">self</span>.x[i])</span><span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 速度限制</span></span><span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.dimension):</span><span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="va">self</span>.v[i][j] <span class="op">&lt;</span> <span class="va">self</span>.v_low:</span><span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.v[i][j] <span class="op">=</span> <span class="va">self</span>.v_low</span><span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="va">self</span>.v[i][j] <span class="op">&gt;</span> <span class="va">self</span>.v_high:</span><span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.v[i][j] <span class="op">=</span> <span class="va">self</span>.v_high</span><span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span><span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 更新位置</span></span><span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="va">self</span>.x[i] <span class="op">=</span> <span class="va">self</span>.x[i] <span class="op">+</span> <span class="va">self</span>.v[i]</span><span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 位置限制</span></span><span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.dimension):</span><span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="va">self</span>.x[i][j] <span class="op">&lt;</span> <span class="va">self</span>.bound[<span class="dv">0</span>][j]:</span><span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.x[i][j] <span class="op">=</span> <span class="va">self</span>.bound[<span class="dv">0</span>][j]</span><span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="va">self</span>.x[i][j] <span class="op">&gt;</span> <span class="va">self</span>.bound[<span class="dv">1</span>][j]:</span><span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.x[i][j] <span class="op">=</span> <span class="va">self</span>.bound[<span class="dv">1</span>][j]</span></code></pre></div><p>大致的意思就是通过公式更新速度和位置，同时对更新后的速度与位置进行修正，因为更新的位置一定是在一定的范围之内的。</p><h3 id="结果-1">结果：</h3><ol type="1"><li><blockquote><p>MAX_Generation = 10 #迭代次数 Population = 10 #种群数量</p><p>v_low = -1</p><p>v_high = 1</p><p>c1 = 2.0 # 学习因子 c2 = 2.0 w = 0.8</p><hr></blockquote><blockquote><p>n_estimators'=97.59544738, 'learning_rate'=0.93788895, 'algorithm'=SAMME 0.9830158730158731 当前的最佳适应度：0.9830158730158731 time cost: 175.3606903553009</p><figure><img src="/2023/03/26/shi-yan-yi-chuan-suan-fa-de-chao-can-shu-you-hua/image-20220523224042529-16536690910373.png" alt="image-20220523224042529"><figcaption aria-hidden="true">image-20220523224042529</figcaption></figure></blockquote></li><li><blockquote><p class="heading" id="改变迭代次数和种群大小">改变迭代次数和种群大小</p><p>MAX_Generation = 50 #迭代次数 Population = 20 #种群数量</p><p>v_low = -1</p><p>v_high = 1</p><p>c1 = 2.0 # 学习因子 c2 = 2.0 w = 0.8</p></blockquote><blockquote><p>当前最佳位置：[22.63664273 0.7580015 0.39425009] 0.9831746031746033 当前的最佳适应度：0.9831746031746033 time cost: 1097.9579124450684 s</p><figure><img src="/2023/03/26/shi-yan-yi-chuan-suan-fa-de-chao-can-shu-you-hua/image-20220523235957152-16536690910384.png" alt="image-20220523235957152"><figcaption aria-hidden="true">image-20220523235957152</figcaption></figure></blockquote></li><li><blockquote><p class="heading" id="改变速度大小">改变速度大小</p><p>MAX_Generation = 50 #迭代次数 Population = 20 #种群数量</p><p>v_low = -0.5</p><p>v_high = 0.5</p><p>c1 = 2.0 # 学习因子 c2 = 2.0 w = 0.8</p></blockquote><blockquote><p>当前最佳位置：[7.49302006e+01 6.20588351e-01 2.87210702e-02] 0.9831746031746033 当前的最佳适应度：0.9831746031746033 time cost: 1510.600219488144 s<img src="/2023/03/26/shi-yan-yi-chuan-suan-fa-de-chao-can-shu-you-hua/image-20220524090749388-16536690910385.png" alt="image-20220524090749388"></p></blockquote></li><li><blockquote><p class="heading" id="改变速度范围">改变速度范围</p><p>MAX_Generation = 50 #迭代次数 Population = 20 #种群数量</p><p>v_low = [-10, -0.1, -0.5]</p><p>v_high = [10, 0.1, 0.5]</p><p>c1 = 2.0 # 学习因子 c2 = 2.0 w = 0.8</p></blockquote><blockquote><p>当前最佳位置：[17.96950042 0.88984003 0. ] 0.9885714285714287 当前的最佳适应度：0.9885714285714287 time cost: 1343.2985899448395 s</p><figure><img src="/2023/03/26/shi-yan-yi-chuan-suan-fa-de-chao-can-shu-you-hua/image-20220524093834412-16536690910386.png" alt="image-20220524093834412"><figcaption aria-hidden="true">image-20220524093834412</figcaption></figure></blockquote></li><li><blockquote><p>改变初始化</p></blockquote><blockquote><p>当前最佳位置：[58.67594087 0.40936569 0. ] 0.9776190476190475 当前的最佳适应度：0.9776190476190475 time cost: 2636.623948097229 s</p><figure><img src="/2023/03/26/shi-yan-yi-chuan-suan-fa-de-chao-can-shu-you-hua/image-20220524110732371-16536690910387.png" alt="image-20220524110732371"><figcaption aria-hidden="true">image-20220524110732371</figcaption></figure></blockquote></li></ol>]]></content>
      
      
      <categories>
          
          <category> 超参数优化 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 遗传算法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【实验】粒子群算法的超参数优化</title>
      <link href="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/"/>
      <url>/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="粒子群算法的超参数优化">粒子群算法的超参数优化</h1><h2 id="粒子群算法概述">粒子群算法概述</h2><p>粒子群优化算法（Particle Swarm Optimization）是由美国的Kennedy和Eberhart 两位博士提出的一种优化算法。这种算法基于Boid模型。Reynolds通过观察自然界中，鸟类聚集飞行的行为，提出了Boid模型。在 Boid中，每个个体是一个 Boid，它们各自均可感知到周围其他Boid 的位置信息。然后，利用该信息来作为决策自身行动的一个依据。最后结合自身状态（一般为位置、速度、方向等)，更新自身的位置。</p><h3 id="粒子群算法的原理">粒子群算法的原理</h3><ul><li>速度更新<span class="math display">\[v_{id}^{t}+c_1r_1(pbest^t_{id}-x_{id}^2)+c_2r_2(gbest_d^t-x_{id}^t)\]</span></li><li>位置更新<span class="math display">\[x_{id}^{t+1}=x_{id}^t+v_{id}^t\]</span></li></ul><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220528232219148.png" alt="粒子群算法"><figcaption aria-hidden="true">粒子群算法</figcaption></figure><h2 id="wine数据集代码运行流程">wine数据集代码运行流程</h2><p><a href="https://github.com/Copy2000/computation_intelligence/tree/main/红酒数据集">代码在这里</a></p><p>主要是进行一个分类器的超参数优化；</p><p>超参数：</p><ul><li>n_estimators</li><li>learning_rate</li><li>algorithm</li></ul><p>前置条件：</p><div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>MAX_Generation <span class="op">=</span> <span class="dv">5</span></span><span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>Population <span class="op">=</span> <span class="dv">5</span></span><span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>dimension <span class="op">=</span> <span class="dv">3</span></span><span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>v_low <span class="op">=</span> [<span class="op">-</span><span class="dv">5</span>,<span class="op">-</span><span class="fl">0.1</span>,<span class="op">-</span><span class="fl">0.5</span>]</span><span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>v_high <span class="op">=</span> [<span class="dv">5</span>,<span class="fl">0.1</span>,<span class="fl">0.5</span>]</span><span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># [n_estimators, learning_rate, algorithm]:</span></span><span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>BOUNDS_LOW <span class="op">=</span> [<span class="dv">1</span>, <span class="fl">0.01</span>, <span class="dv">0</span>]</span><span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>BOUNDS_HIGH <span class="op">=</span> [<span class="dv">100</span>, <span class="fl">1.00</span>, <span class="dv">1</span>]</span></code></pre></div><p>为了方便查看一个五个个体的粒子群迭代五次。</p><p>虽然可以一次性展示出来，但是我懒得改代码了，应该改成迭代三次的！！！</p><h3 id="初始化数据">初始化数据</h3><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220528235138503.png" alt="x"><figcaption aria-hidden="true">x</figcaption></figure><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220528235155649.png" alt="v"><figcaption aria-hidden="true">v</figcaption></figure><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220528235226163.png" alt="最好个体的超参数"><figcaption aria-hidden="true">最好个体的超参数</figcaption></figure><p>对应g_best(global best individual)的适应度：0.9607936507936508</p><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220528235351637.png" alt="各个体最好超参数"><figcaption aria-hidden="true">各个体最好超参数</figcaption></figure><p>对应上面的p_best(personal best individual)个体适应度</p><p>[0.9099999999999999, 0.9606349206349206, 0.943968253968254, 0.9212698412698412, 0.9607936507936508]</p><h3 id="第一次迭代">第一次迭代</h3><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220528235642461.png" alt="x"><figcaption aria-hidden="true">x</figcaption></figure><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220528235704145.png" alt="v"><figcaption aria-hidden="true">v</figcaption></figure><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220528235734519.png" alt="g_best"><figcaption aria-hidden="true">g_best</figcaption></figure><p>fitness: 0.9663492063492063</p><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220528235751596.png" alt="p_best"><figcaption aria-hidden="true">p_best</figcaption></figure><p>fitness:</p><p>[0.9663492063492063, 0.9606349206349206, 0.9607936507936508, 0.9495238095238093, 0.9607936507936508]</p><h3 id="第二次迭代">第二次迭代</h3><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220528235924157.png" alt="x"><figcaption aria-hidden="true">x</figcaption></figure><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220528235957936.png" alt="v"><figcaption aria-hidden="true">v</figcaption></figure><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220529000019319.png" alt="g_best"><figcaption aria-hidden="true">g_best</figcaption></figure><p>global best并没有发生改变</p><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220529000047018.png" alt="p_best"><figcaption aria-hidden="true">p_best</figcaption></figure><p>fitness:</p><p>[0.9719047619047618, 0.9663492063492063, 0.9607936507936508, 0.9607936507936508, 0.9607936507936508]</p><h3 id="第三次迭代">第三次迭代</h3><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220529000207508.png" alt="x"><figcaption aria-hidden="true">x</figcaption></figure><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220529000220197.png" alt="v"><figcaption aria-hidden="true">v</figcaption></figure><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220529000242494.png" alt="g_best"><figcaption aria-hidden="true">g_best</figcaption></figure><p>fitness:0.9719047619047618</p><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220529000314565.png" alt="p_best"><figcaption aria-hidden="true">p_best</figcaption></figure><p>fitness:</p><p>[0.9719047619047618, 0.9663492063492063, 0.9663492063492063, 0.9663492063492063, 0.9663492063492063]</p><h3 id="第四次迭代">第四次迭代</h3><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220529000413523.png" alt="x"><figcaption aria-hidden="true">x</figcaption></figure><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220529000452301.png" alt="v"><figcaption aria-hidden="true">v</figcaption></figure><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220529000519776.png" alt="g_best"><figcaption aria-hidden="true">g_best</figcaption></figure><p>fitness:0.9720634920634922</p><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220529000644365.png" alt="p_best"><figcaption aria-hidden="true">p_best</figcaption></figure><p>[0.9719047619047618, 0.9663492063492063, 0.9663492063492063, 0.9720634920634922, 0.9663492063492063]</p><h3 id="第五次迭代">第五次迭代</h3><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220529001012313.png" alt="x"><figcaption aria-hidden="true">x</figcaption></figure><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220529001026322.png" alt="g_best"><figcaption aria-hidden="true">g_best</figcaption></figure><p>0.9720634920634922</p><figure><img src="/2023/03/26/shi-yan-li-zi-qun-suan-fa-de-chao-can-shu-you-hua/image-20220529001056708.png" alt="p_best"><figcaption aria-hidden="true">p_best</figcaption></figure><p>[0.9719047619047618, 0.9663492063492063, 0.9663492063492063, 0.9720634920634922, 0.9720634920634922]</p>]]></content>
      
      
      <categories>
          
          <category> 超参数优化 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 粒子群算法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【论文】基于DMPC的路径规划</title>
      <link href="/2023/03/26/lun-wen-ji-yu-dmpc-de-lu-jing-gui-hua/"/>
      <url>/2023/03/26/lun-wen-ji-yu-dmpc-de-lu-jing-gui-hua/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="dmpc">DMPC</h1><p>论文：《Trajectory Generation for Multiagent Point-To-Point</p><p>Transitions via Distributed Model Predictive Control》</p><figure><img src="/2023/03/26/lun-wen-ji-yu-dmpc-de-lu-jing-gui-hua/image-20220402230235448.png" alt="DMPC"><figcaption aria-hidden="true">DMPC</figcaption></figure><span id="more"></span><h2 id="摘要">摘要</h2><ul><li>介绍了 一种基于分布式模型预测控制（DMPC）的多智能体offline轨迹生成算法。</li><li>通过预测未来状态并与附近的agents共享此消息，agent 能够在朝着目标前进的同时检测并进行避障。</li><li>提出的算法以分布式（distributed）方式实现，与基于顺序凸规划（sequential convex programming）SCP的优化方法相比<em>计算时间减少了85%</em>，同时<em>对最优性的影响最小</em>。</li></ul><h2 id="介绍">介绍</h2><ul><li>Multiagent point-to-point transition：多智能体点对点的转换有两个变量<ul><li><strong>the labelled agent problem：每一个agent都有一个固定的不能与另外一个agent交换的固定的最终位置。</strong>（本文着重讨论的）</li><li>the unlabelled agent problem：算法可以自由的将goals分配给agents，以减轻转换问题的复杂度。</li></ul></li><li>the labelled agent problem的解决方法：<ol type="1"><li>将他看做一个优化问题，比如混合整数线性规划MILP（Mixed Integer Linear Programming），使用二进制变量（0和1）构建碰撞约束。有一个致命的缺点就是计算复杂度太大，导致不适用于多agents。</li><li>顺序凸规划SCP比MILP的<strong>计算时间少</strong>，而且SCP是用于<strong>计算四旋翼集群的最佳能量轨迹</strong>；但是缺点也很明显，就是算法不能随着agent的数量增加而扩展，但是好像最近提出了一种decoupled版本的SCP，但是随着agent的增加，成功率也下降了。</li><li>分布式优化方法与集中式方法相比减少了计算时间。ORCA利用速度障碍（velocity obstacles）来雀儿包完整性agent和非完整性agent的无碰撞轨迹。<strong>因为他假设在一段时间内具有恒定的速度，所以该方法比较保守（conservative）</strong>。</li><li>关于本文介绍的DMPC。</li></ol></li></ul><h2 id="问题陈述">问题陈述</h2><h3 id="the-agents">the agents</h3><p><span class="math display">\[p_i[k+1]=p_i[k]+hv_i[k]+\frac{h^2}{2}a_i[k]\]</span></p><p><span class="math display">\[v_i[k+1]=v_i[k]+ha_i[k]\]</span></p><p>第i个agent在k时刻的position、velocity、acceleration。其中<span class="math inline">\(a_i[k]\)</span>是输入，h是离散化步骤h（discretization step h）。</p><h3 id="constraints">Constraints</h3><p>首先约束<span id="anchor">驱动约束：</span></p><ul><li>加速度有一个最大和最小的约束</li><li>因为是在室内（indoor）进行试验，位置会有一个范围约束</li></ul><h3 id="collision-avoidance">Collision Avoidance</h3><p>agent i和agent j之间的碰撞约束为：</p><p><span class="math display">\[\Vert\Theta^{-1}(p_i[k]-p_j[k]) \Vert_n \geq r_{min}\]</span></p><p>n一般取2，r<sub>min</sub>就是agent之间的最小距离，<span class="math inline">\(\Theta\)</span>是缩放矩阵（scaling matrix），定义为<span class="math inline">\(\Theta=diag(a,b,c)\)</span>，a=b=1，c&gt;1，这样的话就会要求竖直轴（z轴）方向上的最小距离为r<sub>z,min</sub>=cr<sub>min</sub>。</p><h2 id="dmpc-1">DMPC</h2><p>在问题陈述部分提出的问题，可以看做一个优化问题，在每个时间步进解决一个问题，该问题基于描述agent动力学模型在给定的预测范围内找到<strong>最佳输入序列</strong>。<strong>该序列的第一个输入应用于真实系统并且测量结果状态（resulting state），这是下一个优化问题的起点（starting point）</strong>。但是这篇文章在输入之后不测量agents的状态，因为还没有布置实际的agent，而是<strong>将输入直接应用于模型用来计算生成下一步的轨迹</strong>。重复上一步直到生成全部的轨迹。</p><blockquote><p style="color:red;">所以我们以分布式方式应用，就是让每个agent执行上述的迭代的优化问题去生成轨迹，并且和临近的agent分享信息。</p></blockquote><h3 id="synchronous-algorithm">Synchronous Algorithm</h3><p>计算新的输入序列步骤：</p><ul><li><p style="color:red;">使用在k<sub>i</sub>-1步计算的临近的agent的最新预测状态检查未来是否会发生碰撞。</p></li><li><p style="color:red;">构建包括状态（state）、动力（actuation）以及碰撞（collision）在内的约束优化问题。</p></li><li><p style="color:red;">在获得下一个最优序列之后，将序列的第一个元素应用于模型，agent向前移动一步。</p></li></ul><h3 id="the-agent-prediction-model">The Agent Prediction Model</h3><p>数学公式太难打了，大致的思想就是自己定义了一个算数运算符<span class="math inline">\([k\vert k_t]\)</span>，然后代到上面（1）（2）式子中去，<img src="/2023/03/26/lun-wen-ji-yu-dmpc-de-lu-jing-gui-hua/image-20220402233010792.png" alt="formula"></p><p>后面的东西就看不懂了。</p><h3 id="objective-function">Objective Function</h3><p>目标函数主要有三个组成部分：</p><ul><li><p>轨迹误差（trajectory error）</p><p>这一部分主要是驱使agent到达goal，定义误差和为<span class="math display">\[e_i=\sum^K_{k=K-j}\Vert p_i[k\vert k_t]-p_{d,i}\Vert_2\]</span></p><p>其中j为最后的time step，<span class="math inline">\(p_{d,i}\)</span>是desired final position。</p><p style="color:red;"></p><p>j越大，会导致agent的行为比较激进，agent会更快的朝着目标移动，但是也可能会导致目标位置超调（overshoot）</p><p></p><p>我在这里盲猜一手激进的j选取会导致collision constraint很难满足。</p></li><li><p>控制作用（control effort）</p></li><li><p>输入变化（input variation）</p><p>用于最小化加速度的变化，从而生成平滑的输入轨迹<img src="/2023/03/26/lun-wen-ji-yu-dmpc-de-lu-jing-gui-hua/image-20220402234853411.png" alt="formula another"></p><p>其中u是输入，只能写到这了，后面是能力有限。</p></li><li><p>物理限制（Physical Limits）</p><p>就是前面<a href="#anchor">驱动约束：</a>提到的constraint</p></li><li><p>凸优化问题，无碰撞（Convex Optimization Problem）</p><p>把上面所有目标函数和约束结合起来可以看成一个3K决策变量和12K个不等式约束的二次规划问题。<img src="/2023/03/26/lun-wen-ji-yu-dmpc-de-lu-jing-gui-hua/image-20220402235846299.png" alt="凸优化问题"></p></li></ul><hr><h2 id="on-demand-collision-avoidance-with-soft-constraints">On-demand Collision Avoidance with Soft Constraints</h2>]]></content>
      
      
      <categories>
          
          <category> 论文 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 集群控制 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【网站搭建】hexo的使用</title>
      <link href="/2023/03/26/wang-zhan-da-jian-hexo-de-shi-yong/"/>
      <url>/2023/03/26/wang-zhan-da-jian-hexo-de-shi-yong/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>基本的hexo使用语句就不展示了</strong></p><blockquote><p>写在前面</p></blockquote><figure><img src="/2023/03/26/wang-zhan-da-jian-hexo-de-shi-yong/image-20220322170540331.png" alt="hexo版本"><figcaption aria-hidden="true">hexo版本</figcaption></figure><figure><img src="/2023/03/26/wang-zhan-da-jian-hexo-de-shi-yong/image-20220322170602418.png" alt="next版本"><figcaption aria-hidden="true">next版本</figcaption></figure><span id="more"></span><h2 id="图片插入">图片插入</h2><ul><li>没有办法，只能</li></ul><div class="sourceCode" id="cb1"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;img</span><span class="ot"> src=</span><span class="st">&quot;/images/filename\image.png&quot;</span><span class="ot"> width=</span><span class="st">50%</span><span class="ot"> height=</span><span class="st">10%</span><span class="ot">  align=</span><span class="st">center</span><span class="ot"> title=</span><span class="st">&quot;title&quot;</span><span class="kw">/&gt;</span></span></code></pre></div><p><img src="/images/hexo的使用方法\image-20220227222111299.png" width="50%" height="10%" align="center" title="图片"></p><ul><li><img src="/2023/03/26/wang-zhan-da-jian-hexo-de-shi-yong/image-20220321222111325.png" alt="image-20220321222111325" style="zoom:150%;"></li></ul><h2 id="添加背景图片">添加背景图片</h2><p><a href="https://blog.csdn.net/weixin_46106283/article/details/109880961">next主题添加背景</a></p><p>这个透明：<a href="http://nicethemes.cn/news/txtlist_i50768v.html">next主题美化——背景图片、页面透明化、阴影、圆角、动画 (nicethemes.cn)</a></p><h2 id="添加dark-mode">添加dark mode</h2><p><a href="https://www.techgrow.cn/posts/abf4aee1.html#Next-8-x-自动添加可切换的暗黑模式">Hexo Next 8.x 主题添加可切换的暗黑模式 | Clay 的技术博客 (techgrow.cn)</a></p><h2 id="首页显示头像">首页显示头像</h2><p>更改 Next 主题的配置文件 <code>themes/next/_config.yml</code>，设置以下内容</p><pre><code>avatar:  url: /images/avatar.png      # 头像图片  rounded: true                # 头像显示在圆里  rotated: true                # 鼠标焦点落在头像时，是否转动头像</code></pre><h2 id="字数与阅读时长统计插件">字数与阅读时长统计插件</h2><p>Next 主题默认支持使用 <a href="https://github.com/theme-next/hexo-symbols-count-time">hexo-symbols-count-time</a> 插件来统计文章字数和阅读时长，前提是需要手动安装对应的插件</p><pre><code># 进入博客的根目录$ cd $&#123;blog-root&#125;/# 安装依赖$ npm install eslint --save# 安装插件$ npm install hexo-symbols-count-time --save</code></pre><p>在博客的根目录里，找到 <code>_config.yml</code> 文件，然后添加如下的配置项</p><pre><code>symbols_count_time:  time: true                   # 文章阅读时长  symbols: true                # 文章字数统计  total_time: true             # 站点总阅读时长  total_symbols: true          # 站点总字数统计  exclude_codeblock: true      # 排除代码字数统计</code></pre><p>更改 Next 主题的配置文件 <code>themes/next/_config.yml</code>，设置以下内容</p><pre><code>symbols_count_time:  separated_meta: false         # 是否另起一行显示（即不和发表时间等同一行显示）  item_text_post: true          # 首页文章统计数量前是否显示文字描述（本文字数、阅读时长）  item_text_total: false        # 页面底部统计数量前是否显示文字描述（站点总字数、站点阅读时长）</code></pre><h2 id="字体">字体</h2><p><a href="https://sxxkearth.github.io/2019/01/09/Next字体修改/#修改主题字体">Next修改字体 | 嗜血星空earth (sxxkearth.github.io)</a></p><h2 id="接入谷歌搜索">接入谷歌搜索</h2><ol type="1"><li><p>点击<a href="https://search.google.com/search-console/welcome">欢迎使用 Google Search Console</a></p></li><li><p>将自己的域名输入第二个<img src="/2023/03/26/wang-zhan-da-jian-hexo-de-shi-yong/image-20220322110615456.png" alt="第二步"></p></li><li><p>进行html文件验证，把文件放在public文件夹下面，由于不知道是哪个public，所以我在两个public文件夹下面都放了html文件（如果知道了请联系我！！）<img src="/2023/03/26/wang-zhan-da-jian-hexo-de-shi-yong/image-20220322111033805.png" alt="放置html文件"><img src="/2023/03/26/wang-zhan-da-jian-hexo-de-shi-yong/image-20220322111059286.png" alt="image-20220322111059286"></p></li><li><p>输入</p><blockquote><p>hexo g</p><p>hexo d</p></blockquote><p>可能需要等待几秒。前往【资源页面】<a href="https://search.google.com/search-console/sitemaps?resource_id=https%3A%2F%2Fcopy2000.github.io%2F">站点地图 (google.com)</a></p><figure><img src="/2023/03/26/wang-zhan-da-jian-hexo-de-shi-yong/image-20220322111003344.png" alt="成功"><figcaption aria-hidden="true">成功</figcaption></figure></li><li><figure><img src="/2023/03/26/wang-zhan-da-jian-hexo-de-shi-yong/image-20220322111715870.png" alt="image-20220322111715870"><figcaption aria-hidden="true">image-20220322111715870</figcaption></figure><figure><img src="/2023/03/26/wang-zhan-da-jian-hexo-de-shi-yong/image-20220322142945043.png" alt="image-20220322142945043"><figcaption aria-hidden="true">image-20220322142945043</figcaption></figure></li></ol><h2 id="添加评论">添加评论</h2><figure><img src="/2023/03/26/wang-zhan-da-jian-hexo-de-shi-yong/u=1571079431,2439839356&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG.jpeg" alt="很蓝的啦"><figcaption aria-hidden="true">很蓝的啦</figcaption></figure><center><p style="color:red;">很难的啦</p></center><p>使用畅言就是无脑操作，但是居然有广告内嵌，<img src="/2023/03/26/wang-zhan-da-jian-hexo-de-shi-yong/image-20220322155150499.png" alt="广告内嵌"></p><p>所以我建议不要使用，强烈建议。毕竟是无产阶级，无产阶级有无产阶级的方法 。</p><p>无产阶级的做法是使用gitalk，相关资料网上一搜一大把，适合我的版本是<a href="https://www.jianshu.com/p/02fc71f3633f">Hexo 集成 Gitalk 评论系统 - 简书 (jianshu.com)</a>。</p><h2 id="文字编辑">文字编辑</h2><p>markdown的文字略显枯燥，所以一般使用html格式写网页会美观很多，下面是常用的使用方法。<img src="/2023/03/26/wang-zhan-da-jian-hexo-de-shi-yong/image-20220322172525946.png" alt="style"></p><p>改变大小使用<code>&lt;p style="font-size:20px"&gt;STYLE&lt;/p&gt;</code></p><h2 id="git-文件过大">git 文件过大</h2><p><a href="https://blog.csdn.net/zy440458/article/details/114336712">(70条消息) 清理git commit中的大文件_蒟蒻颖的博客-CSDN博客</a></p><p>直接删除.deloygit</p><h2 id="站内链接">站内链接</h2><figure><img src="/2023/03/26/wang-zhan-da-jian-hexo-de-shi-yong/image-20220402235536964.png" alt="image-20220402235536964"><figcaption aria-hidden="true">image-20220402235536964</figcaption></figure><h2 id="关于端口22">关于端口22</h2><p>端口22经常被closed。</p><figure><img src="/2023/03/26/wang-zhan-da-jian-hexo-de-shi-yong/image-20221204235234172.png" alt="image-20221204235234172"><figcaption aria-hidden="true">image-20221204235234172</figcaption></figure><p>解决方法：</p><ul><li><p>关闭代理，可能是vpn的问题；</p></li><li><p>使用<code>netstat -an</code>查看22是否被监听，好像是127.0.0.1:22；如果没有被监听：</p><figure><img src="/2023/03/26/wang-zhan-da-jian-hexo-de-shi-yong/image-20221204235405938.png" alt="image-20221204235405938"><figcaption aria-hidden="true">image-20221204235405938</figcaption></figure></li></ul><p>输入<code>services.msc</code>，查看<img src="/2023/03/26/wang-zhan-da-jian-hexo-de-shi-yong/image-20221204235441450.png" alt="image-20221204235441450"></p><ul><li><p>等一会儿；</p></li><li><p>还有一个点就是ssh key的时候后面需要加自己的邮箱。</p></li><li><p>另一个方法就是在.ssh/文件夹下面添加config文件，然后添加一下内容。</p><blockquote><blockquote><p>Host github.com Hostname ssh.github.com Port 443 User git</p></blockquote></blockquote></li></ul>]]></content>
      
      
      <categories>
          
          <category> 网站搭建 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>【无人机】HKUST课件学习</title>
      <link href="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/"/>
      <url>/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="uav-learning">UAV Learning</h1><p>本篇只是一个目录性质的东西，相关东西自己去看课件</p><figure><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/u=1620021440,3565980159&amp;fm=253&amp;fmt=auto&amp;app=120&amp;f=JPEG.jpeg" alt="无人机"><figcaption aria-hidden="true">无人机</figcaption></figure><span id="more"></span><h2 id="rotation-representation">Rotation Representation</h2><ul><li>rotation matrices</li><li>Euler angles：任何旋转都可以被描述为三个绕着xyz轴线性旋转</li><li>Exponential coordinates</li><li>Quaternions</li></ul><p>由于课件上的东西实在是不好整理，于是只挑了些重要的和相关的project记录。<a href="https://gaowenliang.github.io/HKUST-ELEC5660-Introduction-to-Aerial-Robots/project/project.html">ELEC5660 (gaowenliang.github.io)</a></p><h2 id="project1">Project1</h2><h3 id="phase-1-control-simulation">Phase 1 : Control Simulation</h3><p>question：In this project, you are provided with a quadrotor simulator written in Matlab. The simulator implements dynamics model of quadrotor and relies on the numerical solver ode45. You will need to implement controller.</p><p><a href="https://github.com/gaowenliang/ELEC5660_proj1phase1">code and data</a></p><ul><li>下面是直接运行code（未添加控制）的相关结果：</li></ul><p>​ <img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220323144051461.png" alt="未改变参数的circle"></p><p>​ <img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220323144304484.png" alt="未改变参数的diamond"></p><p>​ <img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220323144444287.png" alt="未改变参数的hover"></p><p>​ 可以看到的是未添加控制情况下，红线和蓝线偏离较大，不能保持跟踪。</p><ul><li><p>运用的知识：</p><figure><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220323145546665.png" alt="3D Quadrotor"><figcaption aria-hidden="true">3D Quadrotor</figcaption></figure><figure><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220323145012987.png" alt="3D Quadrotor"><figcaption aria-hidden="true">3D Quadrotor</figcaption></figure><figure><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220323145039479.png" alt="3D PID"><figcaption aria-hidden="true">3D PID</figcaption></figure></li><li><p>control.m</p><div class="sourceCode" id="cb1"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> [<span class="va">F</span><span class="op">,</span> <span class="va">M</span>] <span class="op">=</span> <span class="va">controller</span>(<span class="va">t</span><span class="op">,</span> <span class="va">s</span><span class="op">,</span> <span class="va">s_des</span>)</span><span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">%% s_des = zeros(13,1);</span></span><span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">% [1:6]: x, y, z, dx, dy, dz</span></span><span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">% [7:10]: quaternion, qw,qx,qy,qz</span></span><span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">% [11:13]: oemga: wx, wy, wz</span></span><span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">%% definition of parameters</span></span><span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">% model parameters</span></span><span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="kw">global</span> <span class="va">params</span></span><span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="va">m</span> <span class="op">=</span> <span class="va">params</span>.<span class="va">mass</span><span class="op">;</span></span><span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="va">g</span> <span class="op">=</span> <span class="va">params</span>.<span class="va">grav</span><span class="op">;</span></span><span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="va">I</span> <span class="op">=</span> <span class="va">params</span>.<span class="va">I</span><span class="op">;</span></span><span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span><span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">%PID parameters</span></span><span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="va">Kp_position</span> <span class="op">=</span> [<span class="fl">4</span> <span class="fl">4</span> <span class="fl">5</span>]<span class="op">;</span></span><span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="va">Kd_position</span> <span class="op">=</span> [<span class="fl">2.5</span> <span class="fl">2.5</span> <span class="fl">5</span>]<span class="op">;</span></span><span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="va">Kp_rpy</span> <span class="op">=</span> [<span class="fl">100</span> <span class="fl">100</span> <span class="fl">75</span>]<span class="op">;</span></span><span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="va">Kd_rpy</span> <span class="op">=</span> [<span class="fl">15</span> <span class="fl">15</span> <span class="fl">10</span>]<span class="op">;</span></span><span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span><span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">%% position control</span></span><span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="va">Rotation</span> <span class="op">=</span> <span class="va">quaternion_to_R</span>(<span class="va">s</span>(<span class="fl">7</span><span class="op">:</span><span class="fl">10</span>))<span class="op">;</span><span class="co">%function is in utils</span></span><span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="va">Rotation_desired</span> <span class="op">=</span> <span class="va">quaternion_to_R</span>(<span class="va">s_des</span>(<span class="fl">7</span><span class="op">:</span><span class="fl">10</span>))<span class="op">;</span></span><span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>[<span class="va">phi</span><span class="op">,</span><span class="va">theta</span><span class="op">,</span><span class="va">psi</span>] <span class="op">=</span> <span class="va">RotToRPY_ZXY</span>(<span class="va">Rotation</span>)<span class="op">;</span></span><span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>[<span class="va">phi_des</span><span class="op">,</span><span class="va">theta_des</span><span class="op">,</span><span class="va">psi_des</span>] <span class="op">=</span> <span class="va">RotToRPY_ZXY</span>(<span class="va">Rotation_desired</span>)<span class="op">;</span></span><span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span><span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co">%% newton equation</span></span><span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co">% linearization : u1,0 = mg,therefore ddz_des = 0</span></span><span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="va">ddp_des</span> <span class="op">=</span> [<span class="va">g</span><span class="op">*</span>(<span class="va">theta_des</span> <span class="op">*</span> <span class="va">cos</span>(<span class="va">psi_des</span>)<span class="op">+</span><span class="va">phi_des</span><span class="op">*</span><span class="va">sin</span>(<span class="va">psi_des</span>))<span class="op">,</span><span class="va">g</span><span class="op">*</span>(<span class="va">theta_des</span> <span class="op">*</span> <span class="va">sin</span>(<span class="va">psi_des</span>)<span class="op">-</span><span class="va">phi_des</span><span class="op">*</span><span class="va">cos</span>(<span class="va">psi_des</span>))<span class="op">,</span><span class="fl">0</span>]<span class="op">;</span></span><span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span><span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="va">w_des</span> <span class="op">=</span> <span class="va">s_des</span>(<span class="fl">11</span><span class="op">:</span><span class="fl">13</span>)<span class="op">;</span></span><span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="va">w</span> <span class="op">=</span> <span class="va">s</span>(<span class="fl">11</span><span class="op">:</span><span class="fl">13</span>)<span class="op">;</span></span><span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span><span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co">%% PID control</span></span><span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="va">ddp_1c</span> <span class="op">=</span> <span class="va">ddp_des</span>(<span class="fl">1</span>) <span class="op">+</span> <span class="va">Kd_position</span>(<span class="fl">1</span>)<span class="op">*</span>(<span class="va">s_des</span>(<span class="fl">4</span>)<span class="op">-</span><span class="va">s</span>(<span class="fl">4</span>)) <span class="op">+</span> <span class="va">Kp_position</span>(<span class="fl">1</span>)<span class="op">*</span>(<span class="va">s_des</span>(<span class="fl">1</span>)<span class="op">-</span><span class="va">s</span>(<span class="fl">1</span>))<span class="op">;</span></span><span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="va">ddp_2c</span> <span class="op">=</span> <span class="va">ddp_des</span>(<span class="fl">2</span>) <span class="op">+</span> <span class="va">Kd_position</span>(<span class="fl">2</span>)<span class="op">*</span>(<span class="va">s_des</span>(<span class="fl">5</span>)<span class="op">-</span><span class="va">s</span>(<span class="fl">5</span>)) <span class="op">+</span> <span class="va">Kp_position</span>(<span class="fl">2</span>)<span class="op">*</span>(<span class="va">s_des</span>(<span class="fl">2</span>)<span class="op">-</span><span class="va">s</span>(<span class="fl">2</span>))<span class="op">;</span></span><span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="va">ddp_3c</span> <span class="op">=</span> <span class="va">ddp_des</span>(<span class="fl">3</span>) <span class="op">+</span> <span class="va">Kd_position</span>(<span class="fl">3</span>)<span class="op">*</span>(<span class="va">s_des</span>(<span class="fl">6</span>)<span class="op">-</span><span class="va">s</span>(<span class="fl">6</span>)) <span class="op">+</span> <span class="va">Kp_position</span>(<span class="fl">3</span>)<span class="op">*</span>(<span class="va">s_des</span>(<span class="fl">3</span>)<span class="op">-</span><span class="va">s</span>(<span class="fl">3</span>))<span class="op">;</span></span><span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span><span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="va">F</span> <span class="op">=</span> <span class="va">m</span><span class="op">*</span>(<span class="va">g</span><span class="op">+</span><span class="va">ddp_3c</span>)<span class="op">;</span></span><span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="va">phi_c</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">g</span><span class="op">*</span>(<span class="va">ddp_1c</span><span class="op">*</span><span class="va">sin</span>(<span class="va">psi</span>) <span class="op">-</span> <span class="va">ddp_2c</span><span class="op">*</span><span class="va">cos</span>(<span class="va">psi</span>))<span class="op">;</span></span><span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="va">theta_c</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">g</span><span class="op">*</span>(<span class="va">ddp_1c</span><span class="op">*</span><span class="va">cos</span>(<span class="va">psi</span>) <span class="op">+</span> <span class="va">ddp_2c</span><span class="op">*</span><span class="va">sin</span>(<span class="va">psi</span>))<span class="op">;</span></span><span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span><span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="co">%% Attitude control</span></span><span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co">% judge the angle of yaw</span></span><span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="va">psi_dif</span> <span class="op">=</span> <span class="va">psi_des</span><span class="op">-</span><span class="va">psi</span><span class="op">;</span></span><span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="va">psi_dif</span> <span class="op">&gt;=</span> <span class="va">pi</span></span><span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    <span class="va">psi_dif</span><span class="op">=</span><span class="va">psi_dif</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">;</span></span><span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="kw">elseif</span> <span class="va">psi_dif</span> <span class="op">&lt;=</span> <span class="op">-</span><span class="va">pi</span></span><span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    <span class="va">psi_dif</span><span class="op">=</span><span class="va">psi_dif</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">;</span></span><span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span><span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span><span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="va">dd_rpy_c</span> <span class="op">=</span> [<span class="va">Kp_rpy</span>(<span class="fl">1</span>)<span class="op">*</span>(<span class="va">phi_c</span><span class="op">-</span><span class="va">phi</span>)<span class="op">+</span><span class="va">Kd_rpy</span>(<span class="fl">1</span>)<span class="op">*</span>(<span class="fl">0</span><span class="op">-</span><span class="va">w</span>(<span class="fl">1</span>))<span class="op">;</span></span><span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>                 <span class="va">Kp_rpy</span>(<span class="fl">2</span>)<span class="op">*</span>(<span class="va">theta_c</span><span class="op">-</span><span class="va">theta</span>)<span class="op">+</span><span class="va">Kd_rpy</span>(<span class="fl">2</span>)<span class="op">*</span>(<span class="fl">0</span><span class="op">-</span><span class="va">w</span>(<span class="fl">2</span>))<span class="op">;</span></span><span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>                 <span class="va">Kp_rpy</span>(<span class="fl">3</span>)<span class="op">*</span>(<span class="va">psi_dif</span>)<span class="op">+</span><span class="va">Kd_rpy</span>(<span class="fl">3</span>)<span class="op">*</span>(<span class="fl">0</span><span class="op">-</span><span class="va">w</span>(<span class="fl">3</span>))]<span class="op">;</span> <span class="co">%notsure abt derivative</span></span><span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="va">M</span> <span class="op">=</span> <span class="va">I</span><span class="op">*</span><span class="va">dd_rpy_c</span> <span class="op">+</span> <span class="va">cross</span>(<span class="va">w</span><span class="op">,</span> <span class="va">I</span><span class="op">*</span><span class="va">w</span>)<span class="op">;</span></span><span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div></li><li><p>使用Ziegler-Nichols方法调参（我不认为这是一个聪明的做法）<img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220323155847233.png" alt="oscillate"><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220323162554971.png" alt="circle_trajectory"><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220323162802516.png" alt="diamond_trajectory"><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220323162943627.png" alt="hover_trajectory"></p></li></ul><h3 id="phase-2-trajectory-simulation">Phase 2 : Trajectory Simulation</h3><p><a href="https://github.com/gaowenliang/ELEC5660_proj1phase2">问题和code and data</a></p><ul><li><p>运用的知识</p><p><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220327111127832.png" alt="image-20220327111127832"><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220327111142080.png" alt="image-20220327111142080"><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220327111155381.png" alt="Minimum Snap"><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220327111209720.png" alt="cost function"><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220327111218007.png" alt="image-20220327111218007"><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220327111244447.png" alt="image-20220327111244447"></p><p>这个ppt 上面讲的就比较抽象，我的建议是<a href="https://www.bilibili.com/video/BV1yT4y1T7Eb?p=10">机器人路径规划、轨迹优化系列课程_哔哩哔哩_bilibili</a>，讲的比较具体形象。<a href="https://blog.csdn.net/q597967420/article/details/76099491">博客</a></p></li></ul><hr><pre><code>path1 = [0.0 0.0 1.0 ; ...         1.0 1.0 1.0 ; ...         -1.0 2.0 1.0 ; ...         1.0 3.0 1.0 ; ...         -1.0 4.0 1.0 ; ...         1.0 5.0 1.0 ; ...         -1.0 6.0 1.0 ; ...         1.0 7.0 1.0 ; ...         -1.0 8.0 1.0 ; ...         1.0 9.0 1.0 ; ...         0.0 10.0 1.0 ; ];</code></pre><figure><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220327192302119.png" alt="path"><figcaption aria-hidden="true">path</figcaption></figure><ul><li>代码部分function s_des = trajectory_generator(t, path, h)</li></ul><blockquote><p>1 定义变量</p><div class="sourceCode" id="cb3"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">%persistent变量与全局变量有相似之处，它们都创建永久的存储空间，不同在于persistent只对定义它的函数可见。这样可以防止persistent变量被其它函数或在命令行中被改变。</span></span><span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">persistent</span> <span class="va">ts</span><span class="op">;</span></span><span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">persistent</span> <span class="va">ts_delta</span><span class="op">;</span></span><span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">persistent</span> <span class="va">P</span><span class="op">;</span></span><span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="kw">persistent</span> <span class="va">xyz</span><span class="op">;</span></span></code></pre></div><hr><p>2 每一段轨迹的时间分配,总共分配25秒完成轨迹运行，path_seg_length就是两个waypoints之间的欧式距离，cumsum_path是累加路径，cumsum_path(end)就是一共需要走的路程，ts_delta就是两个waypoints的时间间隔。</p><div class="sourceCode" id="cb4"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="va">total_time</span> <span class="op">=</span> <span class="fl">25.0</span><span class="op">;</span></span><span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="va">path_seg_length</span> <span class="op">=</span> <span class="va">sqrt</span>(<span class="va">sum</span>((<span class="va">path</span>(<span class="fl">2</span><span class="op">:</span><span class="kw">end</span><span class="op">,</span> <span class="op">:</span>) <span class="op">-</span> <span class="va">path</span>(<span class="fl">1</span><span class="op">:</span><span class="kw">end</span><span class="op">-</span><span class="fl">1</span><span class="op">,:</span>))<span class="op">.^</span><span class="fl">2</span><span class="op">,</span><span class="fl">2</span>))<span class="op">;</span>  <span class="co">%每一段的长度</span></span><span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="va">cumsum_path</span> <span class="op">=</span> <span class="va">cumsum</span>(<span class="va">path_seg_length</span>)<span class="op">;</span></span><span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="va">ts_proportion</span> <span class="op">=</span> <span class="va">cumsum_path</span><span class="op">/</span><span class="va">cumsum_path</span>(<span class="kw">end</span>)<span class="op">;</span></span><span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="va">ts</span> <span class="op">=</span> [<span class="fl">0</span><span class="op">;</span> <span class="va">ts_proportion</span>]<span class="op">&#39;;</span></span><span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="va">ts</span> <span class="op">=</span> <span class="va">ts</span><span class="op">*</span><span class="va">total_time</span><span class="op">;</span></span><span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="va">ts_delta</span> <span class="op">=</span> <span class="va">ts</span>(<span class="fl">2</span><span class="op">:</span><span class="kw">end</span>) <span class="op">-</span> <span class="va">ts</span>(<span class="fl">1</span><span class="op">:</span><span class="kw">end</span><span class="op">-</span><span class="fl">1</span>)<span class="op">;</span> <span class="co">% interval----&gt;T</span></span></code></pre></div><figure><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220327192504059.png" alt="path-seg-length"><figcaption aria-hidden="true">path-seg-length</figcaption></figure><figure><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220327192537568.png" alt="△t"><figcaption aria-hidden="true">△t</figcaption></figure><hr><p>3 m就是轨迹段数，如果有11个waypoints，那么就有10段，这里使用的是Minimum Snap Trajectory Generation，所以N=7，但是有8个自由度（多项式的阶数为7，但是会有8个系数），所以Q_dia就是8*m的方阵。至于Q_dia matrix 的计算，参照上面fig[cost function]。</p><div class="sourceCode" id="cb5"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">%% cost function </span></span><span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="va">m</span> <span class="op">=</span> <span class="va">length</span>(<span class="va">path</span>)<span class="op">-</span><span class="fl">1</span><span class="op">;</span> <span class="co">%# segments </span></span><span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">%为什么是8*m，是因为minimum snap为7阶，但是有8个自由度，所以一共有8*m，可以发现Q是一个对称矩阵</span></span><span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="va">Q_dia</span> <span class="op">=</span> <span class="va">zeros</span>(<span class="fl">8</span><span class="op">*</span><span class="va">m</span><span class="op">,</span> <span class="fl">8</span><span class="op">*</span><span class="va">m</span>)<span class="op">;</span> <span class="co">%block diagonal matrix</span></span><span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">k</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">m</span></span><span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a> <span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">4</span><span class="op">:</span><span class="fl">8</span></span><span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>     <span class="kw">for</span> <span class="va">j</span><span class="op">=</span><span class="fl">4</span><span class="op">:</span><span class="fl">8</span></span><span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>         <span class="va">Q_dia</span>((<span class="va">k</span><span class="op">-</span><span class="fl">1</span>)<span class="op">*</span><span class="fl">8</span><span class="op">+</span><span class="va">i</span><span class="op">,</span>(<span class="va">k</span><span class="op">-</span><span class="fl">1</span>)<span class="op">*</span><span class="fl">8</span><span class="op">+</span><span class="va">j</span>)<span class="op">=</span><span class="va">i</span><span class="op">*</span>(<span class="va">i</span><span class="op">-</span><span class="fl">1</span>)<span class="op">*</span>(<span class="va">i</span><span class="op">-</span><span class="fl">2</span>)<span class="op">*</span>(<span class="va">i</span><span class="op">-</span><span class="fl">3</span>)<span class="op">*</span><span class="va">j</span><span class="op">*</span>(<span class="va">j</span><span class="op">-</span><span class="fl">1</span>)<span class="op">*</span>(<span class="va">j</span><span class="op">-</span><span class="fl">2</span>)<span class="op">*</span>(<span class="va">j</span><span class="op">-</span><span class="fl">3</span>)<span class="op">/</span>(<span class="va">j</span><span class="op">+</span><span class="va">i</span><span class="op">-</span><span class="fl">7</span>)<span class="op">*</span>(<span class="va">ts_delta</span>(<span class="va">k</span>)<span class="op">^</span>(<span class="va">i</span><span class="op">+</span><span class="va">j</span><span class="op">-</span><span class="fl">7</span>))<span class="op">;</span></span><span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>     <span class="kw">end</span></span><span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a> <span class="kw">end</span></span><span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div><p><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220327192738388.png" alt="Q">每一组的后4*4改变，而且是一个对称矩阵</p><hr><p>4 约束<span class="math inline">\(A_j p_j = d_j\)</span>，dim指的是A的维度</p><div class="sourceCode" id="cb6"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">%% derivative constraint</span></span><span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">% 为什么是4*（m-1）？4分别是pos vel acc jerk ，m-1是除了第一个点和最后一个点，中间有m-1个点</span></span><span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">% 2*m是每一段t=0和t=T的时候的连续型约束</span></span><span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="va">dim</span> <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="va">m</span><span class="op">+</span><span class="fl">4</span><span class="op">*</span>(<span class="va">m</span><span class="op">-</span><span class="fl">1</span>)<span class="op">+</span> <span class="fl">3</span><span class="op">*</span><span class="fl">2</span><span class="op">;</span> <span class="co">%continutity[4]+starting[3]+ending[3]</span></span><span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="va">P</span> <span class="op">=</span> <span class="va">zeros</span>(<span class="fl">8</span><span class="op">*</span><span class="va">m</span><span class="op">,</span><span class="fl">3</span>)<span class="op">;</span> <span class="co">%p_j_i = 8mx3 [p00, p01...;p10...]</span></span><span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="va">A</span> <span class="op">=</span> <span class="va">zeros</span>(<span class="va">dim</span><span class="op">,</span><span class="fl">8</span><span class="op">*</span><span class="va">m</span>)<span class="op">;</span> <span class="co">%dimx8m</span></span><span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="va">d</span><span class="op">=</span> <span class="va">zeros</span>(<span class="va">dim</span><span class="op">,</span><span class="fl">3</span>)<span class="op">;</span></span><span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="va">d</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">*</span><span class="va">m</span><span class="op">,:</span>) <span class="op">=</span>  <span class="va">reshape</span>([<span class="va">path</span>(<span class="fl">1</span><span class="op">:</span><span class="kw">end</span><span class="op">-</span><span class="fl">1</span><span class="op">,</span> <span class="op">:</span>) <span class="va">path</span>(<span class="fl">2</span><span class="op">:</span><span class="kw">end</span><span class="op">,</span> <span class="op">:</span>)]<span class="op">&#39;,</span><span class="fl">3</span><span class="op">,</span> [])<span class="op">&#39;;</span></span><span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">%dimx3</span></span><span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">%每一段的开始和结束都需要在位置上</span></span><span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">j</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">m</span> <span class="co">%position</span></span><span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a> <span class="va">A</span>(<span class="fl">2</span><span class="op">*</span><span class="va">j</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">*</span><span class="va">j</span><span class="op">,</span><span class="fl">8</span><span class="op">*</span><span class="va">j</span><span class="op">-</span><span class="fl">7</span><span class="op">:</span><span class="fl">8</span><span class="op">*</span><span class="va">j</span>) <span class="op">=</span> [ <span class="fl">1</span><span class="op">,</span> <span class="fl">0</span><span class="op">,</span> <span class="fl">0</span><span class="op">,</span> <span class="fl">0</span><span class="op">,</span> <span class="fl">0</span><span class="op">,</span> <span class="fl">0</span><span class="op">,</span> <span class="fl">0</span><span class="op">,</span> <span class="fl">0</span><span class="op">;...</span></span><span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>     <span class="fl">1</span><span class="op">,</span> <span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">,</span> <span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">2</span><span class="op">,</span> <span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">3</span><span class="op">,</span> <span class="op">...</span></span><span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>     <span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">4</span><span class="op">,</span> <span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">5</span><span class="op">,</span> <span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">6</span><span class="op">,</span> <span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">7</span>]<span class="op">;</span></span><span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div><p>5 连续型约束</p><div class="sourceCode" id="cb7"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">%% continutity pos,vel,acce,jerk</span></span><span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">j</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span>(<span class="va">m</span><span class="op">-</span><span class="fl">1</span>)</span><span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a> <span class="va">A</span>((<span class="fl">2</span><span class="op">*</span><span class="va">m</span><span class="op">+</span><span class="fl">4</span><span class="op">*</span><span class="va">j</span><span class="op">-</span><span class="fl">3</span>)<span class="op">:</span>(<span class="fl">2</span><span class="op">*</span><span class="va">m</span><span class="op">+</span><span class="fl">4</span><span class="op">*</span><span class="va">j</span>)<span class="op">,</span>(<span class="fl">8</span><span class="op">*</span><span class="va">j</span><span class="op">-</span><span class="fl">7</span>)<span class="op">:</span>(<span class="fl">8</span><span class="op">*</span><span class="va">j</span><span class="op">+</span><span class="fl">8</span>))<span class="op">=</span>[<span class="fl">1</span><span class="op">,</span> <span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">,</span> <span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">2</span><span class="op">,</span> <span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">3</span><span class="op">,</span> <span class="op">...</span></span><span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>     <span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">4</span><span class="op">,</span> <span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">5</span><span class="op">,</span> <span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">6</span><span class="op">,</span> <span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">7</span><span class="op">,-</span><span class="fl">1</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">;...</span><span class="co">%pos</span></span><span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span> <span class="fl">2</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">,</span> <span class="fl">3</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">2</span><span class="op">,</span> <span class="fl">4</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">3</span><span class="op">,</span> <span class="fl">5</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">4</span><span class="op">,</span> <span class="op">...</span></span><span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>     <span class="fl">6</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">5</span><span class="op">,</span> <span class="fl">7</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">6</span><span class="op">,</span><span class="fl">0</span><span class="op">,-</span><span class="fl">1</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">;...</span><span class="co">%vel</span></span><span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0</span><span class="op">,</span> <span class="fl">0</span><span class="op">,</span> <span class="fl">2</span><span class="op">,</span> <span class="fl">6</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">,</span> <span class="fl">12</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">2</span><span class="op">,</span> <span class="fl">20</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">3</span><span class="op">,</span> <span class="op">...</span></span><span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>     <span class="fl">30</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">4</span><span class="op">,</span> <span class="fl">42</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">5</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,-</span><span class="fl">2</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">;...</span><span class="co">%acc</span></span><span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>      <span class="fl">0</span><span class="op">,</span> <span class="fl">0</span><span class="op">,</span> <span class="fl">0</span><span class="op">,</span> <span class="fl">6</span><span class="op">,</span> <span class="fl">24</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">,</span> <span class="fl">60</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">2</span><span class="op">,</span> <span class="op">...</span></span><span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>     <span class="fl">120</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">3</span><span class="op">,</span> <span class="fl">210</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">j</span>)<span class="op">^</span><span class="fl">4</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,-</span><span class="fl">6</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span>]<span class="op">;</span><span class="co">%jerk</span></span><span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div><p>6</p><div class="sourceCode" id="cb8"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">%% starting point vel,acc, jerk </span></span><span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="va">A</span>(<span class="fl">6</span><span class="op">*</span><span class="va">m</span><span class="op">-</span><span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">*</span><span class="va">m</span><span class="op">-</span><span class="fl">1</span><span class="op">,</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>)<span class="op">=</span>[<span class="fl">0</span><span class="op">,</span><span class="fl">1</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">;...</span></span><span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">;...</span></span><span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">6</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span>]<span class="op">;</span></span><span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="va">A</span>(<span class="fl">6</span><span class="op">*</span><span class="va">m</span><span class="op">:</span><span class="fl">6</span><span class="op">*</span><span class="va">m</span><span class="op">+</span><span class="fl">2</span><span class="op">,</span><span class="fl">8</span><span class="op">*</span><span class="va">m</span><span class="op">-</span><span class="fl">7</span><span class="op">:</span><span class="fl">8</span><span class="op">*</span><span class="va">m</span>) <span class="op">=</span> [<span class="fl">0</span><span class="op">,</span> <span class="fl">1</span><span class="op">,</span> <span class="fl">2</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">m</span>)<span class="op">,</span> <span class="fl">3</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">m</span>)<span class="op">^</span><span class="fl">2</span><span class="op">,</span> <span class="fl">4</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">m</span>)<span class="op">^</span><span class="fl">3</span><span class="op">,</span> <span class="fl">5</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">m</span>)<span class="op">^</span><span class="fl">4</span><span class="op">,</span> <span class="op">...</span></span><span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">6</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">m</span>)<span class="op">^</span><span class="fl">5</span><span class="op">,</span> <span class="fl">7</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">m</span>)<span class="op">^</span><span class="fl">6</span><span class="op">;</span> <span class="op">...</span></span><span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">0</span><span class="op">,</span> <span class="fl">0</span><span class="op">,</span> <span class="fl">2</span><span class="op">,</span> <span class="fl">6</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">m</span>)<span class="op">,</span> <span class="fl">12</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">m</span>)<span class="op">^</span><span class="fl">2</span><span class="op">,</span> <span class="fl">20</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">m</span>)<span class="op">^</span><span class="fl">3</span><span class="op">,</span> <span class="op">...</span></span><span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">30</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">m</span>)<span class="op">^</span><span class="fl">4</span><span class="op">,</span> <span class="fl">42</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">m</span>)<span class="op">^</span><span class="fl">5</span><span class="op">;</span> <span class="op">...</span></span><span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">0</span><span class="op">,</span> <span class="fl">0</span><span class="op">,</span> <span class="fl">0</span><span class="op">,</span> <span class="fl">6</span><span class="op">,</span> <span class="fl">24</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">m</span>)<span class="op">,</span> <span class="fl">60</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">m</span>)<span class="op">^</span><span class="fl">2</span><span class="op">,</span> <span class="op">...</span></span><span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">120</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">m</span>)<span class="op">^</span><span class="fl">3</span><span class="op">,</span> <span class="fl">210</span><span class="op">*</span><span class="va">ts_delta</span>(<span class="va">m</span>)<span class="op">^</span><span class="fl">4</span>]<span class="op">;</span></span></code></pre></div><p>7 QP求解</p><div class="sourceCode" id="cb9"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">%% QP</span></span><span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="va">f</span><span class="op">=</span><span class="va">zeros</span>(<span class="fl">8</span><span class="op">*</span><span class="va">m</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span></span><span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="va">P</span>(<span class="op">:,</span><span class="fl">1</span>) <span class="op">=</span> <span class="va">quadprog</span>(<span class="va">Q_dia</span><span class="op">,</span><span class="va">f</span><span class="op">,</span>[]<span class="op">,</span>[]<span class="op">,</span><span class="va">A</span><span class="op">,</span><span class="va">d</span>(<span class="op">:,</span><span class="fl">1</span>))<span class="op">;</span></span><span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="va">P</span>(<span class="op">:,</span><span class="fl">2</span>) <span class="op">=</span> <span class="va">quadprog</span>(<span class="va">Q_dia</span><span class="op">,</span><span class="va">f</span><span class="op">,</span>[]<span class="op">,</span>[]<span class="op">,</span><span class="va">A</span><span class="op">,</span><span class="va">d</span>(<span class="op">:,</span><span class="fl">2</span>))<span class="op">;</span></span><span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="va">P</span>(<span class="op">:,</span><span class="fl">3</span>) <span class="op">=</span> <span class="va">quadprog</span>(<span class="va">Q_dia</span><span class="op">,</span><span class="va">f</span><span class="op">,</span>[]<span class="op">,</span>[]<span class="op">,</span><span class="va">A</span><span class="op">,</span><span class="va">d</span>(<span class="op">:,</span><span class="fl">3</span>))<span class="op">;</span></span></code></pre></div></blockquote><hr><ul><li><p><strong>结果展示</strong></p><p>path1</p><figure><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220327193103099.png" alt="path1"><figcaption aria-hidden="true">path1</figcaption></figure></li></ul><hr><p>​ path2</p><p><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220327193400537.png" alt="path2"><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220327193553122.png" alt="path2-simulation"></p><hr><p>来一颗小心心！o(´^｀)o<img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220327193650235.png" alt="path3"></p><figure><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220327193837086.png" alt="heart-simulation"><figcaption aria-hidden="true">heart-simulation</figcaption></figure><h3 id="phase-3-path-finding-simulation">Phase 3 : Path Finding Simulation</h3><p><a href="https://github.com/gaowenliang/ELEC5660_proj1phase3">代码和问题</a></p><ul><li>A*算法</li></ul><figure><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220330124201573.png" alt="A*"><figcaption aria-hidden="true">A*</figcaption></figure><ul><li>关于搜索路径，我写了一篇<a href="https://copy2000.github.io/Dcos/搜索路径.pdf">总结</a>.</li></ul><p>代码思路，其实比较简单，就是g(n)+h(n)，h（n）就是使用MAP中的每一个节点到goal 的距离，至于g（n）是accumulated cost，只与之前的有关。</p><ul><li><p>代码path_from_Astar.m</p><p>初始化MAP</p><div class="sourceCode" id="cb10"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="va">Optimal_path</span> <span class="op">=</span> <span class="va">path_from_A_star</span>(<span class="va">map</span>)</span><span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="va">Optimal_path</span> <span class="op">=</span> []<span class="op">;</span></span><span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="va">size_map</span> <span class="op">=</span> <span class="va">size</span>(<span class="va">map</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span></span><span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span><span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">MAX_X</span><span class="op">=</span><span class="fl">10</span><span class="op">;</span></span><span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">MAX_Y</span><span class="op">=</span><span class="fl">10</span><span class="op">;</span></span><span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span><span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">%Define the 2D grid map array.</span></span><span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">%Obstacle=-1, Target = 0, Start=1</span></span><span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="va">MAP</span><span class="op">=</span><span class="fl">2</span><span class="op">*</span>(<span class="va">ones</span>(<span class="va">MAX_X</span><span class="op">,</span><span class="va">MAX_Y</span>))<span class="op">;</span></span><span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span><span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">%Initialize MAP with location of the target</span></span><span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="va">xval</span><span class="op">=</span><span class="va">floor</span>(<span class="va">map</span>(<span class="va">size_map</span><span class="op">,</span> <span class="fl">1</span>))<span class="op">;</span></span><span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="va">yval</span><span class="op">=</span><span class="va">floor</span>(<span class="va">map</span>(<span class="va">size_map</span><span class="op">,</span> <span class="fl">2</span>))<span class="op">;</span></span><span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="va">xTarget</span><span class="op">=</span><span class="va">xval</span><span class="op">;</span></span><span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="va">yTarget</span><span class="op">=</span><span class="va">yval</span><span class="op">;</span></span><span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="va">MAP</span>(<span class="va">xval</span><span class="op">,</span><span class="va">yval</span>)<span class="op">=</span><span class="fl">0</span><span class="op">;</span></span><span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span><span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">%Initialize MAP with location of the obstacle</span></span><span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">for</span> <span class="va">i</span> <span class="op">=</span> <span class="fl">2</span><span class="op">:</span> <span class="va">size_map</span><span class="op">-</span><span class="fl">1</span></span><span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">xval</span><span class="op">=</span><span class="va">floor</span>(<span class="va">map</span>(<span class="va">i</span><span class="op">,</span> <span class="fl">1</span>))<span class="op">;</span></span><span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>        <span class="va">yval</span><span class="op">=</span><span class="va">floor</span>(<span class="va">map</span>(<span class="va">i</span><span class="op">,</span> <span class="fl">2</span>))<span class="op">;</span></span><span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>        <span class="va">MAP</span>(<span class="va">xval</span><span class="op">,</span><span class="va">yval</span>)<span class="op">=-</span><span class="fl">1</span><span class="op">;</span></span><span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span> </span><span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span><span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">%Initialize MAP with location of the start point</span></span><span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    <span class="va">xval</span><span class="op">=</span><span class="va">floor</span>(<span class="va">map</span>(<span class="fl">1</span><span class="op">,</span> <span class="fl">1</span>))<span class="op">;</span></span><span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    <span class="va">yval</span><span class="op">=</span><span class="va">floor</span>(<span class="va">map</span>(<span class="fl">1</span><span class="op">,</span> <span class="fl">2</span>))<span class="op">;</span></span><span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    <span class="va">xStart</span><span class="op">=</span><span class="va">xval</span><span class="op">;</span></span><span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    <span class="va">yStart</span><span class="op">=</span><span class="va">yval</span><span class="op">;</span></span><span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    <span class="va">MAP</span>(<span class="va">xval</span><span class="op">,</span><span class="va">yval</span>)<span class="op">=</span><span class="fl">1</span><span class="op">;</span></span><span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><p>start your code here，首先定义一个函数，用于计算欧氏距离。</p><div class="sourceCode" id="cb11"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">% dim=1是对列求和，dim=2是对行求和</span></span><span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="va">cost</span> <span class="op">=</span> <span class="va">dist</span>(<span class="va">start_pos</span><span class="op">,</span> <span class="va">goal_pos</span><span class="op">,</span><span class="va">dim</span>)</span><span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">cost</span> <span class="op">=</span> <span class="va">sqrt</span>(<span class="va">sum</span>((<span class="va">double</span>(<span class="va">start_pos</span>) <span class="op">-</span> <span class="va">double</span>(<span class="va">goal_pos</span>))<span class="op">.^</span><span class="fl">2</span><span class="op">,</span><span class="va">dim</span>))<span class="op">;</span></span><span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span></code></pre></div></li></ul><div class="sourceCode" id="cb12"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">%% g(n)和h(n)的初始化</span></span><span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="va">G_score</span> <span class="op">=</span> <span class="va">inf</span>(<span class="va">size</span>(<span class="va">MAP</span>))<span class="op">;</span></span><span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="va">G_score</span>(<span class="va">xStart</span><span class="op">,</span> <span class="va">yStart</span>)<span class="op">=</span><span class="fl">0</span><span class="op">;</span></span><span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="va">herustic</span><span class="op">=</span><span class="va">zeros</span>(<span class="va">size</span>(<span class="va">MAP</span>))<span class="op">;</span></span><span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">%关于ind2sub函数http://blog.sina.com.cn/s/blog_7054a1960102vyby.html</span></span><span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">%[row,col]就是（1,1）（2,1）（3,1）。。。（1,2）（2,2）.。。</span></span></code></pre></div><p>启发式的路径规划，最重要的是目标导向型，所以herustic（n）就是一个和MAP维度一样的矩阵，只是每个节点存储的是该节点到goal 的距离，这样每一次迭代只需要计算g（n）+h（n）的最小值就可以知道下一步在哪了。</p><div class="sourceCode" id="cb13"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a> <span class="co">%% h(n)定义</span></span><span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a> [<span class="va">row</span><span class="op">,</span><span class="va">col</span>]<span class="op">=</span><span class="va">ind2sub</span>(<span class="va">size</span>(<span class="va">G_score</span>)<span class="op">,</span> <span class="fl">1</span><span class="op">:</span><span class="va">numel</span>(<span class="va">G_score</span>))<span class="op">;</span></span><span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a> <span class="va">matrix_</span> <span class="op">=</span> [<span class="va">row</span><span class="op">;</span><span class="va">col</span>]<span class="op">;</span></span><span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a> <span class="va">dist_temp</span><span class="op">=</span><span class="va">dist</span>(<span class="va">matrix_</span><span class="op">,</span>[<span class="va">xTarget</span><span class="op">;</span><span class="va">yTarget</span>]<span class="op">,</span><span class="fl">1</span>)<span class="op">;</span></span><span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a> <span class="va">herustic</span>(<span class="fl">1</span><span class="op">:</span><span class="kw">end</span>)<span class="op">=</span><span class="va">dist_temp</span>(<span class="fl">1</span><span class="op">:</span><span class="kw">end</span>)<span class="op">;</span></span><span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a> <span class="co">% unvisited=1, visted=inf</span></span></code></pre></div><p>两个标记矩阵，unvisited（10*10），backtrack（10*10*2），其中backtrack是存储的是回溯路径，如下图中的backtrack矩阵，第一个var(:,:,1)存储的是回溯的行row，另外一个是column，这样只需要一步一步的回溯，可以得到optimal path。<img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220330205219290.png" alt="backtrack"></p><figure><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220330205245623.png" alt="optimal_path"><figcaption aria-hidden="true">optimal_path</figcaption></figure><div class="sourceCode" id="cb14"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">%% 未访问节点矩阵初始化</span></span><span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">% 如果未访问unvisited矩阵中的值为1，访问过就是inf</span></span><span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="va">unvisited</span> <span class="op">=</span> <span class="va">ones</span>(<span class="va">size</span>(<span class="va">MAP</span>))<span class="op">;</span></span><span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="va">backtrack</span> <span class="op">=</span> <span class="va">zeros</span>(<span class="va">size</span>(<span class="va">MAP</span><span class="op">,</span><span class="fl">1</span>)<span class="op">,</span><span class="va">size</span>(<span class="va">MAP</span><span class="op">,</span><span class="fl">2</span>)<span class="op">,</span><span class="fl">2</span>)<span class="op">;</span></span><span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">% row_delta和col_delta是可以走的八个方向东、西、南、北、东北。。。</span></span><span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">row_delta</span><span class="op">=</span>[<span class="op">-</span><span class="fl">1</span><span class="op">,-</span><span class="fl">1</span><span class="op">,-</span><span class="fl">1</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">1</span><span class="op">,</span><span class="fl">1</span><span class="op">,</span><span class="fl">1</span>]<span class="op">;</span></span><span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="va">col_delta</span><span class="op">=</span>[<span class="op">-</span><span class="fl">1</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">1</span><span class="op">,-</span><span class="fl">1</span><span class="op">,</span><span class="fl">1</span><span class="op">,-</span><span class="fl">1</span><span class="op">,</span><span class="fl">0</span><span class="op">,</span><span class="fl">1</span>]<span class="op">;</span></span></code></pre></div><p>下面将展示本次代码的核心部分，如何寻找最优路径：</p><div class="sourceCode" id="cb15"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">while</span>(<span class="op">~</span><span class="va">all</span>(<span class="va">unvisited</span><span class="op">==</span><span class="va">inf</span>))</span><span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>        <span class="co">% take lowest g(n) [masked]</span></span><span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>       [<span class="va">min_val</span><span class="op">,</span><span class="va">idx</span>]<span class="op">=</span><span class="va">min</span>(<span class="va">unvisited</span>(<span class="op">:</span>)<span class="op">.*</span>(<span class="va">G_score</span>(<span class="op">:</span>)<span class="op">+</span><span class="va">herustic</span>(<span class="op">:</span>)))<span class="op">;</span></span><span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>       [<span class="va">row</span><span class="op">,</span><span class="va">col</span>]<span class="op">=</span><span class="va">ind2sub</span>(<span class="va">size</span>(<span class="va">G_score</span>)<span class="op">,</span><span class="va">idx</span>)<span class="op">;</span></span><span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>       <span class="co">% remove and mark as visited</span></span><span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>       <span class="va">unvisited</span>(<span class="va">row</span><span class="op">,</span><span class="va">col</span>)<span class="op">=</span><span class="va">inf</span><span class="op">;</span></span><span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>       <span class="co">% reach goal</span></span><span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>       <span class="kw">if</span> <span class="va">row</span><span class="op">==</span><span class="va">xTarget</span> <span class="op">&amp;&amp;</span> <span class="va">col</span><span class="op">==</span><span class="va">yTarget</span></span><span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>           <span class="kw">break</span><span class="op">;</span></span><span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>       <span class="kw">end</span></span><span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span><span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>       <span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">length</span>(<span class="va">row_delta</span>)</span><span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>           <span class="va">temp_ind</span><span class="op">=</span>[<span class="va">row</span><span class="op">+</span><span class="va">row_delta</span>(<span class="va">i</span>)<span class="op">,</span><span class="va">col</span><span class="op">+</span><span class="va">col_delta</span>(<span class="va">i</span>)]<span class="op">;</span></span><span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>           <span class="co">%no obstacle, unvisted, within the index bound</span></span><span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>           <span class="kw">if</span> <span class="va">all</span>(<span class="va">temp_ind</span><span class="op">&gt;</span><span class="fl">0</span>) <span class="op">&amp;&amp;</span> <span class="va">temp_ind</span>(<span class="fl">1</span>) <span class="op">&lt;=</span> <span class="va">MAX_X</span> <span class="op">&amp;&amp;</span> <span class="va">temp_ind</span>(<span class="fl">2</span>) <span class="op">&lt;=</span><span class="va">MAX_Y</span><span class="op">...</span></span><span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>               <span class="op">&amp;&amp;</span> <span class="va">MAP</span>(<span class="va">temp_ind</span>(<span class="fl">1</span>)<span class="op">,</span><span class="va">temp_ind</span>(<span class="fl">2</span>))<span class="op">~=-</span><span class="fl">1</span>  <span class="op">&amp;&amp;</span> <span class="va">unvisited</span>(<span class="va">temp_ind</span>(<span class="fl">1</span>)<span class="op">,</span><span class="va">temp_ind</span>(<span class="fl">2</span>))<span class="op">==</span><span class="fl">1</span></span><span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span><span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>                <span class="va">temp</span> <span class="op">=</span> <span class="va">G_score</span>(<span class="va">row</span><span class="op">,</span><span class="va">col</span>)<span class="op">+</span><span class="va">dist</span>([<span class="va">row</span><span class="op">,</span><span class="va">col</span>]<span class="op">,</span><span class="va">temp_ind</span><span class="op">,</span><span class="fl">2</span>)<span class="op">;</span></span><span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>                <span class="kw">if</span> <span class="va">temp</span> <span class="op">&lt;</span> <span class="va">G_score</span>(<span class="va">temp_ind</span>(<span class="fl">1</span>)<span class="op">,</span><span class="va">temp_ind</span>(<span class="fl">2</span>))</span><span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>                    <span class="va">G_score</span>(<span class="va">temp_ind</span>(<span class="fl">1</span>)<span class="op">,</span><span class="va">temp_ind</span>(<span class="fl">2</span>))<span class="op">=</span><span class="va">temp</span><span class="op">;</span></span><span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>                    <span class="va">backtrack</span>(<span class="va">temp_ind</span>(<span class="fl">1</span>)<span class="op">,</span><span class="va">temp_ind</span>(<span class="fl">2</span>)<span class="op">,:</span>)<span class="op">=</span>[<span class="va">row</span><span class="op">,</span><span class="va">col</span>]<span class="op">;</span></span><span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>                <span class="kw">end</span></span><span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>           <span class="kw">end</span> </span><span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>       <span class="kw">end</span></span><span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span><span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">% no path found</span></span><span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="va">G_score</span>(<span class="va">xTarget</span><span class="op">,</span><span class="va">yTarget</span>)<span class="op">==</span><span class="va">inf</span></span><span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>        <span class="va">Optimal_path</span><span class="op">=</span>[]<span class="op">;</span></span><span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>        <span class="va">disp</span>(<span class="st">&quot;No path found&quot;</span>)<span class="op">;</span></span><span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">else</span></span><span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>        <span class="va">ptr_ind</span> <span class="op">=</span> <span class="va">reshape</span>(<span class="va">backtrack</span>(<span class="va">xTarget</span><span class="op">,</span><span class="va">yTarget</span><span class="op">,:</span>)<span class="op">,</span>[<span class="fl">1</span><span class="op">,</span><span class="fl">2</span>])<span class="op">;</span></span><span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>        <span class="va">Optimal_path</span><span class="op">=</span>[<span class="va">xTarget</span><span class="op">,</span><span class="va">yTarget</span><span class="op">,</span><span class="va">map</span>(<span class="fl">1</span><span class="op">,</span><span class="fl">3</span>)]<span class="op">;</span></span><span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>        <span class="kw">while</span> (<span class="va">ptr_ind</span>(<span class="fl">1</span>)<span class="op">~=</span><span class="va">xStart</span> <span class="op">||</span> <span class="va">ptr_ind</span>(<span class="fl">2</span>)<span class="op">~=</span><span class="va">yStart</span>)</span><span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>            <span class="va">Optimal_path</span><span class="op">=</span>[[<span class="va">ptr_ind</span><span class="op">,</span><span class="va">map</span>(<span class="fl">1</span><span class="op">,</span><span class="fl">3</span>)]<span class="op">;</span><span class="va">Optimal_path</span>]<span class="op">;</span></span><span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>            <span class="va">ptr_ind</span> <span class="op">=</span> <span class="va">reshape</span>(<span class="va">backtrack</span>(<span class="va">ptr_ind</span>(<span class="fl">1</span>)<span class="op">,</span><span class="va">ptr_ind</span>(<span class="fl">2</span>)<span class="op">,:</span>)<span class="op">,</span>[<span class="fl">1</span><span class="op">,</span><span class="fl">2</span>])<span class="op">;</span></span><span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>        <span class="kw">end</span></span><span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>        <span class="va">Optimal_path</span><span class="op">=</span>[[<span class="va">xStart</span><span class="op">,</span><span class="va">yStart</span><span class="op">,</span><span class="va">map</span>(<span class="fl">1</span><span class="op">,</span><span class="fl">3</span>)]<span class="op">;</span><span class="va">Optimal_path</span>]<span class="op">;</span></span><span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>        <span class="va">disp</span>(<span class="va">Optimal_path</span>)</span><span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">Optimal_path</span><span class="op">=</span> <span class="va">Optimal_path</span><span class="op">-</span>[<span class="fl">0.5</span> <span class="fl">0.5</span> <span class="fl">0</span>]<span class="op">;</span></span><span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span></code></pre></div><ul><li><p>结果展示</p><figure><img src="/2023/03/26/wu-ren-ji-hkust-ke-jian-xue-xi/image-20220330205735520.png" alt="map1"><figcaption aria-hidden="true">map1</figcaption></figure><p><strong>不是bgm，是听的歌录进去了！！！</strong></p><video src="https://copy2000.github.io/medias/vedio/map1.mp4" controls="controls" style="max-width: 100%; display: block; margin-left: auto; margin-right: auto;"><p>your browser does not support the video tag</p></video><hr><video src="https://copy2000.github.io/medias/vedio/map2.mp4" controls="controls" style="max-width: 100%; display: block; margin-left: auto; margin-right: auto;"><p>your browser does not support the video tag</p></video></li></ul>]]></content>
      
      
      <categories>
          
          <category> 无人机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 控制 </tag>
            
            <tag> 无人机 </tag>
            
            <tag> MATLAB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【论文】EGO-Swarm</title>
      <link href="/2023/03/26/lun-wen-ego-swarm/"/>
      <url>/2023/03/26/lun-wen-ego-swarm/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ego-swarm">EGO-Swarm</h1><center><a href="https://github.com/ZJU-FAST-Lab/ego-planner-swarm">论文来源</a></center><figure><img src="data:image/jpeg;base64,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" alt="EGO-Swarm: A Fully Autonomous and Decentralized Quadrotor Swarm System in Cluttered Environments"><figcaption aria-hidden="true">EGO-Swarm: A Fully Autonomous and Decentralized Quadrotor Swarm System in Cluttered Environments</figcaption></figure><span id="more"></span><h2 id="摘要">摘要</h2><p>​ 这篇文章主要是提出一个在复杂环境下去中心化异步系统性的多无人机自动导航解决方案。在基于梯度的局部规划框架中，通过将<em>碰撞风险作为一种惩罚非线性优化问题</em>来避免碰撞。为了提高鲁棒性和避免局部最小，本算法运用了<strong>轻量级的拓扑学路径生成方法</strong>；使用<strong>可依赖的路径分享网络</strong>，多无人机能够生成安全、平坦、满足动态可行性的路径。</p><h2 id="介绍">介绍</h2><h3 id="背景">背景</h3><p>很少有研究工作将四旋翼群在未知环境下的单智能体自主导航和已知环境下的多智能体精确编队控制结合起来<strong>展示能够导航共享相同未知空间的四旋翼群的真实世界系统</strong>，特别是只有onboard处理。</p><h3 id="问题">问题</h3><p>在未知环境中部署多个四旋翼遇到的问题包括但不限于</p><ul><li><em>障碍物参数化的重要性</em>(nontriviality of obstacle parameterization)</li><li><em>感应范围有限</em>(limited sensing range)</li><li><em>不可靠和带宽有限通信</em>(unreliable and bandwidth limited communication)</li><li><em>定位漂移</em>(position drift)</li></ul><h3 id="ego-swarm的优点">EGO-Swarm的优点</h3><p>它在<strong>不需要外部本地化和计算或预先构建的地图</strong>的情况下，使得无人机群高性能的在拥挤环境中飞行，并且完美的解决上述问题。</p><h3 id="算法组成">算法组成</h3><ul><li><body><p style="color:red;">拓扑规划(topological planning)</p></body><ul><li>拓扑规划有效的<strong>避免了局部最优</strong>。</li><li>因为在EGO-planner中<strong>前端拓扑路径搜索是隐式完成的</strong>，所以大大<strong>节省了计算时间</strong>。</li></ul></li><li><body><p style="color:red;">相互碰撞避免(reciprocal collision avoidance)</p></body><ul><li>去中心化的相互碰撞避免算法是通过<strong>在目标函数中添加一个无人机碰撞的权重惩罚来实现的</strong>。通过将未来时间的代理分布与正在优化的轨迹进行比较来评估这种惩罚。</li><li>为了<strong>尽量减少数据传输并允许不可靠的通信</strong>，<strong>广播网络</strong>(broadcast network)用于分享轨迹。 为了纠正相对定位漂移(relative localization)，附近的无人机的观察和来自轨迹评估的预测进行比较。(应该就是将别的无人机看到的情况和自己本身的路径规划进行比较)</li></ul></li></ul><h2 id="算法大致步骤">算法大致步骤</h2><figure><img src="/2023/03/26/lun-wen-ego-swarm/image-20220319135810344.png" alt="框架"><figcaption aria-hidden="true">框架</figcaption></figure><h3 id="基于梯度的局部规划的隐式拓扑轨迹生成">基于梯度的局部规划的隐式拓扑轨迹生成</h3><ul><li>A.一个无 ESDF 的基于梯度的局部规划器：EGO-Planner</li><li>B.隐式拓扑轨迹生成</li></ul><h3 id="无人机群导航">无人机群导航</h3><ul><li><p>相互碰撞避免</p></li><li><p>定位漂移补偿</p><blockquote><p>一种简化且轻量级的相对漂移通过比较从接收到的代理轨迹评估的预测位置和从目击代理的深度图像中测量的位置，提出了估计方法。</p></blockquote></li><li><p>从深度图像中去除无人机</p><blockquote><p>移动的无人机已经在<strong>相互碰撞避免</strong>中考虑过了，所以在地图建造和轨迹规划的时候没有必要将无人机考虑进去。</p></blockquote></li></ul><h2 id="system-architecture">SYSTEM ARCHITECTURE</h2><figure><img src="/2023/03/26/lun-wen-ego-swarm/image-20220317235916599.png" alt="论文提供的图"><figcaption aria-hidden="true">论文提供的图</figcaption></figure><ul><li><p><strong>单无人机导航系统 </strong>：EGO-Planner+VIO（vision inertial odometry）偏移补偿+从深度图像中去除其他无人机</p></li><li><p><strong>通信框架</strong></p><ul><li><p>一个共享轨迹的<strong>广播网络</strong>(broadcast network)</p><blockquote><p>一旦无人机生成一个新的无碰撞轨迹，立即向所有无人机广播 。然后其他无人机接收并存储该轨迹用于在必要时为自己生成安全轨迹。这种闭环策略在理想情况下正常工作连接稳定和延迟的情况 可以忽略不计。但是，这在实践中并不能保证。 因此提出了两种方法来降低这种可能性碰撞的 方法</p><ul><li>在网络容量满足的情况下以给定频率将轨迹进行广播。包含三维位点的轨迹一般小于0.5KB，一般的无线网络可以达到1Mbps。</li><li>每个无人机检查碰撞，一旦从广播网络接收到轨迹， 如果检测到潜在的碰撞，则无人机生成新的无碰撞轨迹 。</li></ul></blockquote></li><li><p>一个用于同步时间戳和管理顺序启动的<strong>链式网络</strong>( chain network)</p><blockquote><p>这个策略避免在系统启动期间,无人机因为没有其他无人机轨迹的信息同步造成的 生成轨迹时引起的混乱 。</p></blockquote><h2 id="比较">比较</h2></li></ul><h3 id="topological-planning">Topological Planning</h3><figure><img src="/2023/03/26/lun-wen-ego-swarm/image-20220319142346688.png" alt="论文中的图"><figcaption aria-hidden="true">论文中的图</figcaption></figure><p>EGO-Swarm和Fast-Planner的比较：</p><ul><li><p>EGO-Swarm找到的可行轨迹（candidates trajectory）较少，这意味着找到全局最优的概率较低，但速度更快。</p></li><li><p>Fast-Planner通过 PRM图搜索、路径缩短和路径修剪来寻找拓扑路线，这些都是耗时的方法，但与隐式拓扑路径搜索方法（EGO-Swarm使用的方法）比较而言，相对自由度更高。</p><figure><img src="/2023/03/26/lun-wen-ego-swarm/53a3bd45b37661b1f8daacdaa5743323.png" alt="PRM"><figcaption aria-hidden="true">PRM</figcaption></figure></li></ul><h3 id="swarm-planning">Swarm Planning</h3><p>下面的表格表示使用4种不同的规划器在<em>飞行距离d<sub>fly</sub>(m)、飞行时间t<sub>fly</sub>(s)、每个无人机碰撞次数Collision和计算时间t<sub>cal</sub>(s)</em>进行比较。</p><figure><img src="/2023/03/26/lun-wen-ego-swarm/image-20220319141807992.png" alt="避障算法比较"><figcaption aria-hidden="true">避障算法比较</figcaption></figure></li><li><p>RBP：RBP 倾向于产生<strong>安全的但保守的轨迹，因为凸形的飞行轨迹相对安全，但是减少了解决方案的空间</strong>（就是每一条轨迹太占地方了）。</p></li><li><p>DMPC：专为分布式部署而设计。然而，它需要<strong>准确和高频姿势通信</strong>，在真实的应用程序中无法保证。</p></li><li><p>ORCA： 高效的规则使ORCA 更新很快。 然而，<strong>使用速度作为控制命令使其与四旋翼等三阶系统不兼容</strong>。 这样的碰撞风险也限制了它的应用。</p></li><li><p>EGO-Swarm：所提出的方法<strong>生成最短的无碰撞、非保守轨迹，计算速度最快</strong>。</p><figure><img src="/2023/03/26/lun-wen-ego-swarm/image-20220319142545155.png" alt="不同避障算法的飞行轨迹"><figcaption aria-hidden="true">不同避障算法的飞行轨迹</figcaption></figure><h2 id="总结">总结</h2><p>在本文中，提出了一种仅使用onboard资源在未知杂乱环境中进行多机器人导航的系统解决方案。 基准（Benchmark）比较表明其计算时间短，轨迹质量高。 真实世界的实验验证了它的稳健性和效率。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 论文 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS </tag>
            
            <tag> 集群控制 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【实验】语音识别</title>
      <link href="/2023/03/26/shi-yan-yu-yin-shi-bie/"/>
      <url>/2023/03/26/shi-yan-yu-yin-shi-bie/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><center>为学校数字信号处理实验总结和归纳；</center><p><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/OIP-C.qTq2jfShxrP6Z7XWhDbuMQHaCmw=338&amp;h=123&amp;c=7&amp;r=0&amp;o=5&amp;dpr=1.38&amp;pid=1.7" alt="语音识别"><span id="more"></span></p><h1 id="语音识别">语音识别</h1><p>题目及相关要求在<a href="https://copy2000.github.io/Docs/数字信号处理实验.pdf">here</a>.</p><h2 id="数据预处理">数据预处理</h2><p>大致步骤：</p><ul><li><p>获取原始音频<img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325163503472.png" alt="原始语音信号"></p></li><li><p>检测<img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325163511071.png" alt="过零率检测"></p></li><li><p>分帧<img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325163412540.png" alt="分帧"></p></li><li><p>加窗<img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325163420911.png" alt="加窗"></p></li><li><p>特征提取<img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325163430670.png" alt="预处理后得到的语音信号的特征值"></p></li></ul><h3 id="端点检测">端点检测</h3><table><thead><tr class="header"><th style="text-align: center;"><strong>端点检测参数指标</strong></th><th style="text-align: center;">相对值</th></tr></thead><tbody><tr class="odd"><td style="text-align: center;">初始短时能量高门限</td><td style="text-align: center;">50</td></tr><tr class="even"><td style="text-align: center;">初始短时能量低门限</td><td style="text-align: center;">10</td></tr><tr class="odd"><td style="text-align: center;">初始短时过零率高门限</td><td style="text-align: center;">10</td></tr><tr class="even"><td style="text-align: center;">初始短时过零率低门限</td><td style="text-align: center;">2</td></tr><tr class="odd"><td style="text-align: center;">最大静音长度</td><td style="text-align: center;">8ms</td></tr><tr class="even"><td style="text-align: center;">语音最小长度</td><td style="text-align: center;">20ms</td></tr></tbody></table><p>这里我们进行的是基于阈值的VAD，通过提取时域（短时能量、短期过零率等）或频域(MFCC、频谱等）特征，通过合理的设置门限，达到区分语音和非语音的目的。</p><p>我们的端点检测初始特征阙值如右表所示，通过这样的指标，我们检测出来的音频信息可以过滤掉大部分的噪音。</p><p>部分数字与名字信号的双端检测结果如下所示：</p><figure><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325163910791.png" alt="数字"><figcaption aria-hidden="true">数字</figcaption></figure><figure><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325163921075.png" alt="名字"><figcaption aria-hidden="true">名字</figcaption></figure><h3 id="分帧">分帧</h3><p>由于语音信号具有短时的平稳时不变的特性，因此对其在时域上进行短时间的分帧进行分析。</p><p>实验中使用的30ms的窗口长度和10ms的帧移，有比较好的效果。</p><h3 id="加窗">加窗</h3><p>通过不同的窗处理滞后得到的图形有区别，其中矩形窗的变化比较剧烈，汉宁窗、海明窗的变换较为平稳。</p><figure><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325164243148.png" alt="加窗过程"><figcaption aria-hidden="true">加窗过程</figcaption></figure><ul><li>矩形窗处理后的时域信号<img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325164302330.png" alt="矩形窗处理后的时域信号"></li><li>汉明窗处理后的时域信号<img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325164318155.png" alt="汉明窗处理后的时域信号"></li><li>海宁窗处理后的时域信号<img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325164322255.png" alt="海宁窗处理后的时域信号"></li></ul><h2 id="时域语音识别">时域语音识别</h2><h3 id="提取语音特征">提取语音特征</h3><p>将处理之后的数据进行归一化处理，并计算出每一帧的特征值，以帧数作为特征向量的维数，得到用于分类的特征向量。特征向量是由过零率、能量和幅值组成的。</p><figure><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325164453479.png" alt="预处理后的语音"><figcaption aria-hidden="true">预处理后的语音</figcaption></figure><h3 id="使用的分类器">使用的分类器</h3><ul><li><p>如果一个样本在特征空间中的K个最邻近的样本中的大多数属于某一个类别，则该样本也属于这个类别，并具有这个类别样本的特性。<img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325164601602.png" alt="KNN"></p></li><li><p>基本模型是定义在特征空间上的间隔最大的线性分类器，利用超平面，对数据集进行最大间隔划分，得到该超平面的表达式。<img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325164622509.png" alt="SVM"></p></li><li><p>在已知各种情况发生概率的基础上，通过构成决策树来求取净现值的期望值大于等于0的概率，评价项目风险，判断其可行性的决策分析方法。<img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325164643582.png" alt="决策树"></p></li><li><p>集成学习Based on KNN</p><ul><li><p>集成学习算法是通过构建并结合多个分类器来完成学习任务，通常拥有较高的准确率，其不足之处是模型比较复杂。<img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325164810321.png" alt="Performance"></p></li><li><p>实现过程</p><ul><li><p>随机对原始数据的特征值进行随机采样。</p></li><li><p>将采样数据送入若干个KNN学习器中进行决策判断。</p></li><li><p>将所有结果进行投票处理。</p></li></ul><figure><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325164732159.png" alt="集成学习流程"><figcaption aria-hidden="true">集成学习流程</figcaption></figure></li></ul></li></ul><h3 id="时域语音分析">时域语音分析</h3><p>下面分别是KNN、SVM、决策树、集成学习KNN分类器得到的判别矩阵和AUC曲线。</p><figure><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325164952994.png" alt="时域语音分析"><figcaption aria-hidden="true">时域语音分析</figcaption></figure><p>结果如下表：</p><table><thead><tr class="header"><th style="text-align: center;">分类器</th><th style="text-align: center;"><strong>准确率</strong></th><th style="text-align: center;"><strong>查准率</strong></th><th style="text-align: center;"><strong>第一类错误率</strong></th><th style="text-align: center;"><strong>第二类错误率</strong></th><th style="text-align: center;"><strong>F-score</strong></th></tr></thead><tbody><tr class="odd"><td style="text-align: center;">KNN</td><td style="text-align: center;">0.32</td><td style="text-align: center;">0.33</td><td style="text-align: center;">1.00</td><td style="text-align: center;">0.80</td><td style="text-align: center;">0.25</td></tr><tr class="even"><td style="text-align: center;">SVM</td><td style="text-align: center;">0.42</td><td style="text-align: center;">1.00</td><td style="text-align: center;">0.00</td><td style="text-align: center;">0.67</td><td style="text-align: center;">0.50</td></tr><tr class="odd"><td style="text-align: center;">Tree</td><td style="text-align: center;">0.37</td><td style="text-align: center;">0.50</td><td style="text-align: center;">0.25</td><td style="text-align: center;">0.50</td><td style="text-align: center;">0.50</td></tr><tr class="even"><td style="text-align: center;">集成学习KNN</td><td style="text-align: center;">0.44</td><td style="text-align: center;">0.60</td><td style="text-align: center;">0.67</td><td style="text-align: center;">0.25</td><td style="text-align: center;">0.67</td></tr></tbody></table><figure><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325165237118.png" alt="分类结果"><figcaption aria-hidden="true">分类结果</figcaption></figure><h4 id="不同加窗方式的效果比较">不同加窗方式的效果比较</h4><table><thead><tr class="header"><th style="text-align: center;"><strong>窗口种类</strong></th><th style="text-align: center;"><strong>准确率</strong></th><th style="text-align: center;"><strong>查准率</strong></th><th style="text-align: center;"><strong>第一类错误率</strong></th><th style="text-align: center;"><strong>第二类错误率</strong></th><th style="text-align: center;"><strong>F-score</strong></th></tr></thead><tbody><tr class="odd"><td style="text-align: center;">矩形窗</td><td style="text-align: center;">0.44</td><td style="text-align: center;">0.6</td><td style="text-align: center;">0.67</td><td style="text-align: center;">0.25</td><td style="text-align: center;">0.67</td></tr><tr class="even"><td style="text-align: center;">汉明窗</td><td style="text-align: center;">0.39</td><td style="text-align: center;">1</td><td style="text-align: center;">0</td><td style="text-align: center;">0..50</td><td style="text-align: center;">0.67</td></tr><tr class="odd"><td style="text-align: center;">海宁窗</td><td style="text-align: center;">0.45</td><td style="text-align: center;">0.67</td><td style="text-align: center;">1</td><td style="text-align: center;">0.6</td><td style="text-align: center;">0.5</td></tr></tbody></table><center><p style="font-size:30px">F-score表现：矩形窗=汉明窗&gt;海宁窗</p></center><center><p style="font-size:30px">矩形窗处理后的语音信号识别效果更好</p></center><hr><h2 id="频域语音识别">频域语音识别</h2><h3 id="实验流程">实验流程</h3><ul><li><p>通过电脑录制音频。</p></li><li><p>将得到的音频数据进行预处理，经过端点检测得到理想的音频数据。</p></li><li><p>提取音频数据的MFCC特征。</p></li><li><p>进行DTW算法搜索。</p></li><li><p>将得到的结果进行总结归纳。</p><figure><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325165857908.png" alt="实验流程"><figcaption aria-hidden="true">实验流程</figcaption></figure></li></ul><hr><h3 id="mfcc特征提取">MFCC特征提取</h3><ul><li><p>分帧</p></li><li><p>FFT:对每一帧语音进行256点快速傅里叶变换。</p></li><li><p>三角带通滤波器</p></li><li><p>离散余弦转换:离散余弦转换(DCT)系数是用来将能量集中在前面几项中，达到在减少判别参数提高运算速度的同时又不失其准确性的目的。<img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325170120765.png" alt="DCT"></p></li><li><p>差量倒谱参数:一阶差分MFCC参数，体现相邻两帧之间的联系，所以我们合并mfcc参数和一阶差分mfcc参数形成MFCC参数，并且去除首尾两帧，以增加MFCC参数的准确性，增强实验的预测能力。<img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325170202049.png" alt="mfcc"><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325170219917.png" alt="一阶差分mfcc"></p></li><li><p>DTW</p></li></ul><hr><h3 id="时域语音分析-1">时域语音分析</h3><p>我们使用交叉验证的方法，训练集与测试集的比例为9:1，在进行1000次的重复试验后，得到的数字识别与名字识别在不同的窗函数下得到的准确率如下。其中x轴为测试次数，y轴为准确率。</p><figure><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325170356093.png" alt="rectangle_name_accuracy"><figcaption aria-hidden="true">rectangle_name_accuracy</figcaption></figure><figure><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325170402947.png" alt="hanning_ name_accuracy"><figcaption aria-hidden="true">hanning_ name_accuracy</figcaption></figure><figure><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325170408065.png" alt="hamming_name_accuracy"><figcaption aria-hidden="true">hamming_name_accuracy</figcaption></figure><figure><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325170412586.png" alt="rectangle_num_accuracy"><figcaption aria-hidden="true">rectangle_num_accuracy</figcaption></figure><figure><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325170416241.png" alt="hanning_num_accuracy"><figcaption aria-hidden="true">hanning_num_accuracy</figcaption></figure><figure><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325170420192.png" alt="hamming_num_accuracy"><figcaption aria-hidden="true">hamming_num_accuracy</figcaption></figure><figure><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325170605238.png" alt="performance"><figcaption aria-hidden="true">performance</figcaption></figure><p><strong>由上表各矩形窗的准确率所示，在矩形窗下数字识别整体准确率最低，而在汉明窗和海宁窗下的数字识别准确率相差不大。但是名字准确率在三个窗下的准确率波动不大。</strong></p><hr><p>相关视频：</p><video src="https://copy2000.github.io/medias/vedio/%E6%9C%AA%E8%B0%83%E5%8F%82%E8%AF%86%E5%88%AB.mp4" controls="controls" style="max-width: 100%; display: block; margin-left: auto; margin-right: auto;">your browser does not support the video tag</video><p>我们可以发现在名字识别的时候端点检测只能检测到名字中的第一个字，这个是因为端点检测的参数没有进行调整。<img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325171830306.png" alt="问题"></p><hr><p>进行二次调参后：<img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325171924202.png" alt="端点检测参数"></p><video src="https://copy2000.github.io/medias/vedio/%E8%B0%83%E5%8F%82%E8%AF%86%E5%88%AB.mp4" controls="controls" style="max-width: 100%; display: block; margin-left: auto; margin-right: auto;">your browser does not support the video tag</video><h2 id="基于gmm模型的声纹识别">基于GMM模型的声纹识别</h2><h3 id="gmm">GMM</h3><p>高斯混合模型（GMM）是声纹识别中最常用的模型之一，因为在声纹识别中，如何将语音特征很好地进行总结及测试语音如何与训练语音进行匹配都是非常复杂难解决的问题，而GMM将这些问题转为对于模型的操作及概率计算等问题，并进行解决。高斯混合模型可以逼近任何一个连续的概率分布，因此它可以看做是连续型概率分布的万能逼近器。GMM模型是一个有监督的训练过程。它的基本思想就是利用已知的样本结果来反推最有可能（也就是最大概率）导致该个结果的参数值，在这个原则之下，GMM通常采用最大期望算法（EM）模型进行迭代直到收敛来确定参数。</p><h3 id="我们的工作">我们的工作</h3><p>实验流程如下：</p><p>首先通过分帧，加窗等方法，对语音信号预处理，得到有效语音信号后，提取语音信号MFCC特征，并将其作为GMM模型的输入，对GMM模型进行训练，最后通过测试集对GMM模型进行测试。</p><figure><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325172038542.png" alt="通过双门限法获取有效语音信号"><figcaption aria-hidden="true">通过双门限法获取有效语音信号</figcaption></figure><figure><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325172053131.png" alt="通过melcepst函数获取MFCC特征"><figcaption aria-hidden="true">通过melcepst函数获取MFCC特征</figcaption></figure><p>将提取到的语音MFCC特征，通过fitgmdist函数进行GMM模型训练，得到每个人的语音特征</p><figure><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325172101672.png" alt="GMM模型训练"><figcaption aria-hidden="true">GMM模型训练</figcaption></figure><h3 id="说话人识别结果">说话人识别结果</h3><p>我们将每个同学念名字的语音信号和每个同学念数字的语音信号分别放入GMM模型和SVM分别进行训练和测试，对比两种模型优劣。</p><p>记放入训练的数字语音为I1，放入训练的名字语音为I2，用于测试的数字语音为O1，用于测试的名字语音为O2，我们分别用I1，I2作为训练集进行训练，并对每种情况下分别用O1和O2测试准确率。结果如图，可以看出当说话人语音为名字时，识别效果较好，为数字时较差。此外GMM模型效果优于SVM，SVM训练集准确率为1，而测试集准确率较低，模型泛化能力差，GMM泛化能力更好。</p><figure><img src="/2023/03/26/shi-yan-yu-yin-shi-bie/image-20220325172146530.png" alt="performance"><figcaption aria-hidden="true">performance</figcaption></figure><h2 id="写在后面">写在后面</h2><p>对应的代码在<a href="https://github.com/Copy2000/DSP_experiment">Copy2000/DSP_experiment: 学校实验 (github.com)</a>，写的很乱，就这样，然后视频由于是放在github的服务器，可能会很慢。</p><p>还有两篇小论文：</p><ul><li><a href="https://copy2000.github.io/medias/Docs/基于频域分析的语音识别.pdf">基于频域分析的语音识别.pdf (copy2000.github.io)</a></li><li><a href="https://copy2000.github.io/medias/Docs/基于频域分析的语音识别.pdf">基于时域分析的语音识别.pdf (copy2000.github.io)</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 实验 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数字信号处理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【实验】树莓派小车</title>
      <link href="/2023/03/26/shi-yan-shu-mei-pai-xiao-che/"/>
      <url>/2023/03/26/shi-yan-shu-mei-pai-xiao-che/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><figure><img src="/2023/03/26/shi-yan-shu-mei-pai-xiao-che/image-20230315235653212.png" alt="image-20230315235653212"><figcaption aria-hidden="true">image-20230315235653212</figcaption></figure><span id="more"></span><h1 id="树莓派小车实验报告">树莓派小车实验报告</h1><h1 id="小车构造及环境配置">1 小车构造及环境配置</h1><h2 id="硬件搭建">1.1 硬件搭建</h2><ul><li><p>树莓派3B<img src="/2023/03/26/shi-yan-shu-mei-pai-xiao-che/SouthEast.jpeg" alt="树莓派3B"></p></li><li><p>两个PWM电机</p></li><li><p>两个红外传感器</p></li><li><p>一个超声波传感器<img src="/2023/03/26/shi-yan-shu-mei-pai-xiao-che/fba61a68b5c066f85e5a17dcae8801f.jpg" alt="超声波传感器" style="zoom: 50%;"></p></li><li><p>一个单目摄像头</p></li></ul><p><img src="/2023/03/26/shi-yan-shu-mei-pai-xiao-che/0a7848d982352de986272a4d1fec448.jpg" alt="智能车整体布局" style="zoom:50%;"></p><h2 id="系统烧录">1.2 系统烧录</h2><ol type="1"><li>使用<code>树莓派镜像烧录器</code><img src="/2023/03/26/shi-yan-shu-mei-pai-xiao-che/image-20230315200903019.png" alt="树莓派镜像烧录器"></li></ol><p><code>下载直达        https://downloads.raspberrypi.org/imager/imager_latest.exe</code></p><blockquote><p>​ 优点：</p><ol type="1"><li>可以直接在设置中配置网络环境</li><li>可以选择多种操作系统</li></ol></blockquote><ul><li><p>操作步骤：</p><ul><li><p>下载镜像https://downloads.raspberrypi.org/raspios_arm64/images/raspios_arm64-2022-09-26/2022-09-22-raspios-bullseye-arm64.img.xz</p></li><li><p>选择自定义镜像<img src="/2023/03/26/shi-yan-shu-mei-pai-xiao-che/image-20230315201408177.png" alt="选择自定义镜像"></p></li><li><p>设置ssh和wifi</p></li></ul></li></ul><h2 id="raspberry-pi环境搭配">1.3 raspberry PI环境搭配</h2><ol type="1"><li><p>首先对树莓派进行换源</p><div class="sourceCode" id="cb1"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>* pi@raspberrypi:~ $ sudo nano /etc/apt/sources.<span class="fu">list</span></span><span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span><span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  deb https://mirror.<span class="fu">nju</span>.<span class="fu">edu</span>.<span class="fu">cn</span>/debian/ bullseye main contrib non-free</span><span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  deb https://mirror.<span class="fu">nju</span>.<span class="fu">edu</span>.<span class="fu">cn</span>/debian-security/ bullseye-security main contrib non-free</span><span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  deb https://mirror.<span class="fu">nju</span>.<span class="fu">edu</span>.<span class="fu">cn</span>/debian bullseye-updates main contrib non-free</span><span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span><span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>* pi@raspberrypi:~ $ sudo nano /etc/apt/sources.<span class="fu">list</span>.<span class="fu">d</span>/raspi.<span class="fu">list</span></span><span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span><span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  deb https://mirror.<span class="fu">nju</span>.<span class="fu">edu</span>.<span class="fu">cn</span>/raspberrypi/debian/ bullseye main</span></code></pre></div></li><li><p>更新</p><div class="sourceCode" id="cb2"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>sudo apt-get update</span><span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>sudo apt-get upgrade</span></code></pre></div></li><li><p>安装OPENCV</p><div class="sourceCode" id="cb3"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>sudo apt-get install python3-opencv</span></code></pre></div></li><li><p>配置摄像头选项</p><div class="sourceCode" id="cb4"><pre class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sudo raspi-config</span></code></pre></div><p>找到Interface Options --&gt; Camera --&gt;打开摄像头YES</p><p>（可以在终端中查看device0是否存在）</p></li></ol><h2 id="pc端配置">1.4 PC端配置</h2><ol type="1"><li>VS code连接Raspberry Pi<img src="/2023/03/26/shi-yan-shu-mei-pai-xiao-che/image-20230315204212709.png" alt="VS code连接Raspberry Pi"></li></ol><p>​ 配置SSH文件</p><pre><code>#Read more about SSH config files: https://linux.die.net/man/5/ssh_configHost copy                               # PC名称，随便起    HostName 192.168.43.162             # 树莓派地址，可以使用IP Scanner查看    User pi                             # 树莓派名称，在烧录SD卡的时候配置    Port 22                             # 默认22</code></pre><p><em>几点注意事项</em>:</p><blockquote><blockquote><p>HostName可以使用IP Scanner，如果是连接安卓手机可以通过手机热点直接查看，苹果手机不管是IP Scanner还是手机热点都看不了</p></blockquote><blockquote><p>改这个SSH会造成连不上GitHub的情况，如果想要重新连接GitHub，必须将上面注释，该车下面</p><pre><code>Host github.comHostname ssh.github.comPort 443</code></pre></blockquote></blockquote><ol start="2" type="1"><li><p>下载VNC Viewer</p><p><img src="/2023/03/26/shi-yan-shu-mei-pai-xiao-che/image-20230315204919059.png" alt="VNC Viewer" style="zoom: 50%;"></p><p>连接方式也是通过SSH连接到小车地址</p></li></ol><h2 id="引脚分配">1.5 引脚分配</h2><figure><img src="/2023/03/26/shi-yan-shu-mei-pai-xiao-che/SouthEast-1678884715942-5.png" alt="树莓派引脚"><figcaption aria-hidden="true">树莓派引脚</figcaption></figure><div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置gpio口为BOARD编号规范</span></span><span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>gpio.setmode(gpio.BOARD)</span><span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span><span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义引脚</span></span><span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   电机</span></span><span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>pin1 <span class="op">=</span> <span class="dv">12</span>  <span class="co"># 左正</span></span><span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>pin2 <span class="op">=</span> <span class="dv">16</span>  <span class="co"># 左反</span></span><span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>pin3 <span class="op">=</span> <span class="dv">18</span>  <span class="co"># 右正</span></span><span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>pin4 <span class="op">=</span> <span class="dv">22</span>  <span class="co"># 右反</span></span><span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>ENA <span class="op">=</span> <span class="dv">38</span>   <span class="co"># 左边电机使能</span></span><span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>ENB <span class="op">=</span> <span class="dv">40</span>   <span class="co"># 右边电机使能</span></span><span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   超声波</span></span><span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>TRIG <span class="op">=</span> <span class="dv">13</span>  <span class="co"># send-pin</span></span><span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>ECHO <span class="op">=</span> <span class="dv">15</span>  <span class="co"># receive-pin</span></span><span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   红外线</span></span><span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>GPIO_Infrared_left <span class="op">=</span> <span class="dv">29</span>     <span class="co"># 左边红外线</span></span><span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>GPIO_Infrared_right <span class="op">=</span> <span class="dv">31</span>    <span class="co"># 右边红外线</span></span></code></pre></div><h1 id="八字循迹">2 八字循迹</h1><h2 id="电机控制">1.1 电机控制</h2><div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> car_forward():  <span class="co"># 定义前进函数</span></span><span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin1, gpio.HIGH)  <span class="co"># 将pin1接口设置为高电压</span></span><span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin2, gpio.LOW)  <span class="co"># 将pin2接口设置为低电压</span></span><span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin3, gpio.HIGH)  <span class="co"># 将pin3接口设置为高电压</span></span><span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin4, gpio.LOW)  <span class="co"># 将pin4接口设置为低电压</span></span><span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span><span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span><span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> car_back():  <span class="co"># 定义后退函数</span></span><span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin1, gpio.LOW)</span><span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin2, gpio.HIGH)</span><span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin3, gpio.LOW)</span><span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin4, gpio.HIGH)</span><span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span><span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span><span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> car_left():  <span class="co"># 定义左转函数</span></span><span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin1, gpio.LOW)</span><span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin2, gpio.HIGH)</span><span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin3, gpio.HIGH)</span><span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin4, gpio.LOW)</span><span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span><span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span><span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> car_right():  <span class="co"># 定义右转函数</span></span><span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin1, gpio.HIGH)</span><span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin2, gpio.LOW)</span><span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin3, gpio.LOW)</span><span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin4, gpio.HIGH)</span><span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span><span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span><span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> car_stop():  <span class="co"># 定义停止函数</span></span><span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin1, gpio.LOW)</span><span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin2, gpio.LOW)</span><span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin3, gpio.LOW)</span><span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin4, gpio.LOW)</span></code></pre></div><h2 id="图像捕捉与处理">1.2 图像捕捉与处理</h2><h3 id="摄像头处理">1.2.1 摄像头处理</h3><div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 打开摄像头，图像尺寸640*480（长*高）</span></span><span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>cap <span class="op">=</span> cv2.VideoCapture(<span class="dv">0</span>)</span><span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置捕捉到的图像为480*640</span></span><span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>cap.<span class="bu">set</span>(<span class="dv">3</span>, <span class="dv">640</span>)</span><span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>cap.<span class="bu">set</span>(<span class="dv">4</span>, <span class="dv">480</span>)</span></code></pre></div><h3 id="图像处理">1.2.2 图像处理</h3><div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span><span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2</span><span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span><span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span><span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>cap <span class="op">=</span> cv2.VideoCapture(<span class="dv">0</span>)</span><span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>cap.<span class="bu">set</span>(<span class="dv">3</span>, <span class="dv">640</span>)</span><span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>cap.<span class="bu">set</span>(<span class="dv">4</span>, <span class="dv">480</span>)</span><span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="dv">1</span>):</span><span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    ret, frame <span class="op">=</span> cap.read()</span><span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    cv2.imshow(<span class="st">&#39;frame&#39;</span>, dst)  <span class="co"># 展示每一帧</span></span><span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 转化为灰度图</span></span><span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    gray <span class="op">=</span> cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)</span><span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    cv2.imshow(<span class="st">&#39;gray&#39;</span>, gray)  <span class="co"># 展示灰度图</span></span><span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 大津法二值化</span></span><span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    retval, dst <span class="op">=</span> cv2.threshold(gray, <span class="dv">100</span>, <span class="dv">255</span>, cv2.THRESH_OTSU)</span><span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 膨胀，白区域变大</span></span><span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    dst <span class="op">=</span> cv2.dilate(dst, <span class="va">None</span>, iterations<span class="op">=</span><span class="dv">2</span>)</span><span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    cv2.imshow(<span class="st">&#39;dilate_frame&#39;</span>, dst)  <span class="co"># 展示每一帧</span></span><span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 腐蚀，白区域变小</span></span><span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    dst <span class="op">=</span> cv2.erode(dst, <span class="va">None</span>, iterations<span class="op">=</span><span class="dv">6</span>)</span><span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    cv2.imshow(<span class="st">&#39;erode_frame&#39;</span>, dst)  <span class="co"># 展示每一帧</span></span><span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 找到连续白色像素点最宽的那条</span></span><span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> cv2.waitKey(<span class="dv">1</span>) <span class="op">&amp;</span> <span class="bn">0xFF</span> <span class="op">==</span> <span class="bu">ord</span>(<span class="st">&#39;q&#39;</span>):</span><span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span><span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span><span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 释放清理</span></span><span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>cap.release()</span><span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>cv2.destroyAllWindows()</span></code></pre></div><p><strong>代码讲解</strong></p><blockquote><div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ret, frame <span class="op">=</span> cap.read()</span><span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>cv2.imshow(<span class="st">&#39;frame&#39;</span>, dst)</span></code></pre></div><p><img src="/2023/03/26/shi-yan-shu-mei-pai-xiao-che/image-20230315210904186.png" alt="原图" style="zoom:67%;"></p></blockquote><blockquote><div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>gray <span class="op">=</span> cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)</span><span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>cv2.imshow(<span class="st">&#39;gray&#39;</span>, gray)  <span class="co"># 展示灰度图</span></span></code></pre></div><p><img src="/2023/03/26/shi-yan-shu-mei-pai-xiao-che/image-20230315210926583.png" alt="灰度图" style="zoom:67%;"></p></blockquote><blockquote><p>这里我们先是将图像进行二值化</p><p><code>retval, dst = cv2.threshold(gray, 100, 255, cv2.THRESH_OTSU)</code></p><p>这个阈值取决于环境</p></blockquote><blockquote><div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 膨胀，白区域变大</span></span><span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>dst <span class="op">=</span> cv2.dilate(dst, <span class="va">None</span>, iterations<span class="op">=</span><span class="dv">2</span>)</span><span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>cv2.imshow(<span class="st">&#39;dilate_frame&#39;</span>, dst)  <span class="co"># 展示每一帧</span></span></code></pre></div><p><img src="/2023/03/26/shi-yan-shu-mei-pai-xiao-che/image-20230315210942782.png" alt="膨胀" style="zoom:67%;"></p><p>如果只对图像进行膨胀则在边界处提取不够明显！！</p></blockquote><blockquote><div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 腐蚀，白区域变小</span></span><span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>dst <span class="op">=</span> cv2.erode(dst, <span class="va">None</span>, iterations<span class="op">=</span><span class="dv">6</span>)</span><span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>cv2.imshow(<span class="st">&#39;erode_frame&#39;</span>, dst)  <span class="co"># 展示每一帧</span></span></code></pre></div><p><img src="/2023/03/26/shi-yan-shu-mei-pai-xiao-che/image-20230315211212675.png" alt="腐蚀" style="zoom:67%;"></p><p>如果只对图像进行腐蚀则图像特征不明显！！！</p></blockquote><blockquote><div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 膨胀，白区域变大</span></span><span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>dst <span class="op">=</span> cv2.dilate(dst, <span class="va">None</span>, iterations<span class="op">=</span><span class="dv">2</span>)</span><span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>cv2.imshow(<span class="st">&#39;dilate_frame&#39;</span>, dst)  <span class="co"># 展示每一帧</span></span><span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 腐蚀，白区域变小</span></span><span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>dst <span class="op">=</span> cv2.erode(dst, <span class="va">None</span>, iterations<span class="op">=</span><span class="dv">6</span>)</span><span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>cv2.imshow(<span class="st">&#39;erode_frame&#39;</span>, dst)  <span class="co"># 展示每一帧</span></span></code></pre></div><p><img src="/2023/03/26/shi-yan-shu-mei-pai-xiao-che/image-20230315211011733.png" alt="最终结果" style="zoom:67%;"></p></blockquote><h3 id="结果展示">1.2.3 结果展示</h3><p>此处推荐先对图像进行高斯滤波</p><figure><img src="/2023/03/26/shi-yan-shu-mei-pai-xiao-che/image-20230315212550264.png" alt="结果展示"><figcaption aria-hidden="true">结果展示</figcaption></figure><h2 id="循迹策略">1.3 循迹策略</h2><p>寻找第400行像素，找到最长的一段白色像素集合作为赛道，寻找赛道中点与320作为比较进行左右判断</p><div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 单看第400行的像素值</span></span><span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># print(dst.shape)</span></span><span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>color <span class="op">=</span> dst[<span class="dv">400</span>]</span><span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 找到连续白色像素点最宽的那条</span></span><span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>road_set <span class="op">=</span> []</span><span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>road_set_length <span class="op">=</span> []</span><span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>road <span class="op">=</span> []</span><span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(color)):</span><span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="op">==</span> <span class="dv">639</span>):</span><span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        road_set.append(road)</span><span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        road_set_length.append(<span class="bu">len</span>(road))</span><span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span><span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> color[i] <span class="op">==</span> <span class="dv">255</span> <span class="kw">and</span> color[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">==</span> <span class="dv">255</span>:</span><span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        road.append(i)</span><span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> (<span class="bu">len</span>(road) <span class="op">&gt;</span> <span class="dv">20</span> <span class="kw">and</span> color[i <span class="op">+</span> <span class="dv">1</span>] <span class="op">!=</span> <span class="dv">255</span>):</span><span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>        road_set.append(road)</span><span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>        road_set_length.append(<span class="bu">len</span>(road))</span><span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        road <span class="op">=</span> []</span><span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="bu">len</span>(road_set_length) <span class="op">==</span> <span class="dv">0</span>):</span><span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    center <span class="op">=</span> <span class="dv">320</span></span><span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> (<span class="bu">len</span>(road) <span class="op">==</span> <span class="dv">0</span>):</span><span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>    center <span class="op">=</span> <span class="dv">320</span></span><span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span><span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    index_ <span class="op">=</span> road_set_length.index(<span class="bu">max</span>(road_set_length))</span><span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    road <span class="op">=</span> road_set[index_]</span><span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    center <span class="op">=</span> (<span class="bu">min</span>(road) <span class="op">+</span> <span class="bu">max</span>(road)) <span class="op">/</span> <span class="dv">2</span></span><span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算出center与标准中心点的偏移量</span></span><span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 如果为正，应该左转</span></span><span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>direction <span class="op">=</span> center <span class="op">-</span> <span class="dv">320</span></span><span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a></span><span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(direction)</span><span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a></span><span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>threshold <span class="op">=</span> <span class="dv">90</span>                  <span class="co">#右转阈值</span></span><span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>threshold_neg <span class="op">=</span> <span class="op">-</span><span class="dv">40</span>             <span class="co">#左转阈值</span></span><span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">abs</span>(direction) <span class="op">&gt;=</span> threshold:</span><span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 右转</span></span><span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> direction <span class="op">&gt;</span> threshold:</span><span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>        car_forward()</span><span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>        pwm1.ChangeDutyCycle(<span class="dv">25</span> <span class="op">+</span> direction <span class="op">/</span> <span class="dv">18</span>)</span><span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>        pwm2.ChangeDutyCycle(<span class="dv">0</span>)</span><span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(direction<span class="op">&gt;</span><span class="dv">120</span> <span class="kw">and</span> direction <span class="op">&lt;</span><span class="dv">150</span>):</span><span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="fl">0.3</span>)</span><span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span>(direction <span class="op">&gt;=</span> <span class="dv">150</span>):</span><span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="fl">0.5</span>)</span><span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 左转</span></span><span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> direction <span class="op">&lt;</span> threshold_neg:</span><span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>        car_forward()</span><span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>        pwm1.ChangeDutyCycle(<span class="dv">0</span>)</span><span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>        pwm2.ChangeDutyCycle(<span class="dv">25</span> <span class="op">+</span> <span class="bu">abs</span>(direction) <span class="op">/</span> <span class="dv">12</span>)</span><span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="bu">abs</span>(direction)<span class="op">&gt;</span><span class="dv">120</span> <span class="kw">and</span> <span class="bu">abs</span>(direction)<span class="op">&lt;</span><span class="dv">150</span>):</span><span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="fl">0.3</span>)</span><span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span>(<span class="bu">abs</span>(direction)<span class="op">&gt;=</span><span class="dv">150</span>):</span><span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="fl">0.5</span>)</span><span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a></span><span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span><span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>    car_forward()</span><span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>    pwm1.ChangeDutyCycle(<span class="dv">20</span>)</span><span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>    pwm2.ChangeDutyCycle(<span class="dv">20</span>)</span></code></pre></div><h2 id="结果展示-1">1.4 结果展示</h2><video src="https://copy2000.github.io/medias/vedio/%E5%85%AB%E5%AD%97.mp4" controls="controls" style="max-width: 100%; display: block; margin-left: auto; margin-right: auto;">your browser does not support the video tag</video><h1 id="乒乓球跟踪">3 乒乓球跟踪</h1><h2 id="图像处理-1">1.1 图像处理</h2><div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2</span><span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span><span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.cnblogs.com/bjxqmy/p/12333022.html</span></span><span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># https://blog.csdn.net/weixin_44237705/article/details/109021812</span></span><span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> RPi.GPIO <span class="im">as</span> gpio</span><span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span><span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义引脚</span></span><span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>pin1 <span class="op">=</span> <span class="dv">12</span>  <span class="co"># 左正</span></span><span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>pin2 <span class="op">=</span> <span class="dv">16</span>  <span class="co"># 左反</span></span><span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>pin3 <span class="op">=</span> <span class="dv">18</span>  <span class="co"># 右正</span></span><span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>pin4 <span class="op">=</span> <span class="dv">22</span>  <span class="co"># 右反</span></span><span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>ENA <span class="op">=</span> <span class="dv">38</span></span><span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>ENB <span class="op">=</span> <span class="dv">40</span></span><span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置gpio口为BOARD编号规范</span></span><span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>gpio.setmode(gpio.BOARD)</span><span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置gpio口为输出</span></span><span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>gpio.setup(pin1, gpio.OUT)</span><span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>gpio.setup(pin2, gpio.OUT)</span><span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>gpio.setup(pin3, gpio.OUT)</span><span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>gpio.setup(pin4, gpio.OUT)</span><span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>gpio.setup(ENA, gpio.OUT)</span><span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>gpio.setup(ENB, gpio.OUT)</span><span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置PWM波,频率为500Hz</span></span><span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>pwm1 <span class="op">=</span> gpio.PWM(ENA, <span class="dv">50</span>)</span><span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>pwm2 <span class="op">=</span> gpio.PWM(ENB, <span class="dv">50</span>)</span><span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>pwm1.start(<span class="dv">0</span>)</span><span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>pwm2.start(<span class="dv">0</span>)</span><span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> car_forward():  <span class="co"># 定义前进函数</span></span><span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin1, gpio.HIGH)  <span class="co"># 将pin1接口设置为高电压</span></span><span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin2, gpio.LOW)  <span class="co"># 将pin2接口设置为低电压</span></span><span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin3, gpio.HIGH)  <span class="co"># 将pin3接口设置为高电压</span></span><span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin4, gpio.LOW)  <span class="co"># 将pin4接口设置为低电压</span></span><span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> car_back():  <span class="co"># 定义后退函数</span></span><span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin1, gpio.LOW)</span><span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin2, gpio.HIGH)</span><span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin3, gpio.LOW)</span><span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin4, gpio.HIGH)</span><span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> car_left():  <span class="co"># 定义左转函数</span></span><span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin1, gpio.LOW)</span><span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin2, gpio.HIGH)</span><span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin3, gpio.HIGH)</span><span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin4, gpio.LOW)</span><span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> car_right():  <span class="co"># 定义右转函数</span></span><span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin1, gpio.HIGH)</span><span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin2, gpio.LOW)</span><span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin3, gpio.LOW)</span><span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin4, gpio.HIGH)</span><span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> car_stop():  <span class="co"># 定义停止函数</span></span><span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin1, gpio.LOW)</span><span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin2, gpio.LOW)</span><span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin3, gpio.LOW)</span><span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin4, gpio.LOW)</span><span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> empty(a):</span><span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span><span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> draw_direction(img, lx, ly, nx, ny):</span><span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>    dx <span class="op">=</span> nx <span class="op">-</span> lx</span><span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>    dy <span class="op">=</span> ny <span class="op">-</span> ly</span><span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">abs</span>(dx) <span class="op">&lt;</span> <span class="dv">4</span> <span class="kw">and</span> <span class="bu">abs</span>(dy) <span class="op">&lt;</span> <span class="dv">4</span>:</span><span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>        dx <span class="op">=</span> <span class="dv">0</span></span><span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>        dy <span class="op">=</span> <span class="dv">0</span></span><span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span><span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> (dx <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> dy <span class="op">**</span> <span class="dv">2</span>) <span class="op">**</span> <span class="fl">0.5</span></span><span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>        dx <span class="op">=</span> <span class="bu">int</span>(dx <span class="op">/</span> r <span class="op">*</span> <span class="dv">40</span>)</span><span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>        dy <span class="op">=</span> <span class="bu">int</span>(dy <span class="op">/</span> r <span class="op">*</span> <span class="dv">40</span>)</span><span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(dx, dy)</span></span><span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a>    cv2.arrowedLine(img, (<span class="dv">60</span>, <span class="dv">100</span>), (<span class="dv">60</span> <span class="op">+</span> dx, <span class="dv">100</span> <span class="op">+</span> dy), (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>), <span class="dv">2</span>)</span><span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(nx-lx, ny-ly)   # 噪声一般为+-1</span></span><span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cv2.arrowedLine(img, (150, 150), (150+(nx-lx), 150+(ny-ly)), (0, 0, 255), 2, 0, 0, 0.2)</span></span><span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Hough_circle(imgGray, canvas):</span><span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 基于霍夫圆检测找圆，包含了必要的模糊步骤</span></span><span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 在imgGray中查找圆，在canvas中绘制结果</span></span><span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a>    <span class="co"># canvas必须是shape为[x, y, 3]的图片</span></span><span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> Hough_x, Hough_y</span><span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>    img <span class="op">=</span> cv2.medianBlur(imgGray, <span class="dv">3</span>)</span><span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>    img <span class="op">=</span> cv2.GaussianBlur(img, (<span class="dv">17</span>, <span class="dv">19</span>), <span class="dv">0</span>)</span><span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cv2.imshow(&quot;Blur&quot;, img)</span></span><span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cv2.waitKey(30)</span></span><span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>    circles <span class="op">=</span> cv2.HoughCircles(img, cv2.HOUGH_GRADIENT, <span class="dv">1</span>, <span class="dv">200</span>,</span><span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a>                               param1<span class="op">=</span><span class="dv">20</span>, param2<span class="op">=</span><span class="dv">50</span>, minRadius<span class="op">=</span><span class="dv">30</span>, maxRadius<span class="op">=</span><span class="dv">70</span>)</span><span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span><span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a>        <span class="co"># try语法保证在找到圆的前提下才进行绘制</span></span><span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>        circles <span class="op">=</span> np.uint16(np.around(circles))</span><span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(&quot;circ:&quot;,circles)</span></span><span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 经测试，circles为：[[[c0_x, c0_y, c0_r], [c1_x, c1_y, c1_r], ...]]</span></span><span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 所以for i in circles[0, :]:中的i为每一个圆的xy坐标和半径</span></span><span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span><span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span><span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span><span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> circles[<span class="dv">0</span>, :]:</span><span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a>            <span class="co"># draw the outer circle</span></span><span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a>            cv2.circle(canvas, (i[<span class="dv">0</span>], i[<span class="dv">1</span>]), i[<span class="dv">2</span>], (<span class="dv">255</span>, <span class="dv">100</span>, <span class="dv">0</span>), <span class="dv">2</span>)</span><span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>            <span class="co"># draw the center of the circle</span></span><span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a>            cv2.circle(canvas, (i[<span class="dv">0</span>], i[<span class="dv">1</span>]), <span class="dv">2</span>, (<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">255</span>), <span class="dv">3</span>)</span><span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a>            Hough_x <span class="op">=</span> i[<span class="dv">0</span>]</span><span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a>            Hough_y <span class="op">=</span> i[<span class="dv">1</span>]</span><span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a>frameWidth <span class="op">=</span> <span class="dv">640</span></span><span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a>frameHeight <span class="op">=</span> <span class="dv">480</span></span><span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a>cap <span class="op">=</span> cv2.VideoCapture(<span class="dv">0</span>)  <span class="co"># 0对应笔记本自带摄像头</span></span><span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a>cap.<span class="bu">set</span>(<span class="dv">3</span>, frameWidth)  <span class="co"># set中，这里的3，下面的4和10是类似于功能号的东西，数字的值没有实际意义</span></span><span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a>cap.<span class="bu">set</span>(<span class="dv">4</span>, frameHeight)</span><span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a>cap.<span class="bu">set</span>(<span class="dv">10</span>, <span class="dv">80</span>)  <span class="co"># 设置亮度</span></span><span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a>pulse_ms <span class="op">=</span> <span class="dv">30</span></span><span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a>standard_area <span class="op">=</span> <span class="dv">7000</span>  <span class="co"># 设置乒乓球的标准大小，如果area大于这个值就要退后，如果小于这个值就前进</span></span><span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a><span class="co"># 调试用代码，用来产生控制滑条</span></span><span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a><span class="co"># cv2.namedWindow(&quot;HSV&quot;)</span></span><span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a><span class="co"># cv2.resizeWindow(&quot;HSV&quot;, 640, 300)</span></span><span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a><span class="co"># cv2.createTrackbar(&quot;HUE Min&quot;, &quot;HSV&quot;, 4, 179, empty)</span></span><span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a><span class="co"># cv2.createTrackbar(&quot;SAT Min&quot;, &quot;HSV&quot;, 180, 255, empty)</span></span><span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a><span class="co"># cv2.createTrackbar(&quot;VALUE Min&quot;, &quot;HSV&quot;, 156, 255, empty)</span></span><span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a><span class="co"># cv2.createTrackbar(&quot;HUE Max&quot;, &quot;HSV&quot;, 32, 179, empty)</span></span><span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a><span class="co"># cv2.createTrackbar(&quot;SAT Max&quot;, &quot;HSV&quot;, 255, 255, empty)</span></span><span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a><span class="co"># cv2.createTrackbar(&quot;VALUE Max&quot;, &quot;HSV&quot;, 255, 255, empty)</span></span><span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a>lower <span class="op">=</span> np.array([<span class="dv">4</span>, <span class="dv">180</span>, <span class="dv">156</span>])  <span class="co"># 适用于橙色乒乓球4&lt;=h&lt;=32</span></span><span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a>upper <span class="op">=</span> np.array([<span class="dv">32</span>, <span class="dv">255</span>, <span class="dv">255</span>])</span><span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a>targetPos_x <span class="op">=</span> <span class="dv">0</span>  <span class="co"># 颜色检测得到的x坐标</span></span><span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a>targetPos_y <span class="op">=</span> <span class="dv">0</span>  <span class="co"># 颜色检测得到的y坐标</span></span><span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a>lastPos_x <span class="op">=</span> <span class="dv">0</span>  <span class="co"># 上一帧图像颜色检测得到的x坐标</span></span><span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a>lastPos_y <span class="op">=</span> <span class="dv">0</span>  <span class="co"># 上一帧图像颜色检测得到的y坐标</span></span><span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a>lastarea <span class="op">=</span> <span class="dv">0</span></span><span id="cb17-145"><a href="#cb17-145" aria-hidden="true" tabindex="-1"></a>Hough_x <span class="op">=</span> <span class="dv">0</span>  <span class="co"># 霍夫圆检测得到的x坐标</span></span><span id="cb17-146"><a href="#cb17-146" aria-hidden="true" tabindex="-1"></a>Hough_y <span class="op">=</span> <span class="dv">0</span>  <span class="co"># 霍夫圆检测得到的y坐标</span></span><span id="cb17-147"><a href="#cb17-147" aria-hidden="true" tabindex="-1"></a><span class="co"># ColorXs = []        # 这些是用来存储x，y坐标的列表，便于后期写入文件</span></span><span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a><span class="co"># ColorYs = []</span></span><span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a><span class="co"># HoughXs = []</span></span><span id="cb17-150"><a href="#cb17-150" aria-hidden="true" tabindex="-1"></a><span class="co"># HoughYs = []</span></span><span id="cb17-151"><a href="#cb17-151" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-152"><a href="#cb17-152" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="va">True</span>:</span><span id="cb17-153"><a href="#cb17-153" aria-hidden="true" tabindex="-1"></a>    _, img <span class="op">=</span> cap.read()</span><span id="cb17-154"><a href="#cb17-154" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-155"><a href="#cb17-155" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 霍夫圆检测前的处理Start</span></span><span id="cb17-156"><a href="#cb17-156" aria-hidden="true" tabindex="-1"></a>    b, g, r <span class="op">=</span> cv2.split(img)  <span class="co"># 分离三个颜色</span></span><span id="cb17-157"><a href="#cb17-157" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> np.int16(r)  <span class="co"># 将红色与蓝色转换为int16，为了后期做差</span></span><span id="cb17-158"><a href="#cb17-158" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> np.int16(b)</span><span id="cb17-159"><a href="#cb17-159" aria-hidden="true" tabindex="-1"></a>    r_minus_b <span class="op">=</span> r <span class="op">-</span> b  <span class="co"># 红色通道减去蓝色通道，得到r_minus_b</span></span><span id="cb17-160"><a href="#cb17-160" aria-hidden="true" tabindex="-1"></a>    r_minus_b <span class="op">=</span> (r_minus_b <span class="op">+</span> <span class="bu">abs</span>(r_minus_b)) <span class="op">/</span> <span class="dv">2</span>  <span class="co"># r_minus_b中小于0的全部转换为0</span></span><span id="cb17-161"><a href="#cb17-161" aria-hidden="true" tabindex="-1"></a>    r_minus_b <span class="op">=</span> np.uint8(r_minus_b)  <span class="co"># 将数据类型转换回uint8</span></span><span id="cb17-162"><a href="#cb17-162" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 霍夫圆检测前的处理End</span></span><span id="cb17-163"><a href="#cb17-163" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-164"><a href="#cb17-164" aria-hidden="true" tabindex="-1"></a>    imgHough <span class="op">=</span> img.copy()  <span class="co"># 用于绘制识别结果和输出</span></span><span id="cb17-165"><a href="#cb17-165" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-166"><a href="#cb17-166" aria-hidden="true" tabindex="-1"></a>    imgHsv <span class="op">=</span> cv2.cvtColor(img, cv2.COLOR_BGR2HSV)</span><span id="cb17-167"><a href="#cb17-167" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-168"><a href="#cb17-168" aria-hidden="true" tabindex="-1"></a>    imgMask <span class="op">=</span> cv2.inRange(imgHsv, lower, upper)  <span class="co"># 获取遮罩</span></span><span id="cb17-169"><a href="#cb17-169" aria-hidden="true" tabindex="-1"></a>    imgOutput <span class="op">=</span> cv2.bitwise_and(img, img, mask<span class="op">=</span>imgMask)</span><span id="cb17-170"><a href="#cb17-170" aria-hidden="true" tabindex="-1"></a>    contours, hierarchy <span class="op">=</span> cv2.findContours(imgMask, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_NONE)  <span class="co"># 查找轮廓</span></span><span id="cb17-171"><a href="#cb17-171" aria-hidden="true" tabindex="-1"></a>    <span class="co"># https://blog.csdn.net/laobai1015/article/details/76400725</span></span><span id="cb17-172"><a href="#cb17-172" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CV_RETR_EXTERNAL 只检测最外围轮廓 RETE_FREE</span></span><span id="cb17-173"><a href="#cb17-173" aria-hidden="true" tabindex="-1"></a>    <span class="co"># CV_CHAIN_APPROX_NONE 保存物体边界上所有连续的轮廓点到contours向量内 CHAIN_APPROX_SIMPLE</span></span><span id="cb17-174"><a href="#cb17-174" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(np.array(contours).shape)     #查看提取的轮廓数量</span></span><span id="cb17-175"><a href="#cb17-175" aria-hidden="true" tabindex="-1"></a>    imgMask <span class="op">=</span> cv2.cvtColor(imgMask, cv2.COLOR_GRAY2BGR)  <span class="co"># 转换后，后期才能够与原画面拼接，否则与原图维数不同</span></span><span id="cb17-176"><a href="#cb17-176" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-177"><a href="#cb17-177" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 下面的代码查找包围框，并绘制</span></span><span id="cb17-178"><a href="#cb17-178" aria-hidden="true" tabindex="-1"></a>    x, y, w, h <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span></span><span id="cb17-179"><a href="#cb17-179" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cnt <span class="kw">in</span> contours:</span><span id="cb17-180"><a href="#cb17-180" aria-hidden="true" tabindex="-1"></a>        area <span class="op">=</span> cv2.contourArea(cnt)</span><span id="cb17-181"><a href="#cb17-181" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> area <span class="op">&gt;</span> <span class="dv">300</span>:</span><span id="cb17-182"><a href="#cb17-182" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;area&quot;</span>, area)</span><span id="cb17-183"><a href="#cb17-183" aria-hidden="true" tabindex="-1"></a>            x, y, w, h <span class="op">=</span> cv2.boundingRect(cnt)</span><span id="cb17-184"><a href="#cb17-184" aria-hidden="true" tabindex="-1"></a>            lastarea <span class="op">=</span> area</span><span id="cb17-185"><a href="#cb17-185" aria-hidden="true" tabindex="-1"></a>            lastPos_x <span class="op">=</span> targetPos_x</span><span id="cb17-186"><a href="#cb17-186" aria-hidden="true" tabindex="-1"></a>            lastPos_y <span class="op">=</span> targetPos_y</span><span id="cb17-187"><a href="#cb17-187" aria-hidden="true" tabindex="-1"></a>            targetPos_x <span class="op">=</span> <span class="bu">int</span>(x <span class="op">+</span> w <span class="op">/</span> <span class="dv">2</span>)</span><span id="cb17-188"><a href="#cb17-188" aria-hidden="true" tabindex="-1"></a>            targetPos_y <span class="op">=</span> <span class="bu">int</span>(y <span class="op">+</span> h <span class="op">/</span> <span class="dv">2</span>)</span><span id="cb17-189"><a href="#cb17-189" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;&lt;targetPos_x,targetPos_y&quot;</span>, targetPos_x, targetPos_y)</span><span id="cb17-190"><a href="#cb17-190" aria-hidden="true" tabindex="-1"></a>            cv2.rectangle(img, (x, y), (x <span class="op">+</span> w, y <span class="op">+</span> h), (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>), <span class="dv">2</span>)</span><span id="cb17-191"><a href="#cb17-191" aria-hidden="true" tabindex="-1"></a>            cv2.circle(img, (targetPos_x, targetPos_y), <span class="dv">2</span>, (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>), <span class="dv">4</span>)</span><span id="cb17-192"><a href="#cb17-192" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-193"><a href="#cb17-193" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 坐标（图像内的）</span></span><span id="cb17-194"><a href="#cb17-194" aria-hidden="true" tabindex="-1"></a>    cv2.putText(img, <span class="st">&quot;(</span><span class="sc">&#123;:0&lt;2d&#125;</span><span class="st">, </span><span class="sc">&#123;:0&lt;2d&#125;</span><span class="st">)&quot;</span>.<span class="bu">format</span>(targetPos_x, targetPos_y), (<span class="dv">20</span>, <span class="dv">30</span>),</span><span id="cb17-195"><a href="#cb17-195" aria-hidden="true" tabindex="-1"></a>                cv2.FONT_HERSHEY_PLAIN, <span class="dv">1</span>, (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>), <span class="dv">2</span>)  <span class="co"># 文字</span></span><span id="cb17-196"><a href="#cb17-196" aria-hidden="true" tabindex="-1"></a>    draw_direction(img, lastPos_x, lastPos_y, targetPos_x, targetPos_y)</span><span id="cb17-197"><a href="#cb17-197" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-198"><a href="#cb17-198" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 霍夫圆检测Start</span></span><span id="cb17-199"><a href="#cb17-199" aria-hidden="true" tabindex="-1"></a>    Hough_circle(r_minus_b, imgHough)</span><span id="cb17-200"><a href="#cb17-200" aria-hidden="true" tabindex="-1"></a>    cv2.imshow(<span class="st">&quot;R_Minus_B&quot;</span>, r_minus_b)</span><span id="cb17-201"><a href="#cb17-201" aria-hidden="true" tabindex="-1"></a>    cv2.putText(imgHough, <span class="st">&quot;(</span><span class="sc">&#123;:0&lt;2d&#125;</span><span class="st">, </span><span class="sc">&#123;:0&lt;2d&#125;</span><span class="st">)&quot;</span>.<span class="bu">format</span>(Hough_x, Hough_y), (<span class="dv">20</span>, <span class="dv">30</span>),</span><span id="cb17-202"><a href="#cb17-202" aria-hidden="true" tabindex="-1"></a>                cv2.FONT_HERSHEY_PLAIN, <span class="dv">1</span>, (<span class="dv">255</span>, <span class="dv">100</span>, <span class="dv">0</span>), <span class="dv">2</span>)</span><span id="cb17-203"><a href="#cb17-203" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 霍夫圆检测End</span></span><span id="cb17-204"><a href="#cb17-204" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-205"><a href="#cb17-205" aria-hidden="true" tabindex="-1"></a>    imgStack <span class="op">=</span> np.hstack([img, imgHough])</span><span id="cb17-206"><a href="#cb17-206" aria-hidden="true" tabindex="-1"></a>    <span class="co"># imgStack = np.hstack([img, imgMask])            # 拼接</span></span><span id="cb17-207"><a href="#cb17-207" aria-hidden="true" tabindex="-1"></a>    cv2.imshow(<span class="st">&#39;Horizontal Stacking&#39;</span>, imgStack)  <span class="co"># 显示</span></span><span id="cb17-208"><a href="#cb17-208" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-209"><a href="#cb17-209" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ColorXs.append(targetPos_x)     # 坐标存入列表</span></span><span id="cb17-210"><a href="#cb17-210" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ColorYs.append(targetPos_y)</span></span><span id="cb17-211"><a href="#cb17-211" aria-hidden="true" tabindex="-1"></a>    <span class="co"># HoughXs.append(Hough_x)</span></span><span id="cb17-212"><a href="#cb17-212" aria-hidden="true" tabindex="-1"></a>    <span class="co"># HoughYs.append(Hough_y)</span></span><span id="cb17-213"><a href="#cb17-213" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-214"><a href="#cb17-214" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 让小车跟踪乒乓球</span></span><span id="cb17-215"><a href="#cb17-215" aria-hidden="true" tabindex="-1"></a>    x_delta <span class="op">=</span> targetPos_x <span class="op">-</span> <span class="dv">320</span></span><span id="cb17-216"><a href="#cb17-216" aria-hidden="true" tabindex="-1"></a>    y_delta <span class="op">=</span> targetPos_y <span class="op">-</span> <span class="dv">240</span></span><span id="cb17-217"><a href="#cb17-217" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 霍夫</span></span><span id="cb17-218"><a href="#cb17-218" aria-hidden="true" tabindex="-1"></a>    <span class="co"># x_delta = Hough_x - 320</span></span><span id="cb17-219"><a href="#cb17-219" aria-hidden="true" tabindex="-1"></a>    <span class="co"># y_delta = Hough_y - 240</span></span><span id="cb17-220"><a href="#cb17-220" aria-hidden="true" tabindex="-1"></a>    x_threshold <span class="op">=</span> <span class="dv">40</span></span><span id="cb17-221"><a href="#cb17-221" aria-hidden="true" tabindex="-1"></a>    y_threshold <span class="op">=</span> <span class="dv">30</span>  <span class="co"># 阈值 可修改</span></span><span id="cb17-222"><a href="#cb17-222" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-223"><a href="#cb17-223" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 先调整左右方向,再前进后退</span></span><span id="cb17-224"><a href="#cb17-224" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="bu">abs</span>(x_delta) <span class="op">&lt;=</span> x_threshold):</span><span id="cb17-225"><a href="#cb17-225" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 球在中间</span></span><span id="cb17-226"><a href="#cb17-226" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="bu">abs</span>(y_delta) <span class="op">&lt;=</span> y_threshold):</span><span id="cb17-227"><a href="#cb17-227" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 正中间</span></span><span id="cb17-228"><a href="#cb17-228" aria-hidden="true" tabindex="-1"></a>            car_stop()</span><span id="cb17-229"><a href="#cb17-229" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> (y_delta <span class="op">&lt;</span> y_threshold <span class="op">*</span> <span class="op">-</span><span class="dv">1</span>):</span><span id="cb17-230"><a href="#cb17-230" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 球在中上，前进</span></span><span id="cb17-231"><a href="#cb17-231" aria-hidden="true" tabindex="-1"></a>            car_forward()</span><span id="cb17-232"><a href="#cb17-232" aria-hidden="true" tabindex="-1"></a>            pwm1.ChangeDutyCycle(<span class="dv">25</span>)</span><span id="cb17-233"><a href="#cb17-233" aria-hidden="true" tabindex="-1"></a>            pwm2.ChangeDutyCycle(<span class="dv">25</span>)</span><span id="cb17-234"><a href="#cb17-234" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span><span id="cb17-235"><a href="#cb17-235" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 球在中下，后退</span></span><span id="cb17-236"><a href="#cb17-236" aria-hidden="true" tabindex="-1"></a>            car_back()</span><span id="cb17-237"><a href="#cb17-237" aria-hidden="true" tabindex="-1"></a>            pwm1.ChangeDutyCycle(<span class="dv">25</span>)</span><span id="cb17-238"><a href="#cb17-238" aria-hidden="true" tabindex="-1"></a>            pwm2.ChangeDutyCycle(<span class="dv">25</span>)</span><span id="cb17-239"><a href="#cb17-239" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-240"><a href="#cb17-240" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> (x_delta <span class="op">&lt;</span> x_threshold <span class="op">*</span> <span class="op">-</span><span class="dv">1</span>):</span><span id="cb17-241"><a href="#cb17-241" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 球在左边</span></span><span id="cb17-242"><a href="#cb17-242" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (y_delta <span class="op">&gt;</span> y_threshold):</span><span id="cb17-243"><a href="#cb17-243" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 球在左下，向右下方后退</span></span><span id="cb17-244"><a href="#cb17-244" aria-hidden="true" tabindex="-1"></a>            car_back()</span><span id="cb17-245"><a href="#cb17-245" aria-hidden="true" tabindex="-1"></a>            pwm1.ChangeDutyCycle(<span class="dv">20</span> <span class="op">+</span> <span class="bu">abs</span>(x_delta) <span class="op">/</span> <span class="dv">20</span>)</span><span id="cb17-246"><a href="#cb17-246" aria-hidden="true" tabindex="-1"></a>            pwm2.ChangeDutyCycle(<span class="dv">0</span>)</span><span id="cb17-247"><a href="#cb17-247" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span><span id="cb17-248"><a href="#cb17-248" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 球在左上、左中，向左上方前进</span></span><span id="cb17-249"><a href="#cb17-249" aria-hidden="true" tabindex="-1"></a>            car_forward()</span><span id="cb17-250"><a href="#cb17-250" aria-hidden="true" tabindex="-1"></a>            pwm1.ChangeDutyCycle(<span class="dv">0</span>)</span><span id="cb17-251"><a href="#cb17-251" aria-hidden="true" tabindex="-1"></a>            pwm2.ChangeDutyCycle(<span class="dv">20</span> <span class="op">+</span> <span class="bu">abs</span>(x_delta) <span class="op">/</span> <span class="dv">20</span>)</span><span id="cb17-252"><a href="#cb17-252" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span><span id="cb17-253"><a href="#cb17-253" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 球在右边</span></span><span id="cb17-254"><a href="#cb17-254" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (y_delta <span class="op">&gt;</span> y_threshold):</span><span id="cb17-255"><a href="#cb17-255" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 球在右下，向左下方后退</span></span><span id="cb17-256"><a href="#cb17-256" aria-hidden="true" tabindex="-1"></a>            car_back()</span><span id="cb17-257"><a href="#cb17-257" aria-hidden="true" tabindex="-1"></a>            pwm1.ChangeDutyCycle(<span class="dv">0</span>)</span><span id="cb17-258"><a href="#cb17-258" aria-hidden="true" tabindex="-1"></a>            pwm2.ChangeDutyCycle(<span class="dv">20</span> <span class="op">+</span> x_delta <span class="op">/</span> <span class="dv">20</span>)</span><span id="cb17-259"><a href="#cb17-259" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span><span id="cb17-260"><a href="#cb17-260" aria-hidden="true" tabindex="-1"></a>            <span class="co"># 球在右上、右中，向右上方前进</span></span><span id="cb17-261"><a href="#cb17-261" aria-hidden="true" tabindex="-1"></a>            car_forward()</span><span id="cb17-262"><a href="#cb17-262" aria-hidden="true" tabindex="-1"></a>            pwm1.ChangeDutyCycle(<span class="dv">20</span> <span class="op">+</span> x_delta <span class="op">/</span> <span class="dv">20</span>)</span><span id="cb17-263"><a href="#cb17-263" aria-hidden="true" tabindex="-1"></a>            pwm2.ChangeDutyCycle(<span class="dv">0</span>)</span><span id="cb17-264"><a href="#cb17-264" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-265"><a href="#cb17-265" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> cv2.waitKey(pulse_ms) <span class="op">&amp;</span> <span class="bn">0xFF</span> <span class="op">==</span> <span class="bu">ord</span>(<span class="st">&#39;q&#39;</span>):  <span class="co"># 按下“q”推出（英文输入法）</span></span><span id="cb17-266"><a href="#cb17-266" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Quit</span><span class="ch">\n</span><span class="st">&quot;</span>)</span><span id="cb17-267"><a href="#cb17-267" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span><span id="cb17-268"><a href="#cb17-268" aria-hidden="true" tabindex="-1"></a></span><span id="cb17-269"><a href="#cb17-269" aria-hidden="true" tabindex="-1"></a>cap.release()</span><span id="cb17-270"><a href="#cb17-270" aria-hidden="true" tabindex="-1"></a>cv2.destroyAllWindows()</span></code></pre></div><blockquote><p>将图像转换成HSV</p><figure><img src="/2023/03/26/shi-yan-shu-mei-pai-xiao-che/Snipaste_2023-03-15_21-47-12.png" alt="原图"><figcaption aria-hidden="true">原图</figcaption></figure><figure><img src="/2023/03/26/shi-yan-shu-mei-pai-xiao-che/Snipaste_2023-03-15_21-47-24.png" alt="HSV"><figcaption aria-hidden="true">HSV</figcaption></figure></blockquote><h2 id="图像结果">1.2 图像结果</h2><figure><img src="/2023/03/26/shi-yan-shu-mei-pai-xiao-che/image-20230315215329188.png" alt="结果1"><figcaption aria-hidden="true">结果1</figcaption></figure><figure><img src="/2023/03/26/shi-yan-shu-mei-pai-xiao-che/image-20230315215409367.png" alt="结果2"><figcaption aria-hidden="true">结果2</figcaption></figure><h2 id="结果分析">1.3 结果分析</h2><p>我们最终没有选择使用霍夫检测，因为霍夫检测虽然在不太明亮的环境下检测效果好，但是当检测物体运动之后，检测效果很差，而只用色差的方法寻找边缘，能够很快的反应，它的缺点只有受光线影响，光照越强，检测效果越好。</p><h1 id="红外避障">4 红外避障</h1><p>太简单了，就只放代码</p><div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> RPi.GPIO <span class="im">as</span> gpio</span><span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span><span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义引脚</span></span><span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>pin1 <span class="op">=</span> <span class="dv">12</span>  <span class="co"># 左正</span></span><span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>pin2 <span class="op">=</span> <span class="dv">16</span>  <span class="co"># 左反</span></span><span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>pin3 <span class="op">=</span> <span class="dv">18</span>  <span class="co"># 右正</span></span><span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>pin4 <span class="op">=</span> <span class="dv">22</span>  <span class="co"># 右反</span></span><span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>ENA <span class="op">=</span> <span class="dv">38</span></span><span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>ENB <span class="op">=</span> <span class="dv">40</span></span><span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>GPIO_Infrared_left <span class="op">=</span> <span class="dv">29</span></span><span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>GPIO_Infrared_right <span class="op">=</span> <span class="dv">31</span></span><span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>gpio.setwarnings(<span class="va">False</span>)</span><span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置gpio口为BOARD编号规范</span></span><span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>gpio.setmode(gpio.BOARD)</span><span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置gpio口为输出</span></span><span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>gpio.setup(pin1, gpio.OUT)</span><span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>gpio.setup(pin2, gpio.OUT)</span><span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>gpio.setup(pin3, gpio.OUT)</span><span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>gpio.setup(pin4, gpio.OUT)</span><span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>gpio.setup(ENA, gpio.OUT)</span><span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>gpio.setup(ENB, gpio.OUT)</span><span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>gpio.setup(GPIO_Infrared_left, gpio.IN)</span><span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>gpio.setup(GPIO_Infrared_right, gpio.IN)</span><span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置PWM波,频率为50Hz</span></span><span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>pwm1 <span class="op">=</span> gpio.PWM(ENA, <span class="dv">50</span>)</span><span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>pwm2 <span class="op">=</span> gpio.PWM(ENB, <span class="dv">50</span>)</span><span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>pwm1.start(<span class="dv">0</span>)</span><span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>pwm2.start(<span class="dv">0</span>)</span><span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> car_forward():  <span class="co"># 定义前进函数</span></span><span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin1, gpio.HIGH)  <span class="co"># 将pin1接口设置为高电压</span></span><span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin2, gpio.LOW)  <span class="co"># 将pin2接口设置为低电压</span></span><span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin3, gpio.HIGH)  <span class="co"># 将pin3接口设置为高电压</span></span><span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin4, gpio.LOW)  <span class="co"># 将pin4接口设置为低电压</span></span><span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> car_back():  <span class="co"># 定义后退函数</span></span><span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin1, gpio.LOW)</span><span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin2, gpio.HIGH)</span><span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin3, gpio.LOW)</span><span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin4, gpio.HIGH)</span><span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> car_left():  <span class="co"># 定义左转函数</span></span><span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin1, gpio.LOW)</span><span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin2, gpio.HIGH)</span><span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin3, gpio.HIGH)</span><span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin4, gpio.LOW)</span><span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> car_right():  <span class="co"># 定义右转函数</span></span><span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin1, gpio.HIGH)</span><span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin2, gpio.LOW)</span><span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin3, gpio.LOW)</span><span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin4, gpio.HIGH)</span><span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> car_stop():  <span class="co"># 定义停止函数</span></span><span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin1, gpio.LOW)</span><span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin2, gpio.LOW)</span><span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin3, gpio.LOW)</span><span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin4, gpio.LOW)</span><span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> InfraredMeasure():</span><span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>    left_measure <span class="op">=</span> gpio.<span class="bu">input</span>(GPIO_Infrared_left)  <span class="co"># if there is an obstacle, GPIO will become 0; else, GPIO_input = 1;</span></span><span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a>    right_measure <span class="op">=</span> gpio.<span class="bu">input</span>(GPIO_Infrared_right)</span><span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [left_measure, right_measure]</span><span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> avoidance(left,right):</span><span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(left<span class="op">==</span><span class="dv">0</span> <span class="kw">and</span> right <span class="op">!=</span><span class="dv">0</span> ):</span><span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>        car_back()</span><span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a>        pwm1.ChangeDutyCycle(<span class="dv">25</span>)</span><span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a>        pwm2.ChangeDutyCycle(<span class="dv">25</span>)</span><span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span><span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a>        car_right()</span><span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a>        pwm1.ChangeDutyCycle(<span class="dv">40</span>)</span><span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a>        pwm2.ChangeDutyCycle(<span class="dv">40</span>)</span><span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;detect obstacles in the left!&quot;</span>)</span><span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span><span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span>(left<span class="op">==</span><span class="dv">0</span> <span class="kw">and</span> right <span class="op">==</span><span class="dv">0</span>):</span><span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a>        car_back()</span><span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a>        pwm1.ChangeDutyCycle(<span class="dv">40</span>)</span><span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a>        pwm2.ChangeDutyCycle(<span class="dv">40</span>)</span><span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;detect obstacles in the left and right!&quot;</span>)</span><span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span><span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span>(left <span class="op">==</span> <span class="dv">1</span> <span class="kw">and</span> right <span class="op">==</span><span class="dv">0</span>):</span><span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a>        car_back()</span><span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a>        pwm1.ChangeDutyCycle(<span class="dv">25</span>)</span><span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a>        pwm2.ChangeDutyCycle(<span class="dv">25</span>)</span><span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">2</span>)</span><span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a>        car_left()</span><span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a>        pwm1.ChangeDutyCycle(<span class="dv">40</span>)</span><span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a>        pwm2.ChangeDutyCycle(<span class="dv">40</span>)</span><span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;detect obstacles in the right!&quot;</span>)</span><span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="dv">1</span>)</span><span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span><span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a>        car_forward()</span><span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a>        pwm1.ChangeDutyCycle(<span class="dv">30</span>)</span><span id="cb18-107"><a href="#cb18-107" aria-hidden="true" tabindex="-1"></a>        pwm2.ChangeDutyCycle(<span class="dv">30</span>)</span><span id="cb18-108"><a href="#cb18-108" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-109"><a href="#cb18-109" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-110"><a href="#cb18-110" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-111"><a href="#cb18-111" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> loop():</span><span id="cb18-112"><a href="#cb18-112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span><span id="cb18-113"><a href="#cb18-113" aria-hidden="true" tabindex="-1"></a>        car_forward()</span><span id="cb18-114"><a href="#cb18-114" aria-hidden="true" tabindex="-1"></a>        pwm1.ChangeDutyCycle(<span class="dv">30</span>)</span><span id="cb18-115"><a href="#cb18-115" aria-hidden="true" tabindex="-1"></a>        pwm2.ChangeDutyCycle(<span class="dv">30</span>)</span><span id="cb18-116"><a href="#cb18-116" aria-hidden="true" tabindex="-1"></a>        [left, right] <span class="op">=</span> InfraredMeasure()</span><span id="cb18-117"><a href="#cb18-117" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(left,right)</span><span id="cb18-118"><a href="#cb18-118" aria-hidden="true" tabindex="-1"></a>        avoidance(left,right)</span><span id="cb18-119"><a href="#cb18-119" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> destroy():</span><span id="cb18-120"><a href="#cb18-120" aria-hidden="true" tabindex="-1"></a>    gpio.cleanup()</span><span id="cb18-121"><a href="#cb18-121" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-122"><a href="#cb18-122" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-123"><a href="#cb18-123" aria-hidden="true" tabindex="-1"></a></span><span id="cb18-124"><a href="#cb18-124" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span><span id="cb18-125"><a href="#cb18-125" aria-hidden="true" tabindex="-1"></a>    loop()</span><span id="cb18-126"><a href="#cb18-126" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">KeyboardInterrupt</span>:</span><span id="cb18-127"><a href="#cb18-127" aria-hidden="true" tabindex="-1"></a>    destroy()</span></code></pre></div><h1 id="超声波避障">5 超声波避障</h1><div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> RPi.GPIO <span class="im">as</span> gpio</span><span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span><span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义引脚</span></span><span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>pin1 <span class="op">=</span> <span class="dv">12</span>  <span class="co"># 左正</span></span><span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>pin2 <span class="op">=</span> <span class="dv">16</span>  <span class="co"># 左反</span></span><span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>pin3 <span class="op">=</span> <span class="dv">18</span>  <span class="co"># 右正</span></span><span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>pin4 <span class="op">=</span> <span class="dv">22</span>  <span class="co"># 右反</span></span><span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>ENA <span class="op">=</span> <span class="dv">38</span></span><span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>ENB <span class="op">=</span> <span class="dv">40</span></span><span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>TRIG <span class="op">=</span> <span class="dv">13</span>  <span class="co"># send-pin</span></span><span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>ECHO <span class="op">=</span> <span class="dv">15</span>  <span class="co"># receive-pin</span></span><span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置gpio口为BOARD编号规范</span></span><span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>gpio.setmode(gpio.BOARD)</span><span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置gpio口为输出</span></span><span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>gpio.setup(pin1, gpio.OUT)</span><span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>gpio.setup(pin2, gpio.OUT)</span><span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>gpio.setup(pin3, gpio.OUT)</span><span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>gpio.setup(pin4, gpio.OUT)</span><span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>gpio.setup(ENA, gpio.OUT)</span><span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>gpio.setup(ENB, gpio.OUT)</span><span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置PWM波,频率为50Hz</span></span><span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>pwm1 <span class="op">=</span> gpio.PWM(ENA, <span class="dv">50</span>)</span><span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>pwm2 <span class="op">=</span> gpio.PWM(ENB, <span class="dv">50</span>)</span><span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>pwm1.start(<span class="dv">0</span>)</span><span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>pwm2.start(<span class="dv">0</span>)</span><span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> car_forward():  <span class="co"># 定义前进函数</span></span><span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin1, gpio.HIGH)  <span class="co"># 将pin1接口设置为高电压</span></span><span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin2, gpio.LOW)  <span class="co"># 将pin2接口设置为低电压</span></span><span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin3, gpio.HIGH)  <span class="co"># 将pin3接口设置为高电压</span></span><span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin4, gpio.LOW)  <span class="co"># 将pin4接口设置为低电压</span></span><span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> car_back():  <span class="co"># 定义后退函数</span></span><span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin1, gpio.LOW)</span><span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin2, gpio.HIGH)</span><span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin3, gpio.LOW)</span><span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin4, gpio.HIGH)</span><span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> car_left():  <span class="co"># 定义左转函数</span></span><span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin1, gpio.LOW)</span><span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin2, gpio.HIGH)</span><span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin3, gpio.HIGH)</span><span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin4, gpio.LOW)</span><span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> car_right():  <span class="co"># 定义右转函数</span></span><span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin1, gpio.HIGH)</span><span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin2, gpio.LOW)</span><span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin3, gpio.LOW)</span><span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin4, gpio.HIGH)</span><span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> car_stop():  <span class="co"># 定义停止函数</span></span><span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin1, gpio.LOW)</span><span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin2, gpio.LOW)</span><span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin3, gpio.LOW)</span><span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a>    gpio.output(pin4, gpio.LOW)</span><span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> setup():</span><span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a>    gpio.setup(TRIG, gpio.OUT, initial<span class="op">=</span>gpio.LOW)</span><span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>    gpio.setup(ECHO, gpio.IN)</span><span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>    gpio.setwarnings(<span class="va">False</span>)  <span class="co"># 关闭警告</span></span><span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> distance():</span><span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>    gpio.output(TRIG, <span class="dv">1</span>)  <span class="co"># 给Trig一个10US以上的高电平</span></span><span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a>    time.sleep(<span class="fl">0.00001</span>)</span><span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a>    gpio.output(TRIG, <span class="dv">0</span>)</span><span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 等待低电平结束，然后记录时间</span></span><span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> gpio.<span class="bu">input</span>(ECHO) <span class="op">==</span> <span class="dv">0</span>:  <span class="co"># 捕捉 echo 端输出上升沿</span></span><span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span><span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a>    time1 <span class="op">=</span> time.time()</span><span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 等待高电平结束，然后记录时间</span></span><span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> gpio.<span class="bu">input</span>(ECHO) <span class="op">==</span> <span class="dv">1</span>:  <span class="co"># 捕捉 echo 端输出下降沿</span></span><span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span><span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a>    time2 <span class="op">=</span> time.time()</span><span id="cb19-88"><a href="#cb19-88" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-89"><a href="#cb19-89" aria-hidden="true" tabindex="-1"></a>    during <span class="op">=</span> time2 <span class="op">-</span> time1</span><span id="cb19-90"><a href="#cb19-90" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ECHO高电平时刻时间减去低电平时刻时间，所得时间为超声波传播时间</span></span><span id="cb19-91"><a href="#cb19-91" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> during <span class="op">*</span> <span class="dv">340</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">*</span> <span class="dv">100</span></span><span id="cb19-92"><a href="#cb19-92" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-93"><a href="#cb19-93" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-94"><a href="#cb19-94" aria-hidden="true" tabindex="-1"></a><span class="co"># 超声波传播速度为340m/s,最后单位米换算为厘米，所以乘以100</span></span><span id="cb19-95"><a href="#cb19-95" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> loop():</span><span id="cb19-96"><a href="#cb19-96" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span><span id="cb19-97"><a href="#cb19-97" aria-hidden="true" tabindex="-1"></a>        dis <span class="op">=</span> distance()</span><span id="cb19-98"><a href="#cb19-98" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(dis, <span class="st">&quot;cm</span><span class="ch">\n</span><span class="st">&quot;</span>)</span><span id="cb19-99"><a href="#cb19-99" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print dis, &#39;cm&#39;</span></span><span id="cb19-100"><a href="#cb19-100" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print &#39;&#39;</span></span><span id="cb19-101"><a href="#cb19-101" aria-hidden="true" tabindex="-1"></a>        time.sleep(<span class="fl">0.3</span>)</span><span id="cb19-102"><a href="#cb19-102" aria-hidden="true" tabindex="-1"></a>        car_forward()</span><span id="cb19-103"><a href="#cb19-103" aria-hidden="true" tabindex="-1"></a>        pwm1.ChangeDutyCycle(<span class="dv">30</span>)</span><span id="cb19-104"><a href="#cb19-104" aria-hidden="true" tabindex="-1"></a>        pwm2.ChangeDutyCycle(<span class="dv">30</span>)</span><span id="cb19-105"><a href="#cb19-105" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (dis <span class="op">&lt;</span> <span class="dv">30</span>):</span><span id="cb19-106"><a href="#cb19-106" aria-hidden="true" tabindex="-1"></a>            car_back()</span><span id="cb19-107"><a href="#cb19-107" aria-hidden="true" tabindex="-1"></a>            pwm1.ChangeDutyCycle(<span class="dv">40</span>)</span><span id="cb19-108"><a href="#cb19-108" aria-hidden="true" tabindex="-1"></a>            pwm2.ChangeDutyCycle(<span class="dv">40</span>)</span><span id="cb19-109"><a href="#cb19-109" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">1</span>)</span><span id="cb19-110"><a href="#cb19-110" aria-hidden="true" tabindex="-1"></a>            car_forward()</span><span id="cb19-111"><a href="#cb19-111" aria-hidden="true" tabindex="-1"></a>            pwm1.ChangeDutyCycle(<span class="dv">40</span>)</span><span id="cb19-112"><a href="#cb19-112" aria-hidden="true" tabindex="-1"></a>            pwm2.ChangeDutyCycle(<span class="dv">0</span>)</span><span id="cb19-113"><a href="#cb19-113" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">1</span>)</span><span id="cb19-114"><a href="#cb19-114" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-115"><a href="#cb19-115" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-116"><a href="#cb19-116" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> destroy():</span><span id="cb19-117"><a href="#cb19-117" aria-hidden="true" tabindex="-1"></a>    gpio.cleanup()</span><span id="cb19-118"><a href="#cb19-118" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-119"><a href="#cb19-119" aria-hidden="true" tabindex="-1"></a></span><span id="cb19-120"><a href="#cb19-120" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span><span id="cb19-121"><a href="#cb19-121" aria-hidden="true" tabindex="-1"></a>    setup()</span><span id="cb19-122"><a href="#cb19-122" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span><span id="cb19-123"><a href="#cb19-123" aria-hidden="true" tabindex="-1"></a>        loop()</span><span id="cb19-124"><a href="#cb19-124" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">KeyboardInterrupt</span>:</span><span id="cb19-125"><a href="#cb19-125" aria-hidden="true" tabindex="-1"></a>        destroy()</span></code></pre></div>]]></content>
      
      
      <categories>
          
          <category> 实验 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 树莓派 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【论文】ORCA</title>
      <link href="/2023/03/26/lun-wen-orca/"/>
      <url>/2023/03/26/lun-wen-orca/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="rvo2-library-reciprocal-collision-avoidance-for-real-time-multi-agent-simulation">RVO2 Library: Reciprocal Collision Avoidance for Real-Time Multi-Agent Simulation</h1><p><img src="/2023/03/26/lun-wen-orca/images.png" alt="Velocity Obstacle Approaches for Multi-Agent Collision Avoidance"><span id="more"></span></p><h2 id="一些要点">一些要点</h2><ul><li>二维环境</li><li><a href="https://gamma.cs.unc.edu/ORCA/">optimal reciprocal collision avoidance（ORCA）</a>公式<ul><li>多个独立的移动机器人或代理需要在没有代理之间通信的情况下在公共工作空间中移动时避免相互碰撞。</li><li>让每个代理承担避免成对碰撞的一半责任。<img src="/images/多级协同避障\image-20220113102255772.png" width="80%" height="80%" align="center"></li><li>每个无人机的最优动作简化为低维度线性问题，即凸优化问题。让每个代理承担避免成对碰撞的一半责任。<img src="/images/多级协同避障\image-20220113102841763.png" width="80%" height="80%" align="center"></li></ul></li><li>这个算法可以避免agents出现震荡行为。</li><li>user指定了静止的障碍物和agents初速度。</li><li>如果使用<a href="%5BHome%20-%20OpenMP%5D(https://www.openmp.org/)">OPENMP</a>可以利用多个处理器并行模拟。</li></ul><h1 id="论文解读"><a href="%5BC:/Users/Jur%20van%20den%20Berg/Documents/ORCA/author.dvi%20(unc.edu)%5D(https://gamma.cs.unc.edu/ORCA/publications/ORCA.pdf)">论文解读</a></h1><p><a href="%5B(59条消息)%20导航动态避让算法RVO的优化ORCA(Optimal%20Reciprocal%20Collision%20Avoidance)_u012740992的专栏-CSDN博客_rvo算法%5D(https://blog.csdn.net/u012740992/article/details/89397714)">参考网址</a></p><p>解读，解读个p，啥也不会，直接看<a href="https://blog.csdn.net/u012740992/article/details/121727523">(59条消息) ORCA(RVO2)算法优化整理版_u012740992的专栏-CSDN博客_orca算法</a></p><hr><p>一些网址：</p><p><a href="%5B论文笔记《Reciprocal%20Velocity%20Obstacles%20for%20Real-Time%20Multi-Agent%20Navigation》%20%7C%20陪你度过漫长岁月%20(meltycriss.com)%5D(https://www.meltycriss.com/2017/01/13/paper-rvo/)">论文笔记《Reciprocal Velocity Obstacles for Real-Time Multi-Agent Navigation》</a></p><hr><p>cite:</p><p><span class="citation" data-cites="Inbook">@Inbook</span>{Furrer2016, author="Furrer, Fadri and Burri, Michael and Achtelik, Markus and Siegwart, Roland", editor="Koubaa, Anis", chapter="RotorS---A Modular Gazebo MAV Simulator Framework", title="Robot Operating System (ROS): The Complete Reference (Volume 1)", year="2016", publisher="Springer International Publishing", address="Cham", pages="595--625", isbn="978-3-319-26054-9", doi="10.1007/978-3-319-26054-9_23", url="http://dx.doi.org/10.1007/978-3-319-26054-9_23" }</p>]]></content>
      
      
      <categories>
          
          <category> 论文 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 避障 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【论文】EGO-Planner</title>
      <link href="/2023/03/26/lun-wen-ego-planner/"/>
      <url>/2023/03/26/lun-wen-ego-planner/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="浙江大学fast-的ego-planner">浙江大学FAST 的EGO-Planner</h1><p><img src="/2023/03/26/lun-wen-ego-planner/images.jpeg" alt="EGO-Planner: An ESDF-free Gradient-based Local Planner for Quadrotors |  Papers With Code" style="zoom:150%;"><span id="more"></span></p><h2 id="摘要">摘要</h2><blockquote><p>基于梯度规划广泛使用于local planning，其中欧几里德符号距离场（ESDF）欧几里德符号距离场<a href="https://blog.csdn.net/Travis_X/article/details/115506278">（ESDF）</a>对梯度幅度和方向有着非常重要的作用。其中ESDF是<strong>可以很方便地对障碍物进行距离和梯度信息的查询，对空中机器人的在线运动规划具有重要意义。如何快速地生成ESDF地图是进行实时运动规划的重点</strong>。</p><p>但是计算这么一个field是非常冗余的，因为轨迹优化过程仅仅包含一个非常有限的ESDF范围为的子空间。借此，一个ESDF-free 的基于梯度planning框架提出，显著的减少了计算时间，最主要的提升是在惩罚函数中的碰撞项通过比较碰撞轨迹和没有碰撞的路径得出，产生的障碍信息将会被储存起来如果这个路径（trajectory）击中了新的障碍，从而让必要的障碍信息被提取出来。之后，如果动态可行性被违背，我们加长时间分配。一个各向异性的曲线拟合算法被介绍到轨迹的高级导数中，并保持原始的形状，Bechmark比较和真实世界的实验证实了它的鲁棒性和高性能。</p></blockquote><h2 id="介绍">介绍</h2><blockquote><p>背景：传统使用的基于梯度planners依赖于提前构造的ESDF地图去评估梯度幅值和方向，同时使用多条优化去生成一个本地最优的解决措施，即便这个优化项目能够很好的收敛，但是前期的ESDF构造很麻烦。</p><p>ESDF构造方法：</p><ul><li>增量计算(incremental global updating ones)</li><li>批量本地计算(batch local calculation ones)</li></ul><p>但是没有一种是专注于路径本身的，所以<strong>当前的基于ESDF方法并没有直接服务于路径优化</strong>。</p><p>当前算法：包含仔细的工程考虑让算法变得鲁棒和轻量。由基于梯度的样条优化和一个后提纯的过程构成。</p><ul><li>首先，使用丝滑碰撞和动态可行性去优化路径，通过将障碍物内的轨迹与引导的无碰撞路径进行比较来模拟碰撞成本。</li><li>之后，将力投射到碰撞轨迹上并生成估计的梯度以将轨迹包裹在障碍物之外 。</li><li>在优化过程中，这个轨迹会反弹几次在障碍物和最后的终止在安全的区域</li></ul><p>如果产生的路径违背了动态限制（由于不知道原因的时间分配），后提纯过程被激活(refinement) 。</p></blockquote><h2 id="比较">比较</h2><ul><li>传统的ESDF算法缺点：在计算梯度幅值和方向的时候往往会将全地图数据提前输入计算（pre-computed ESDF），这样的计算方式是多余的，而且会大大提高计算机的运算时间，对于轨迹优化而言灵活性不高。</li><li>EGO算法优点：轻量级而且鲁棒性强。</li></ul><hr><h3 id="优化算法比较">优化算法比较</h3><p>比较内容有</p><ul><li>success rate成功率（收敛速率）</li><li>computed time计算时间</li><li>number of function of obejects estimation目标函数评估数量</li></ul><hr><p>三种算法</p><figure><img src="/2023/03/26/lun-wen-ego-planner/image-20220313223549277.png" alt="image-20220313223549277"><figcaption aria-hidden="true">image-20220313223549277</figcaption></figure><ul><li><p>Barzilai-Borwein（BB）。</p></li><li><p>limited-memory BFGS（L-BFGS）使用二次taylor展开，taylor展开阶次越高越精确。</p></li><li><p>truncated Newton（T-Newton）弦截牛顿法。</p><blockquote><p><strong>conclusion：L-BFGS算法表现最好</strong>。</p></blockquote></li></ul><hr><h3 id="轨迹生成算法比较">轨迹生成算法比较</h3><figure><img src="/2023/03/26/lun-wen-ego-planner/image-20220313223716472.png" alt="image-20220313223716472"><figcaption aria-hidden="true">image-20220313223716472</figcaption></figure><ul><li><p>EGO算法成功率高，但是能量消耗大，因为它会产生更多的控制点，导致对无人机的控制变多，但是在计算时间上有着卓越的表现。</p></li><li><p>EI（ESDF- based）成功率高</p></li><li><p>EVI（ESDF-free）成功率对比上面两种方法最低，但是所需要的能量最少，但是EVI只能在一些比较没有挑战性的情况下执行。</p></li></ul><h3 id="multiple-planners-comparison">Multiple Planners Comparison</h3><figure><img src="/2023/03/26/lun-wen-ego-planner/image-20220313223756373.png" alt="image-20220313223756373"><figcaption aria-hidden="true">image-20220313223756373</figcaption></figure><ul><li><p>EWOK</p></li><li><p>Fast-Planner</p></li><li><p>本文中的提高的planner方法</p><blockquote><p>conclusion：本文提出的planner能够成功达到最少的飞行时间和飞行长度，但是需要更多的能量，可能是因为基于基诺动力学（kinodynamics）的路径搜索的原因，但是本文的方法具有最少的计算时间。</p></blockquote></li></ul><h2 id="ego方法的缺点">EGO方法的缺点</h2><p>只能使用于相对于静态的环境中（velocity&lt;0.5m/s）</p>]]></content>
      
      
      <categories>
          
          <category> 论文 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 路径规划 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【论文】Crazyswarm论文</title>
      <link href="/2023/03/26/lun-wen-crazyswarm-lun-wen/"/>
      <url>/2023/03/26/lun-wen-crazyswarm-lun-wen/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="crazyswarm大型纳米四轴飞行器群论文总结">《Crazyswarm：大型纳米四轴飞行器群》论文总结</h1><p>论文名称：Crazyswarm: A Large Nano-Quadcopter Swarm</p><figure><img src="/2023/03/26/lun-wen-crazyswarm-lun-wen/image-20220319171842418.png" alt="image-20220319171842418"><figcaption aria-hidden="true">image-20220319171842418</figcaption></figure><span id="more"></span><h2 id="摘要">摘要</h2><p>为大量在室内密集编队飞行的微型四轴飞行器定义了一个系统架构。</p><ul><li><p>对于状态估计（state estimation），我们开发了一种方法来可靠地跟踪具有相同运动捕捉标记排列的许多小刚体（无人机）。</p></li><li><p>我们的通信基础设施使用压缩的单向数据流，每个无线电支持大量无人机。</p></li><li><p>我们通过执行大部分机载计算（computation onboard），包括传感器融合、控制和一些轨迹规划，实现了具有精确跟踪（&lt; 2 cm 平均位置误差）的可靠飞行。</p></li><li><p>我们提供了各种示例，并根据经验确定了多达 49 辆车的群的延迟和跟踪性能。</p></li></ul><h2 id="介绍">介绍</h2><p><strong>提出问题</strong>：大多数研究型四轴飞行器都足够大，可以携带相机和智能手机级计算机，但它们也很昂贵，并且需要很大的空间才能安全运行。</p><p><strong>提出系统结构</strong>：使用<strong>动作捕捉系统</strong>（motion-capture system）进行<strong>定位</strong>（localization）并通过<strong>三个共享无线电进行通信</strong>（communicaiton over three shared radios）。</p><h2 id="related-work">Related Work</h2><ol type="1"><li>Kushleyev在实验中控制20个微四旋翼机，这篇文章和他不同的地方在于:①本文章的系统结构是为了<em>减小通信带宽和为了更好的扩展到更多数量的四轴飞行器而设计的</em>；②证明了<em>集群的相互影响</em>（interactivity）。</li><li>the Flying Machine Arena at ETH Zurich 做了单机和多机的实验，和本篇文章不同的地方在于①位置控制器在机外（offboard）运行，使系统对丢包的鲁棒性降低。②额外的计算能力用于延迟补偿算法 以提高高速飞行的准确性。</li></ol><h2 id="结构综述">结构综述</h2><p>三种方法结构比较：</p><ul><li>动作捕捉系统会产生单点故障（a single point of failure），但是由于高性能（位置误差能够小于1mm），最终还是选择了动作捕捉系统。</li><li>使用超带宽的无线电三角测量的去中心化定位系统（decentralized localization system），会有10cm的偏差，所以放弃。</li><li>基于视觉的方法需要无人机携带相机和计算机，这对于大型纳米四轴飞行器群来说是一场灾难。</li></ul><h2 id="object-tracking">Object Tracking</h2><p>像Vicon Tracker这样的标准的刚体捕捉软件需要为每一个跟踪目标安排一个标记，但是Crazyflie太小，无法放下一个标记，而且多数量的无人机会造成模糊，因此，仅仅从动作捕捉系统中获取原始点云数据（ raw point clouds），实施基于<em>ICP（Interactive Closest Point迭代最近点算法）</em>算法的目标跟踪。</p><h3 id="initialization">Initialization</h3><p>使用<strong>一个包含固定初始点定位的配置文件</strong>， 但是不可能在每次飞行前将每个无人机放置在其精确配置的位置。 为了允许小的偏差，<strong>我们执行关于初始位置布局相关半径内的最近邻搜索（nearest-neighbor）</strong>，在估计偏航角的时候使用ICP算法。 我们只接受最好的猜测：一致误差非常小，小于1mm均方欧式距离。</p><h3 id="frame-to-frame-tracking">Frame-to-frame Tracking</h3><p>前提：</p><ul><li>飞行期间没有长时间的遮挡。</li><li>限制ICP的迭代次数（5次）以在支持的硬件设备上运行。</li></ul><pre class="flow"><code>st=&gt;start: Frame-to-frame Trackingop1=&gt;operation: 从动作捕捉系统获得原始点云数据op2=&gt;operation: 对于每个对象，我们使用 ICP 将对应于对象最后已知姿势的标记位置与整个场景点云进行配准op3=&gt;operation: 动作捕捉系统有时会产生带有缺失的点云从而避免跟踪误差op4=&gt;operation: 从ICP计算线速度和角速度，将异常值剔除并与onboard状态结合e=&gt;end: endst-&gt;op1-&gt;op2-&gt;op3-&gt;op4-&gt;e</code></pre><h2 id="状态估计">状态估计</h2><p>为了减少通信带宽要求并保持对临时通信丢失的鲁棒性， 我们在扩展卡尔曼滤波器 (Extended Kalman Filter) 中融合板载的运动捕捉和 IMU 测量 。</p><p>系统的输入是加速计和陀螺仪a<sub>m</sub>和w<sub>m</sub>，所以有了动力方程，<img src="/2023/03/26/lun-wen-crazyswarm-lun-wen/image-20220320145344320.png" alt="image-20220320145344320"></p><p>IMU测量驱动动态积分，滤波器估计此积分的误差和协方差。 当用四个数字表示一个3自由度单位四元数时，这种方法避免了有问题的额外维度。 虽然 [14]、[15] 估计了 EKF 中的加速度计和陀螺仪偏差。</p><h2 id="planning">Planning</h2><p>选择了一组oboard轨迹规划方法，这些方法需要在基站 PC 和车辆之间进行少量信息交换。 与在 PC 上评估轨迹并以高速率传输姿态和推力控制的架构相比，将一些规划工作转移到onboard以<strong>减少所需的无线电带宽</strong>。</p><p><span class="math display">\[y=(p,\psi)\]</span>其中<span class="math inline">\(\psi\)</span>是世界坐标系下的偏航角（yaw）。</p><p>这意味着在状态空间中执行轨迹所需的控制是 y 及其有限数量的时间导数的函数。 我们利用这一事实并使用至少四次可微的函数来规划 y 中的轨迹。</p><h3 id="piecewise-polynomials">Piecewise Polynomials</h3><p>框架支持从基站上传或内置到固件映像中的分段多项式。</p><h3 id="online-single-piece-polynomials">Online Single-Piece Polynomials</h3><p>对于路程较短的轨迹而言，单个多项式已经足够了。我们为垂直起飞、着陆和悬停点之间的线性移动等任务实现了一个在线单段多项式规划器（online single-piece polynomial planner）。</p><h3 id="ellipses">Ellipses</h3><p>这个主要是为了证明online single-piece polynomial planner能够实现一段光滑稳定的轨迹规划。</p><h3 id="interactive-avoid-obstacle-mode">Interactive Avoid-Obstacle Mode</h3><p>交互避障模式是对于已知位置的单个移动障碍物，例如人类，我们使用专门的避障模式。计划者是完全分布式的，只需要知道无人机的位置 p，其分配的起始位置 p<sub>home</sub>， 和障碍物的位置 p<sub>obst</sub>，通过计算可以得到避障距离，那么新的目标位置就可以被计算出来，而且作为一种从原始位置的加权位移。相关的公式如下图。<img src="/2023/03/26/lun-wen-crazyswarm-lun-wen/image-20220320151631835.png" alt="image-20220320151631835">这样就可以<strong>计算出边际速度和加速度来得到光滑的轨迹</strong>。</p><h2 id="通信">通信</h2><p>我们使用两种不同的通信方式：请求响应（request-response）和广播（broadcasting）。</p><ul><li>请求-响应主要用于配置仍在地面上的Crazyflie。这包括上传轨迹、更改控制器增益等飞行参数以及将每个 Crazyflie 分组。</li><li>在飞行过程中使用广播最小化位置反馈的延迟，并实现起飞、着陆、开始轨迹等的同步行为。通过组 ID 号，可以将广播命令限制为群的子集 。</li></ul><p>由于通信没有使用标准传输层（transport layer），因此，我们需要把处理零星的丢包作为我们协议的一部分。为了实现低延迟，我们的目标不是保证数据包传输，而是高概率的可靠通信（probability of reliable communication）。</p><p>在定义的协议，所有命令都是幂等的（idempotent），所以它们可以是多次收到，没有任何副作用。 这允许我们重复request-response命令，直到确认接收（acknowledged）或发生超时。</p><p>Swarm-coordination命令，例如起飞，不等待确认（acknowledged），而是重复多次，以提高所有 Crazyflies 收到命令的概率。</p><p>根据经验，<strong>对于重复的命令，数据包丢失的可能性取决于命令重复的速率</strong>。而本文做的实验结果表明，对于Swarm-coordination命令，每 3 ms 重复 5 次消息会到达所有 Crazyflies，这足以稳定控制。</p><p>对于 49个无人机 ，使用三个无线电（radios），保证每一个无人机能够接收到一个无线电。通过无线电传输关于位置 p、四元数q等信息。</p><h2 id="control">Control</h2><p>PID控制，输入当前的状态和目标位置、目标速度、目标加速度、目标偏航角、目标角速度，通过偏航角和位置误差来进行反馈，详细的过程参考论文。</p><h2 id="实验">实验</h2><h3 id="延迟">延迟</h3><p>物理运动和相应位置反馈消息到达固件之间的总时间延迟显着影响整个系统性能，而且由于计算和通信开销，延迟随着群体规模的增加而增加。</p><p>通过两种方式估计延迟：</p><ul><li>首先，使用 Vicon DataStream SDK 来查询运动捕捉系统延迟的估计值，并使用代码来估计软件组件的运行时间。</li><li>其次，我们通过指引Crazyflie 的偏航突然变化来验证物理设置中的这些数字。 即时onboard IMU 响应与外部位置测量的相应变化之间的延迟捕获整个系统延迟， 我们通过 JTAG 调试适配器实时读取上面的系统延迟。</li></ul><p>实验数据表明，49个无人机方阵会达到26ms的延迟。</p><h3 id="跟踪性能">跟踪性能</h3><p>通过整合飞行的整体欧几里得位置误差来估计跟踪性能，不包括起飞和着陆。 每个 Crazyflie 的飞行路径是重复 3 次的 8 字形，平均速度为 0.76 m/s，最大速度为 1.5 m/s。 对于小型四轴飞行器，该轨迹速度适中，最大滚动角为 20 度。 我们尝试不同的方群大小，从 1 到 7×7，以 0.5 m 间距的网格布局，以相同的高度飞行。 这种紧密的结构会导致额外的空气动力干扰，从而影响控制器的性能。<img src="/2023/03/26/lun-wen-crazyswarm-lun-wen/image-20220320192830419.png" alt="image-20220320192830419"></p><p>结果如图，方阵越大，误差也就随之增加。但是每个crazyflie的误差也低于 2 cm。</p><h3 id="位置更新率对悬停稳定性的影响">位置更新率对悬停稳定性的影响</h3><p>通过将更新率从最大 100 Hz 降低到 2 Hz 并测量悬停状态下的平均欧几里得位置误差来量化位置更新率对稳定性的影响。 100 Hz 和 10 Hz 之间的范围几乎没有变化。 在 2 Hz 时，系统仍然稳定，但显示出明显的振荡。 这证明了我们的系统在操作过程中对通信丢失的鲁棒性。</p><figure><img src="/2023/03/26/lun-wen-crazyswarm-lun-wen/image-20220320193729705.png" alt="image-20220320193729705"><figcaption aria-hidden="true">image-20220320193729705</figcaption></figure><h3 id="协同编队飞行">协同编队飞行</h3><p>使用了 49 只 Crazyflies 组成的一个旋转金字塔，如<a href="https://www.youtube.com/watch?v=ezTayb76x9U">实验视频</a> 所示。Crazyflies 最初放置在 7×7 网格中，间距为 0.5 m。 起飞在四个不同的层中完成，用户使用操纵杆或键盘触发下一个动作。 该脚本最初根据其层为每个 Crazyflie 分配一个组号，然后上传其椭圆的参数以供稍后执行。 由于分组，可以通过广播消息同时实现一整层的起飞。 在所有 Crazyflies 都在空中后，在线规划器规划一条轨迹，以顺利进入椭圆。 用户可以决定何时结束旋转，这会导致机上的另一个重新计划达到初始起飞位置上方的悬停状态。 最后，使用相同的组完成着陆，最大限度地减少着陆期间的空气动力干扰。</p><h3 id="无人机交互">无人机交互</h3><p>操作员手持（或佩戴）带有动作捕捉标记的物体。 我们跟踪该物体的位置，并通过无线电将其位置与所有四轴飞行器的位置一起广播。 使用<em>Interactive Avoid-Obstacle Mode</em>中描述的onboard规划器，每个 Crazyflie 计算其所需位置，从而避免与障碍物或其他四轴飞行器发生碰撞。</p><h2 id="总结">总结</h2><ul><li><p>描述了一种用于对迄今为止最大的室内四轴飞行器群进行稳健、同步、动态控制的系统架构。</p></li><li><p>充分利用了车辆的车载计算能力，能够对不可靠的通信具有鲁棒性。</p></li><li><p>并提供一组需要很少无线电带宽的丰富轨迹规划方法。</p></li><li><p>实验显示了相对于群体大小的延迟和跟踪性能的良好可扩展性。 对于一组 49 辆车，只需要 3 个无线电，获得了低 30 毫秒的延迟，允许使用机载状态估计进行适度激进的飞行机动，平均跟踪误差低于 2 厘米。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 论文 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS </tag>
            
            <tag> 集群控制 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>戴望舒诗集摘录</title>
      <link href="/2023/02/05/dai-wang-shu-shi-ji-zhai-lu/"/>
      <url>/2023/02/05/dai-wang-shu-shi-ji-zhai-lu/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="戴望舒诗集摘录">戴望舒诗集摘录</h1><blockquote><p>静夜</p><p><strong>像侵晓蔷薇的蓓蕾</strong></p><p><strong>含着晶耀的香露，</strong></p><p><strong>你盈盈地低泣，低着头，</strong></p><p><strong>你在我心头开了烦忧路。</strong></p><p>你哭泣嘤嘤地不停，</p><p>我心头反复地不宁：</p><p>这烦忧是从何处生</p><p>使你堕泪，又使我伤心？</p><p>停了泪儿啊，请莫悲伤，</p><p>且把那原因细讲，</p><p><strong>在这幽夜沉寂又微凉，</strong></p><p><strong>人静了，这正是时光。</strong></p></blockquote><p>静夜沉沉，浮光霭霭，冷浸溶溶月。有谁知晓一个静夜蕴藏了多少缠绵悱恻的思绪？那些难以释怀的过去，那些酸涩无奈的现在，那些彷徨恐惧的未来……夜静了，把满怀的忧伤扔进深邃的黑夜里去吧，舒舒服服地躺在床上，与今天的自己道谢说晚安，床铺有一种神奇的魔力，能够一瞬间把你带到崭新的明天。</p><p>以前很迷恋汪国真、席慕蓉，直率、自然。后来觉得徐志摩很可心，轻盈而富有美感。再后来，一度崇拜顾城和戴望舒，顾城很纯真，想象力丰富。而戴望舒，很会抓住节奏。可今天，偶尔翻看了海子的诗，很佩服他。以前也看过，可能阅历不够，可能诗力欠缺，总觉得看不懂或看不出好在哪里。现在总算有一种感觉。刚刚无意间又浅看了他生平，油然生出一种敬意。以前只觉得他可怜，如今有了改观。</p><blockquote><p>山行</p><p>见了你朝霞的颜色，</p><p>便感到我落月的沉哀，</p><p>却似晓天的云片，</p><p>烦怨，飘上我心来。</p><p>可是不听你啼鸟的娇音，</p><p>我就要像流水地呜咽，</p><p>却似凝露的山花，</p><p>我不禁地泪珠盈睫。</p><p>我们彳亍在微茫的山径，</p><p>让梦香吹上了征衣，</p><p>和那朝霞，和那啼鸟，</p><p>和你不尽缠绵意。</p></blockquote><blockquote><p>独自的时候</p><p>房里曾充满过清朗的笑声，</p><p>正如花园里曾充满过蔷薇，</p><p>人在满积着梦的灰尘中抽烟，</p><p>沉想着消逝了的音乐。</p><p>在心头飘来飘去的是什么啊，</p><p>像白云一样的无定，像白云一样的沉郁？</p><p>而且要对它说话也是徒然的，</p><p>正如人徒然的向白云说话一样。</p><p>幽暗的房里耀着的只有光泽的木器，</p><p>独语着的烟斗也黯然缄默，</p><p>人在尘雾的空间描摩着惨白的裸体</p><p>和烧着人的火一样的眼睛。</p><p>为自己悲哀和为别人悲哀是一样的事，</p><p>虽然自己的梦是和别人的不同，</p><p>但是我知道今天我是流过眼泪，</p><p>而从外边，寂静是悄悄地进来。</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>关于自己</title>
      <link href="/2022/11/06/guan-yu-zi-ji/"/>
      <url>/2022/11/06/guan-yu-zi-ji/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="关于自己">关于自己</h1><blockquote><p>11月6日同日我写下这篇文章,身处考研最焦灼时期，非常累，给自己放了个假，所以在宿舍写下自己想对自己所说的话。</p><p>秋天可能是最美好的季节，像倒放的春，如延展的夏，似偷懒的冬。本文起兴，惯用季节气候。之所以想写对自己想说的话。是因为最近发现了很多事，让自己性格中的缺点暴露无遗，作文以告诫自己。</p><p>首先是爱自己。怎样才算爱自己，怎样爱自己，这可能是每个人都在学习的一件事。爱自己过多便是自私，爱自己太少容易丢失自己，迷失本心。无法爱自己的人是没有能力爱其他人的，也没有办法爱其他人，因为爱是平等的。发现和感知自己的内在需求，自己究竟想要什么，不要一味地追随他人的意志。你也曾是被父亲举过头顶的人，被母亲紧紧拥抱的人，你不比任何人差，你无须自卑，也不能自傲，坚定自己的选择。不管自己如何普通，不管自己是一个怎样的人，我，对自己价值判断的权利，永远要牢牢抓在自己的手中，我想要过什么样的生活，我想做什么样的事情，别人可以影响我的判断，可以对我进行建议，可以批评，甚至可以厌恶，但是最终还是我自己说了算。我就是我，也只能是我，一个独立的人格。</p><p>其二是迟钝感。敏感究竟是不是一件好事吗？这无法得知我也不想讨论此事，但我想，我不至于对很多事都敏感，情绪波动无须那么大，对很多事不要着急判断，慢一点，一清楚，就是苛刻与计较，这种无心要的苛刻无论是对他人或是自己都是不利的。写不下去了，有点困！！！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 碎碎念 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 守心明性 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>迷茫</title>
      <link href="/2022/07/13/mi-mang/"/>
      <url>/2022/07/13/mi-mang/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="迷茫">迷茫</h1><p>写于习思想考试前夕，有感而发考试周的最后一天，悉悉疏疏的几人可以占据图书馆的一整层楼，只有往来打水的人能够提醒你这里之前也曾坐满着人.人生总是孤独的。每当我心中那股孤独感涌上心头，我就想要记录些什么，因为人的一生中没有几次可以直面自己的感受，开心或是难过都让人犹如过山车般，享受或是遭受短暂的情绪冲击，只有孤独，人生只能选择不面对，逃避直到忘却。人们实在是太忙了，忙到不愿意让自己去享受这个世界所带来的一切。但是人们无法一直忘记，我们需要直面且接受它。我不同意马尔克斯所说的用爱情去安抚孤独爱情是空洞的、抽象的，你无法用一个抽象且空洞的方法去解决一个抽象且空洞的问题.孤独是人生的常态。于是我们选择游戏人生。 人是一种奇怪的生物，试想一下，如果让你每天7点起床，用同样的方式洗漱吃着同样的果餐，去图书馆的同一个位置，学习同样的科目，以疲惫的身体进入梦乡，如此反复，你会觉得孤独吗？大多数人都不会，但是如果有一天你不再去同一个信置、而是去一个陌生的位置，孤独的氛围犹如冷风从我脚底注入冲击头顶。写到这我不禁打湿了眼眶，我不知道我怎么了，但是我知道我会好起来，在下次出太阳前抑或是见到下一个熟人的时候。 我很想像个精神病人一样呐喊、嚎叫，我想上窜下跳，但是我害怕即使这样，也无济于事。我想干些没有那么有意义的事，我想得到肉体上的疲惫，希望它能带着我的灵魂一起休息。我动力实足却又疲累不堪，我精力旺盛却又满面愁容，心中的那团火一直不断地猛烈的燃烧着，但我无法得到它还能烧多久，于是它只能烧着，却无法触及我半分。</p>]]></content>
      
      
      <categories>
          
          <category> 碎碎念 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 杂谈 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>对亲情的思考</title>
      <link href="/2022/07/13/qin-qing/"/>
      <url>/2022/07/13/qin-qing/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="对亲情的思考">对亲情的思考</h1><blockquote><p>父亲节那天恰逢周末,所以晚上8点多才打电话回去,我妈接的视频电话,她对我说某个人已经不开心一天了,因为我母亲节很早就打电话祝福皇额娘节日快乐,而父亲节却迟迟没有电话,那边的父亲进入手机视频,只见撅着嘴，紧锁眉头，显示自己的不开心，又难掩嘴角的微笑。</p></blockquote><blockquote><p>我觉得有些好笑的同时也感慨父母真的老了，已经老到毫不掩饰对我的思念。亲情对于我来说是什么，从我记事起，只在面对语文作文的时候偶尔思考一下，但那也是思考怎么美化父母在我心目中的形象以博得改卷老师的青睐。</p></blockquote><blockquote><p>亲情到底是什么？上一次思考这个问题，是我在看到《你还在我身旁》这首诗的时候，</p><blockquote><p>瀑布的水逆流而上，</p><p>蒲公英种子从远处飘回，聚成伞的模样，</p><p>太阳从西边升起，落向东方。</p><p>子弹退回枪膛，</p><p>运动员回到起跑线上，</p><p>我交回录取通知书，忘了十年寒窗。</p><p>厨房里飘来饭菜的香，</p><p>你把我的卷子签好名字，</p><p>关掉电视，帮我把书包背上。</p><p>你还在我身旁。</p></blockquote><p>亲情是陪伴，是照顾，是害怕失去，却又不敢打扰。我仍然能够深刻地沉起数次生病时父母焦躁不安的脸庞，毕竟这和打我骂我的母亲形象还是很不一定的，也和嬉皮笑脸的父亲形象不太一样，我曾经一度认为我的父母不是爱我的，直到这份爱经受了二十年的风霜岁月，使其闪闪发光。</p></blockquote><blockquote><p>父母几乎不主动打电话给我,上次主动打过来还是外婆与世长辞时,所以我必须主动打过去,因为每周我的电话将是我们沟通最主要的桥梁。《日送》中写道“父女母子一场，只不过意味着，你和他的缘分就是今生今世不断地在目送他的背影渐行渐远，你站在小路的这一端。看着他逐渐消失在小路轻弯的地方，而且，他用背影默默地告诉你，不用追。”，我是不认同这句话的，可能是龙应台是母亲的原因导致她是从一个母亲的角度思考亲情，亲情从来不是父母一方的事，她的儿子安德到与她的关系并不好，她无法让安德列与她沟通，所以她无法追。</p><p>自我懂事起，父母就很理智，很成熟，好像不曾年吵轻狂过，好像生来只是为了做我的父母，我从未想过他们会有撒娇的一面，我总以为，他们再老，也会像以前一样坚强，他们从不向我说他们工作的辛苦，也不抱怨人生的艰苦，就像他们爱我那么多，而我只叫他们一声父母。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 碎碎念 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 亲情 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>断舍离</title>
      <link href="/2022/05/01/duan-she-chi/"/>
      <url>/2022/05/01/duan-she-chi/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="断舍离">断舍离</h1><span id="more"></span><p>2022年5月1号的00:00，我写下了这句话，在这里我卸载了电脑中的csgo等其他游戏，我要断舍离，并不是我意志力不坚定，而是告诉自己，我就是需要卸载才能不玩游戏dog。</p><p>今天看到一篇文章，讲的是人为什么 焦虑，不过是选择的时候犹犹豫豫，事后稀里糊涂的一通乱想。我在想考研这个事，如果我选择本校，是不是就可以平稳上岸了呢，答案90%应该是，但是人生都是一种选择，没有对于错，我想用更多的风险来获得丰厚的回报，我应该是一个极致的赌徒，我告诉自己，人这一生无他，就是赌。</p><p>生命的多姿多彩，就是未知，未知的事，未知的人，未知的下一步，我们准确确定下一步在哪，但是我们知道，走的每一步都思索、反思，跟马尔科夫定位一样，总会有一个最大似然概率，总能确定我大概在哪。</p><p>所以，现在我想对自己提出一个问题，230天，我可以吗？我在这里回答自己，设定的初值是可以 ，300天后在这里看。</p>]]></content>
      
      
      <categories>
          
          <category> 碎碎念 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>JAVA使用JNA</title>
      <link href="/2022/04/07/java-shi-yong-jna/"/>
      <url>/2022/04/07/java-shi-yong-jna/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="使用jna调用cc动态链接库dll">使用JNA调用C/C++动态链接库dll</h1><p>参考视频:</p><ul><li><a href="https://www.bilibili.com/video/BV16t411A7it/">Java使用JNA调用C/C++动态链接库dll_哔哩哔哩_bilibili</a>（不是特别对）</li><li><a href="https://www.bilibili.com/video/BV1xU4y1F7Ep?spm_id_from=333.1007.top_right_bar_window_default_collection.content.click">【C++】JAVA使用JNA调用C++动态库DLL_哔哩哔哩_bilibili</a>（推荐）</li></ul><p>GITHUB repository:</p><ul><li><a href="https://github.com/java-native-access/jna">java-native-access/jna: Java Native Access (github.com)</a></li><li>repository：<a href="https://github.com/Copy2000/JNA_use">Copy2000/JNA_use: 使用JNA调用c++的类和函数 (github.com)</a></li></ul><span id="more"></span><h2 id="准备">准备</h2><ul><li>下载JNA和JNA Platform。</li></ul><figure><img src="/2022/04/07/java-shi-yong-jna/image-20220407232739677.png" alt="image-20220407232739677"><figcaption aria-hidden="true">image-20220407232739677</figcaption></figure><figure><img src="/2022/04/07/java-shi-yong-jna/image-20220407232838933.png" alt="image-20220407232838933"><figcaption aria-hidden="true">image-20220407232838933</figcaption></figure><ul><li>下载Code，可以使用SSH，更加快，但是我使用了VPN了，所以直接下载压缩包。</li></ul><figure><img src="/2022/04/07/java-shi-yong-jna/image-20220407233022480.png" alt="image-20220407233022480"><figcaption aria-hidden="true">image-20220407233022480</figcaption></figure><ul><li><p>VScode安装JAVA扩展</p><ul><li><p>Extension Pack for JAVA(好像是6合1)</p></li><li><p>JAVA Development Kit</p><ul><li><a href="https://www.oracle.com/java/technologies/javase-downloads.html">下载java</a></li><li>把下载的java添加到系统变量（2处）<img src="/2022/04/07/java-shi-yong-jna/image-20220409003946283.png" alt="image-20220409003946283"><img src="/2022/04/07/java-shi-yong-jna/image-20220409004015114.png" alt="image-20220409004015114"><img src="/2022/04/07/java-shi-yong-jna/image-20220409004036112.png" alt="image-20220409004036112"></li></ul></li><li><p>cmd 运行<code>java -version</code></p></li><li><p>vscode 在工作区设置setting.json<img src="/2022/04/07/java-shi-yong-jna/image-20220409004207504.png" alt="image-20220409004207504"></p></li><li><p>检验</p><div class="sourceCode" id="cb1"><pre class="sourceCode java"><code class="sourceCode java"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> hello &#123;</span><span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(<span class="bu">String</span>[] args)&#123;</span><span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">System</span>.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Hello World!&quot;</span>);</span><span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    &#125;</span><span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>&#125;</span></code></pre></div><figure><img src="/2022/04/07/java-shi-yong-jna/image-20220409004329142.png" alt="image-20220409004329142"><figcaption aria-hidden="true">image-20220409004329142</figcaption></figure></li></ul></li><li><p>上面介绍了用vscode安装java插件，接下来介绍eclipse，嘻嘻，专业的东西用专业的IDE。vscode，太难了。</p><ul><li><a href="https://www.eclipse.org/downloads/">安装eclipse。</a></li><li>JDK的安装和上面类似。</li></ul></li></ul><hr><h2 id="jna的应用">JNA的应用</h2><p>在Windows中的Preferences中选择Build Path下的User Library<img src="/2022/04/07/java-shi-yong-jna/image-20220409154252057.png" alt="image-20220409154252057"></p><p>添加之前在github下载的三个文件。<img src="/2022/04/07/java-shi-yong-jna/image-20220409154331254.png" alt="image-20220409154331254"></p><p>之后在文件夹<img src="/2022/04/07/java-shi-yong-jna/image-20220409154433644.png" alt="image-20220409154433644">，右键点击Build Path下面的Add Library选中我们添加的JNA。</p><hr><p>按住ctrl+click你想看到的函数源码，之后点击attach...的button，添加之前在github下载的zip文件，就可以看到源码了。<img src="/2022/04/07/java-shi-yong-jna/image-20220409154852563.png" alt="image-20220409154852563"></p><figure><img src="/2022/04/07/java-shi-yong-jna/image-20220409155025815.png" alt="image-20220409155025815"><figcaption aria-hidden="true">image-20220409155025815</figcaption></figure><hr><p>在vs studio中创建dll<img src="/2022/04/07/java-shi-yong-jna/image-20220409155357236.png" alt="image-20220409155357236"></p><p>主要使用的是testDLL.h和testDLL.cpp文件，相关的API和example在文件中已经给出。<img src="/2022/04/07/java-shi-yong-jna/image-20220409155555133.png" alt="image-20220409155555133"></p><p>在testDLL.cpp中写源文件，在testDLL.h定义<img src="/2022/04/07/java-shi-yong-jna/image-20220409160649433.png" alt="image-20220409160649433"></p><figure><img src="/2022/04/07/java-shi-yong-jna/image-20220409160702579.png" alt="image-20220409160702579"><figcaption aria-hidden="true">image-20220409160702579</figcaption></figure><p>extern “C”是为了避免重载。</p><p>生成解决方案：</p><figure><img src="/2022/04/07/java-shi-yong-jna/image-20220409160738670.png" alt="image-20220409160738670"><figcaption aria-hidden="true">image-20220409160738670</figcaption></figure><p>在DeBug文件下面找到testDLL.dll<img src="/2022/04/07/java-shi-yong-jna/image-20220409160934107.png" alt="image-20220409160934107"></p><hr><p>把dll文件放到<img src="/2022/04/07/java-shi-yong-jna/image-20220409161300374.png" alt="image-20220409161300374"></p><hr><p>新建接口interface；</p><p>实例化interface：<code>Mydll mydll = (Mydll)Native.load("testDLL",Mydll.class);</code></p><p>其中“testDLL”是testDLL.dll</p><figure><img src="/2022/04/07/java-shi-yong-jna/image-20220409164128527.png" alt="image-20220409164128527"><figcaption aria-hidden="true">image-20220409164128527</figcaption></figure><hr><p>jna数据类型对应。<a href="https://blog.csdn.net/hayaqi0504/article/details/83782105">JNA数据类型的对应以及使用_江南老画船的博客</a><img src="/2022/04/07/java-shi-yong-jna/image-20220409164322035.png" alt="image-20220409164322035"></p><h2 id="真正的应用">真正的应用</h2><p>好了好了，不隐藏了，上面都是老子踩的坑，接下来才是正题。</p><p>资料<a href="https://www.bilibili.com/video/BV1xU4y1F7Ep/?spm_id_from=333.788.recommend_more_video.-1">【C++】JAVA使用JNA调用C++动态库DLL_哔哩哔哩_bilibili</a></p><hr><ul><li><p>下载IntelliJ IDEA</p></li><li><p>把debug改成release<img src="/2022/04/07/java-shi-yong-jna/image-20220410001545149.png" alt="image-20220410001545149"></p></li><li><p>如果想要输出中文，要使用u8<img src="/2022/04/07/java-shi-yong-jna/image-20220410001739776.png" alt="image-20220410001739776"></p></li><li><p>添加jna的库<img src="/2022/04/07/java-shi-yong-jna/image-20220410001816284.png" alt="image-20220410001816284"></p></li><li><p>添加interface并且实例化<img src="/2022/04/07/java-shi-yong-jna/image-20220410001856274.png" alt="image-20220410001856274"></p></li><li><p>调用<img src="/2022/04/07/java-shi-yong-jna/image-20220410001930152.png" alt="image-20220410001930152"></p></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>写在前面</title>
      <link href="/2022/03/22/xie-zai-qian-mian/"/>
      <url>/2022/03/22/xie-zai-qian-mian/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><center><p style="font-size:50px">写在前面</p></center><blockquote><blockquote><p>2022/3/22</p></blockquote></blockquote><p style="font-size:25px">这是在我的好兄弟兼大学同学罗鸣鸣同学的激励和监督下完成的blog雏形，他说码农也应该是一个有着完美追求的码农，代码和思路一定要漂亮，于是在西安疫情和初春闲暇之日完成blog制作。</p><span id="more"></span><p style="font-size:25px">博客大多记录着一些论文笔记和课外小实验过程，同时我也想在这上面分享一些我对外界的思考，但是仅仅是不成熟的观点。如果有人说，你看看你写的博客怎么全是链接，或者是别人的论文有没有自己的东西，我只能很愧疚的说，从安装hexo到在写这篇文章之前，少有我自己的东西。但是这并不妨碍我继续完善自己，充实自己。如果有一天屏幕前的你想要抄我的blog，我只能说我也是抄别人的，毕竟程序员和其他职业不一样的，而且还是一个初出茅庐的小子。更何况我一向自诩为一个文学少年，文学分类中的blog差不多是我最最最真实和原创的部分，我们文人就不一样的，那不是抄。</p><p style="font-size:25px">最后希望这个blog能够激励自己坚持写博客，博客是个好东西，和照片一样，能够记录生活中美的部分，但是又有超越的部分，文字部分的魅力是无穷的，他代表着一个人所思所想所感，比图片来的更加亲切和热烈。况且我已经不再熟悉如何规划自己的朋友圈，总得在无人问津、曲折反转之后有着一缕自己的回忆。在面对生活的美好的时候不能总是选择放弃表达，此博客告诉自己，不必克制遣词，每一篇论文、每一次实验、每一本书在这里依旧能够有着深刻而又浪漫的回忆。</p><blockquote><blockquote><p>2022/3/24</p></blockquote></blockquote><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&amp;id=173395&amp;auto=1&amp;height=66"></iframe><p>写代码一定要优雅，这样写出来的东西才比别人的香！！！</p><blockquote><blockquote><p>2022/3/25</p></blockquote></blockquote><p>又下了一晚上的象棋，克制克制，不可以轻易暴露老子棋圣的身份，吃我分的人我一定会吃回来的。<img src="/2022/03/22/xie-zai-qian-mian/image-20220326213553634.png" alt="39%"></p><blockquote><blockquote><p>2022/3/30</p></blockquote></blockquote><p>看了一遍火影忍者的剪辑，2个小时，还是很感动，每一个角色都有血有肉，每一个故事都能勾起我的回忆。</p><blockquote><blockquote><p>2022/4/4</p></blockquote></blockquote><p>确定了要去哪了，又是背水一战！！！但是这也想弄，那也想搞，人生总是在取舍，贪婪果然是人性最致命的缺点之一。</p><blockquote><blockquote><p>2022/4/9</p></blockquote></blockquote><p>又到了4月，又是一个4月！！！</p><p>无尽的内耗。明天给自己放个假，调整一下状态。</p><blockquote><blockquote><p>2022/4/10</p></blockquote></blockquote><p>放假真爽！！！</p><blockquote><blockquote><p>2022/4/18</p></blockquote></blockquote><p>最近感觉自己水水的，要加油了！！</p><blockquote><blockquote><p>2022/11/29</p></blockquote></blockquote><p>“多态性在对象创建之前、消亡之后是没有意义的”。</p>]]></content>
      
      
      <categories>
          
          <category> 碎碎念 </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
